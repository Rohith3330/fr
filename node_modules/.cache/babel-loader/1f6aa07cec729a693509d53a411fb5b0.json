{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FSWatcher = exports.StatWatcher = exports.Volume = exports.toUnixTimestamp = exports.bufferToEncoding = exports.dataToBuffer = exports.dataToStr = exports.pathToSteps = exports.filenameToSteps = exports.pathToFilename = exports.flagsToNumber = exports.FLAGS = void 0;\n\nvar pathModule = require(\"path\");\n\nvar node_1 = require(\"./node\");\n\nvar Stats_1 = require(\"./Stats\");\n\nvar Dirent_1 = require(\"./Dirent\");\n\nvar buffer_1 = require(\"./internal/buffer\");\n\nvar setImmediate_1 = require(\"./setImmediate\");\n\nvar process_1 = require(\"./process\");\n\nvar setTimeoutUnref_1 = require(\"./setTimeoutUnref\");\n\nvar stream_1 = require(\"stream\");\n\nvar constants_1 = require(\"./constants\");\n\nvar events_1 = require(\"events\");\n\nvar encoding_1 = require(\"./encoding\");\n\nvar errors = require(\"./internal/errors\");\n\nvar util = require(\"util\");\n\nvar promises_1 = require(\"./promises\");\n\nvar resolveCrossPlatform = pathModule.resolve;\nvar O_RDONLY = constants_1.constants.O_RDONLY,\n    O_WRONLY = constants_1.constants.O_WRONLY,\n    O_RDWR = constants_1.constants.O_RDWR,\n    O_CREAT = constants_1.constants.O_CREAT,\n    O_EXCL = constants_1.constants.O_EXCL,\n    O_TRUNC = constants_1.constants.O_TRUNC,\n    O_APPEND = constants_1.constants.O_APPEND,\n    O_SYNC = constants_1.constants.O_SYNC,\n    O_DIRECTORY = constants_1.constants.O_DIRECTORY,\n    F_OK = constants_1.constants.F_OK,\n    COPYFILE_EXCL = constants_1.constants.COPYFILE_EXCL,\n    COPYFILE_FICLONE_FORCE = constants_1.constants.COPYFILE_FICLONE_FORCE;\n\nvar _a = pathModule.posix ? pathModule.posix : pathModule,\n    sep = _a.sep,\n    relative = _a.relative,\n    join = _a.join,\n    dirname = _a.dirname;\n\nvar isWin = process_1.default.platform === 'win32';\nvar kMinPoolSpace = 128; // const kMaxLength = require('buffer').kMaxLength;\n// ---------------------------------------- Error messages\n// TODO: Use `internal/errors.js` in the future.\n\nvar ERRSTR = {\n  PATH_STR: 'path must be a string or Buffer',\n  // FD:             'file descriptor must be a unsigned 32-bit integer',\n  FD: 'fd must be a file descriptor',\n  MODE_INT: 'mode must be an int',\n  CB: 'callback must be a function',\n  UID: 'uid must be an unsigned int',\n  GID: 'gid must be an unsigned int',\n  LEN: 'len must be an integer',\n  ATIME: 'atime must be an integer',\n  MTIME: 'mtime must be an integer',\n  PREFIX: 'filename prefix is required',\n  BUFFER: 'buffer must be an instance of Buffer or StaticBuffer',\n  OFFSET: 'offset must be an integer',\n  LENGTH: 'length must be an integer',\n  POSITION: 'position must be an integer'\n};\n\nvar ERRSTR_OPTS = function (tipeof) {\n  return \"Expected options to be either an object or a string, but got \".concat(tipeof, \" instead\");\n}; // const ERRSTR_FLAG = flag => `Unknown file open flag: ${flag}`;\n\n\nvar ENOENT = 'ENOENT';\nvar EBADF = 'EBADF';\nvar EINVAL = 'EINVAL';\nvar EPERM = 'EPERM';\nvar EPROTO = 'EPROTO';\nvar EEXIST = 'EEXIST';\nvar ENOTDIR = 'ENOTDIR';\nvar EMFILE = 'EMFILE';\nvar EACCES = 'EACCES';\nvar EISDIR = 'EISDIR';\nvar ENOTEMPTY = 'ENOTEMPTY';\nvar ENOSYS = 'ENOSYS';\nvar ERR_FS_EISDIR = 'ERR_FS_EISDIR';\n\nfunction formatError(errorCode, func, path, path2) {\n  if (func === void 0) {\n    func = '';\n  }\n\n  if (path === void 0) {\n    path = '';\n  }\n\n  if (path2 === void 0) {\n    path2 = '';\n  }\n\n  var pathFormatted = '';\n  if (path) pathFormatted = \" '\".concat(path, \"'\");\n  if (path2) pathFormatted += \" -> '\".concat(path2, \"'\");\n\n  switch (errorCode) {\n    case ENOENT:\n      return \"ENOENT: no such file or directory, \".concat(func).concat(pathFormatted);\n\n    case EBADF:\n      return \"EBADF: bad file descriptor, \".concat(func).concat(pathFormatted);\n\n    case EINVAL:\n      return \"EINVAL: invalid argument, \".concat(func).concat(pathFormatted);\n\n    case EPERM:\n      return \"EPERM: operation not permitted, \".concat(func).concat(pathFormatted);\n\n    case EPROTO:\n      return \"EPROTO: protocol error, \".concat(func).concat(pathFormatted);\n\n    case EEXIST:\n      return \"EEXIST: file already exists, \".concat(func).concat(pathFormatted);\n\n    case ENOTDIR:\n      return \"ENOTDIR: not a directory, \".concat(func).concat(pathFormatted);\n\n    case EISDIR:\n      return \"EISDIR: illegal operation on a directory, \".concat(func).concat(pathFormatted);\n\n    case EACCES:\n      return \"EACCES: permission denied, \".concat(func).concat(pathFormatted);\n\n    case ENOTEMPTY:\n      return \"ENOTEMPTY: directory not empty, \".concat(func).concat(pathFormatted);\n\n    case EMFILE:\n      return \"EMFILE: too many open files, \".concat(func).concat(pathFormatted);\n\n    case ENOSYS:\n      return \"ENOSYS: function not implemented, \".concat(func).concat(pathFormatted);\n\n    case ERR_FS_EISDIR:\n      return \"[ERR_FS_EISDIR]: Path is a directory: \".concat(func, \" returned EISDIR (is a directory) \").concat(path);\n\n    default:\n      return \"\".concat(errorCode, \": error occurred, \").concat(func).concat(pathFormatted);\n  }\n}\n\nfunction createError(errorCode, func, path, path2, Constructor) {\n  if (func === void 0) {\n    func = '';\n  }\n\n  if (path === void 0) {\n    path = '';\n  }\n\n  if (path2 === void 0) {\n    path2 = '';\n  }\n\n  if (Constructor === void 0) {\n    Constructor = Error;\n  }\n\n  var error = new Constructor(formatError(errorCode, func, path, path2));\n  error.code = errorCode;\n  return error;\n} // ---------------------------------------- Flags\n// List of file `flags` as defined by Node.\n\n\nvar FLAGS;\n\n(function (FLAGS) {\n  // Open file for reading. An exception occurs if the file does not exist.\n  FLAGS[FLAGS[\"r\"] = O_RDONLY] = \"r\"; // Open file for reading and writing. An exception occurs if the file does not exist.\n\n  FLAGS[FLAGS[\"r+\"] = O_RDWR] = \"r+\"; // Open file for reading in synchronous mode. Instructs the operating system to bypass the local file system cache.\n\n  FLAGS[FLAGS[\"rs\"] = O_RDONLY | O_SYNC] = \"rs\";\n  FLAGS[FLAGS[\"sr\"] = FLAGS.rs] = \"sr\"; // Open file for reading and writing, telling the OS to open it synchronously. See notes for 'rs' about using this with caution.\n\n  FLAGS[FLAGS[\"rs+\"] = O_RDWR | O_SYNC] = \"rs+\";\n  FLAGS[FLAGS[\"sr+\"] = FLAGS['rs+']] = \"sr+\"; // Open file for writing. The file is created (if it does not exist) or truncated (if it exists).\n\n  FLAGS[FLAGS[\"w\"] = O_WRONLY | O_CREAT | O_TRUNC] = \"w\"; // Like 'w' but fails if path exists.\n\n  FLAGS[FLAGS[\"wx\"] = O_WRONLY | O_CREAT | O_TRUNC | O_EXCL] = \"wx\";\n  FLAGS[FLAGS[\"xw\"] = FLAGS.wx] = \"xw\"; // Open file for reading and writing. The file is created (if it does not exist) or truncated (if it exists).\n\n  FLAGS[FLAGS[\"w+\"] = O_RDWR | O_CREAT | O_TRUNC] = \"w+\"; // Like 'w+' but fails if path exists.\n\n  FLAGS[FLAGS[\"wx+\"] = O_RDWR | O_CREAT | O_TRUNC | O_EXCL] = \"wx+\";\n  FLAGS[FLAGS[\"xw+\"] = FLAGS['wx+']] = \"xw+\"; // Open file for appending. The file is created if it does not exist.\n\n  FLAGS[FLAGS[\"a\"] = O_WRONLY | O_APPEND | O_CREAT] = \"a\"; // Like 'a' but fails if path exists.\n\n  FLAGS[FLAGS[\"ax\"] = O_WRONLY | O_APPEND | O_CREAT | O_EXCL] = \"ax\";\n  FLAGS[FLAGS[\"xa\"] = FLAGS.ax] = \"xa\"; // Open file for reading and appending. The file is created if it does not exist.\n\n  FLAGS[FLAGS[\"a+\"] = O_RDWR | O_APPEND | O_CREAT] = \"a+\"; // Like 'a+' but fails if path exists.\n\n  FLAGS[FLAGS[\"ax+\"] = O_RDWR | O_APPEND | O_CREAT | O_EXCL] = \"ax+\";\n  FLAGS[FLAGS[\"xa+\"] = FLAGS['ax+']] = \"xa+\";\n})(FLAGS = exports.FLAGS || (exports.FLAGS = {}));\n\nfunction flagsToNumber(flags) {\n  if (typeof flags === 'number') return flags;\n\n  if (typeof flags === 'string') {\n    var flagsNum = FLAGS[flags];\n    if (typeof flagsNum !== 'undefined') return flagsNum;\n  } // throw new TypeError(formatError(ERRSTR_FLAG(flags)));\n\n\n  throw new errors.TypeError('ERR_INVALID_OPT_VALUE', 'flags', flags);\n}\n\nexports.flagsToNumber = flagsToNumber; // ---------------------------------------- Options\n\nfunction getOptions(defaults, options) {\n  var opts;\n  if (!options) return defaults;else {\n    var tipeof = typeof options;\n\n    switch (tipeof) {\n      case 'string':\n        opts = Object.assign({}, defaults, {\n          encoding: options\n        });\n        break;\n\n      case 'object':\n        opts = Object.assign({}, defaults, options);\n        break;\n\n      default:\n        throw TypeError(ERRSTR_OPTS(tipeof));\n    }\n  }\n  if (opts.encoding !== 'buffer') (0, encoding_1.assertEncoding)(opts.encoding);\n  return opts;\n}\n\nfunction optsGenerator(defaults) {\n  return function (options) {\n    return getOptions(defaults, options);\n  };\n}\n\nfunction validateCallback(callback) {\n  if (typeof callback !== 'function') throw TypeError(ERRSTR.CB);\n  return callback;\n}\n\nfunction optsAndCbGenerator(getOpts) {\n  return function (options, callback) {\n    return typeof options === 'function' ? [getOpts(), options] : [getOpts(options), validateCallback(callback)];\n  };\n}\n\nvar optsDefaults = {\n  encoding: 'utf8'\n};\nvar getDefaultOpts = optsGenerator(optsDefaults);\nvar getDefaultOptsAndCb = optsAndCbGenerator(getDefaultOpts);\nvar readFileOptsDefaults = {\n  flag: 'r'\n};\nvar getReadFileOptions = optsGenerator(readFileOptsDefaults);\nvar writeFileDefaults = {\n  encoding: 'utf8',\n  mode: 438\n  /* MODE.DEFAULT */\n  ,\n  flag: FLAGS[FLAGS.w]\n};\nvar getWriteFileOptions = optsGenerator(writeFileDefaults);\nvar appendFileDefaults = {\n  encoding: 'utf8',\n  mode: 438\n  /* MODE.DEFAULT */\n  ,\n  flag: FLAGS[FLAGS.a]\n};\nvar getAppendFileOpts = optsGenerator(appendFileDefaults);\nvar getAppendFileOptsAndCb = optsAndCbGenerator(getAppendFileOpts);\nvar realpathDefaults = optsDefaults;\nvar getRealpathOptions = optsGenerator(realpathDefaults);\nvar getRealpathOptsAndCb = optsAndCbGenerator(getRealpathOptions);\nvar mkdirDefaults = {\n  mode: 511\n  /* MODE.DIR */\n  ,\n  recursive: false\n};\n\nvar getMkdirOptions = function (options) {\n  if (typeof options === 'number') return Object.assign({}, mkdirDefaults, {\n    mode: options\n  });\n  return Object.assign({}, mkdirDefaults, options);\n};\n\nvar rmdirDefaults = {\n  recursive: false\n};\n\nvar getRmdirOptions = function (options) {\n  return Object.assign({}, rmdirDefaults, options);\n};\n\nvar getRmOpts = optsGenerator(optsDefaults);\nvar getRmOptsAndCb = optsAndCbGenerator(getRmOpts);\nvar readdirDefaults = {\n  encoding: 'utf8',\n  withFileTypes: false\n};\nvar getReaddirOptions = optsGenerator(readdirDefaults);\nvar getReaddirOptsAndCb = optsAndCbGenerator(getReaddirOptions);\nvar statDefaults = {\n  bigint: false\n};\n\nvar getStatOptions = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  return Object.assign({}, statDefaults, options);\n};\n\nvar getStatOptsAndCb = function (options, callback) {\n  return typeof options === 'function' ? [getStatOptions(), options] : [getStatOptions(options), validateCallback(callback)];\n}; // ---------------------------------------- Utility functions\n\n\nfunction getPathFromURLPosix(url) {\n  if (url.hostname !== '') {\n    throw new errors.TypeError('ERR_INVALID_FILE_URL_HOST', process_1.default.platform);\n  }\n\n  var pathname = url.pathname;\n\n  for (var n = 0; n < pathname.length; n++) {\n    if (pathname[n] === '%') {\n      var third = pathname.codePointAt(n + 2) | 0x20;\n\n      if (pathname[n + 1] === '2' && third === 102) {\n        throw new errors.TypeError('ERR_INVALID_FILE_URL_PATH', 'must not include encoded / characters');\n      }\n    }\n  }\n\n  return decodeURIComponent(pathname);\n}\n\nfunction pathToFilename(path) {\n  if (typeof path !== 'string' && !buffer_1.Buffer.isBuffer(path)) {\n    try {\n      if (!(path instanceof require('url').URL)) throw new TypeError(ERRSTR.PATH_STR);\n    } catch (err) {\n      throw new TypeError(ERRSTR.PATH_STR);\n    }\n\n    path = getPathFromURLPosix(path);\n  }\n\n  var pathString = String(path);\n  nullCheck(pathString); // return slash(pathString);\n\n  return pathString;\n}\n\nexports.pathToFilename = pathToFilename;\n\nvar resolve = function (filename, base) {\n  if (base === void 0) {\n    base = process_1.default.cwd();\n  }\n\n  return resolveCrossPlatform(base, filename);\n};\n\nif (isWin) {\n  var _resolve_1 = resolve;\n\n  var unixify_1 = require('fs-monkey/lib/correctPath').unixify;\n\n  resolve = function (filename, base) {\n    return unixify_1(_resolve_1(filename, base));\n  };\n}\n\nfunction filenameToSteps(filename, base) {\n  var fullPath = resolve(filename, base);\n  var fullPathSansSlash = fullPath.substr(1);\n  if (!fullPathSansSlash) return [];\n  return fullPathSansSlash.split(sep);\n}\n\nexports.filenameToSteps = filenameToSteps;\n\nfunction pathToSteps(path) {\n  return filenameToSteps(pathToFilename(path));\n}\n\nexports.pathToSteps = pathToSteps;\n\nfunction dataToStr(data, encoding) {\n  if (encoding === void 0) {\n    encoding = encoding_1.ENCODING_UTF8;\n  }\n\n  if (buffer_1.Buffer.isBuffer(data)) return data.toString(encoding);else if (data instanceof Uint8Array) return (0, buffer_1.bufferFrom)(data).toString(encoding);else return String(data);\n}\n\nexports.dataToStr = dataToStr;\n\nfunction dataToBuffer(data, encoding) {\n  if (encoding === void 0) {\n    encoding = encoding_1.ENCODING_UTF8;\n  }\n\n  if (buffer_1.Buffer.isBuffer(data)) return data;else if (data instanceof Uint8Array) return (0, buffer_1.bufferFrom)(data);else return (0, buffer_1.bufferFrom)(String(data), encoding);\n}\n\nexports.dataToBuffer = dataToBuffer;\n\nfunction bufferToEncoding(buffer, encoding) {\n  if (!encoding || encoding === 'buffer') return buffer;else return buffer.toString(encoding);\n}\n\nexports.bufferToEncoding = bufferToEncoding;\n\nfunction nullCheck(path, callback) {\n  if (('' + path).indexOf('\\u0000') !== -1) {\n    var er = new Error('Path must be a string without null bytes');\n    er.code = ENOENT;\n    if (typeof callback !== 'function') throw er;\n    process_1.default.nextTick(callback, er);\n    return false;\n  }\n\n  return true;\n}\n\nfunction _modeToNumber(mode, def) {\n  if (typeof mode === 'number') return mode;\n  if (typeof mode === 'string') return parseInt(mode, 8);\n  if (def) return modeToNumber(def);\n  return undefined;\n}\n\nfunction modeToNumber(mode, def) {\n  var result = _modeToNumber(mode, def);\n\n  if (typeof result !== 'number' || isNaN(result)) throw new TypeError(ERRSTR.MODE_INT);\n  return result;\n}\n\nfunction isFd(path) {\n  return path >>> 0 === path;\n}\n\nfunction validateFd(fd) {\n  if (!isFd(fd)) throw TypeError(ERRSTR.FD);\n} // converts Date or number to a fractional UNIX timestamp\n\n\nfunction toUnixTimestamp(time) {\n  // tslint:disable-next-line triple-equals\n  if (typeof time === 'string' && +time == time) {\n    return +time;\n  }\n\n  if (time instanceof Date) {\n    return time.getTime() / 1000;\n  }\n\n  if (isFinite(time)) {\n    if (time < 0) {\n      return Date.now() / 1000;\n    }\n\n    return time;\n  }\n\n  throw new Error('Cannot parse time: ' + time);\n}\n\nexports.toUnixTimestamp = toUnixTimestamp;\n\nfunction validateUid(uid) {\n  if (typeof uid !== 'number') throw TypeError(ERRSTR.UID);\n}\n\nfunction validateGid(gid) {\n  if (typeof gid !== 'number') throw TypeError(ERRSTR.GID);\n}\n\nfunction flattenJSON(nestedJSON) {\n  var flatJSON = {};\n\n  function flatten(pathPrefix, node) {\n    for (var path in node) {\n      var contentOrNode = node[path];\n      var joinedPath = join(pathPrefix, path);\n\n      if (typeof contentOrNode === 'string') {\n        flatJSON[joinedPath] = contentOrNode;\n      } else if (typeof contentOrNode === 'object' && contentOrNode !== null && Object.keys(contentOrNode).length > 0) {\n        // empty directories need an explicit entry and therefore get handled in `else`, non-empty ones are implicitly considered\n        flatten(joinedPath, contentOrNode);\n      } else {\n        // without this branch null, empty-object or non-object entries would not be handled in the same way\n        // by both fromJSON() and fromNestedJSON()\n        flatJSON[joinedPath] = null;\n      }\n    }\n  }\n\n  flatten('', nestedJSON);\n  return flatJSON;\n}\n/**\n * `Volume` represents a file system.\n */\n\n\nvar Volume =\n/** @class */\nfunction () {\n  function Volume(props) {\n    if (props === void 0) {\n      props = {};\n    } // I-node number counter.\n\n\n    this.ino = 0; // A mapping for i-node numbers to i-nodes (`Node`);\n\n    this.inodes = {}; // List of released i-node numbers, for reuse.\n\n    this.releasedInos = []; // A mapping for file descriptors to `File`s.\n\n    this.fds = {}; // A list of reusable (opened and closed) file descriptors, that should be\n    // used first before creating a new file descriptor.\n\n    this.releasedFds = []; // Max number of open files.\n\n    this.maxFiles = 10000; // Current number of open files.\n\n    this.openFiles = 0;\n    this.promisesApi = (0, promises_1.default)(this);\n    this.statWatchers = {};\n    this.props = Object.assign({\n      Node: node_1.Node,\n      Link: node_1.Link,\n      File: node_1.File\n    }, props);\n    var root = this.createLink();\n    root.setNode(this.createNode(true));\n    var self = this; // tslint:disable-line no-this-assignment\n\n    this.StatWatcher =\n    /** @class */\n    function (_super) {\n      __extends(StatWatcher, _super);\n\n      function StatWatcher() {\n        return _super.call(this, self) || this;\n      }\n\n      return StatWatcher;\n    }(StatWatcher);\n\n    var _ReadStream = FsReadStream;\n\n    this.ReadStream =\n    /** @class */\n    function (_super) {\n      __extends(class_1, _super);\n\n      function class_1() {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return _super.apply(this, __spreadArray([self], args, false)) || this;\n      }\n\n      return class_1;\n    }(_ReadStream);\n\n    var _WriteStream = FsWriteStream;\n\n    this.WriteStream =\n    /** @class */\n    function (_super) {\n      __extends(class_2, _super);\n\n      function class_2() {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return _super.apply(this, __spreadArray([self], args, false)) || this;\n      }\n\n      return class_2;\n    }(_WriteStream);\n\n    this.FSWatcher =\n    /** @class */\n    function (_super) {\n      __extends(FSWatcher, _super);\n\n      function FSWatcher() {\n        return _super.call(this, self) || this;\n      }\n\n      return FSWatcher;\n    }(FSWatcher); // root.setChild('.', root);\n    // root.getNode().nlink++;\n    // root.setChild('..', root);\n    // root.getNode().nlink++;\n\n\n    this.root = root;\n  }\n\n  Volume.fromJSON = function (json, cwd) {\n    var vol = new Volume();\n    vol.fromJSON(json, cwd);\n    return vol;\n  };\n\n  Volume.fromNestedJSON = function (json, cwd) {\n    var vol = new Volume();\n    vol.fromNestedJSON(json, cwd);\n    return vol;\n  };\n\n  Object.defineProperty(Volume.prototype, \"promises\", {\n    get: function () {\n      if (this.promisesApi === null) throw new Error('Promise is not supported in this environment.');\n      return this.promisesApi;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  Volume.prototype.createLink = function (parent, name, isDirectory, perm) {\n    if (isDirectory === void 0) {\n      isDirectory = false;\n    }\n\n    if (!parent) {\n      return new this.props.Link(this, null, '');\n    }\n\n    if (!name) {\n      throw new Error('createLink: name cannot be empty');\n    }\n\n    return parent.createChild(name, this.createNode(isDirectory, perm));\n  };\n\n  Volume.prototype.deleteLink = function (link) {\n    var parent = link.parent;\n\n    if (parent) {\n      parent.deleteChild(link);\n      return true;\n    }\n\n    return false;\n  };\n\n  Volume.prototype.newInoNumber = function () {\n    var releasedFd = this.releasedInos.pop();\n    if (releasedFd) return releasedFd;else {\n      this.ino = (this.ino + 1) % 0xffffffff;\n      return this.ino;\n    }\n  };\n\n  Volume.prototype.newFdNumber = function () {\n    var releasedFd = this.releasedFds.pop();\n    return typeof releasedFd === 'number' ? releasedFd : Volume.fd--;\n  };\n\n  Volume.prototype.createNode = function (isDirectory, perm) {\n    if (isDirectory === void 0) {\n      isDirectory = false;\n    }\n\n    var node = new this.props.Node(this.newInoNumber(), perm);\n    if (isDirectory) node.setIsDirectory();\n    this.inodes[node.ino] = node;\n    return node;\n  };\n\n  Volume.prototype.getNode = function (ino) {\n    return this.inodes[ino];\n  };\n\n  Volume.prototype.deleteNode = function (node) {\n    node.del();\n    delete this.inodes[node.ino];\n    this.releasedInos.push(node.ino);\n  }; // Generates 6 character long random string, used by `mkdtemp`.\n\n\n  Volume.prototype.genRndStr = function () {\n    var str = (Math.random() + 1).toString(36).substr(2, 6);\n    if (str.length === 6) return str;else return this.genRndStr();\n  }; // Returns a `Link` (hard link) referenced by path \"split\" into steps.\n\n\n  Volume.prototype.getLink = function (steps) {\n    return this.root.walk(steps);\n  }; // Just link `getLink`, but throws a correct user error, if link to found.\n\n\n  Volume.prototype.getLinkOrThrow = function (filename, funcName) {\n    var steps = filenameToSteps(filename);\n    var link = this.getLink(steps);\n    if (!link) throw createError(ENOENT, funcName, filename);\n    return link;\n  }; // Just like `getLink`, but also dereference/resolves symbolic links.\n\n\n  Volume.prototype.getResolvedLink = function (filenameOrSteps) {\n    var steps = typeof filenameOrSteps === 'string' ? filenameToSteps(filenameOrSteps) : filenameOrSteps;\n    var link = this.root;\n    var i = 0;\n\n    while (i < steps.length) {\n      var step = steps[i];\n      link = link.getChild(step);\n      if (!link) return null;\n      var node = link.getNode();\n\n      if (node.isSymlink()) {\n        steps = node.symlink.concat(steps.slice(i + 1));\n        link = this.root;\n        i = 0;\n        continue;\n      }\n\n      i++;\n    }\n\n    return link;\n  }; // Just like `getLinkOrThrow`, but also dereference/resolves symbolic links.\n\n\n  Volume.prototype.getResolvedLinkOrThrow = function (filename, funcName) {\n    var link = this.getResolvedLink(filename);\n    if (!link) throw createError(ENOENT, funcName, filename);\n    return link;\n  };\n\n  Volume.prototype.resolveSymlinks = function (link) {\n    // let node: Node = link.getNode();\n    // while(link && node.isSymlink()) {\n    //     link = this.getLink(node.symlink);\n    //     if(!link) return null;\n    //     node = link.getNode();\n    // }\n    // return link;\n    return this.getResolvedLink(link.steps.slice(1));\n  }; // Just like `getLinkOrThrow`, but also verifies that the link is a directory.\n\n\n  Volume.prototype.getLinkAsDirOrThrow = function (filename, funcName) {\n    var link = this.getLinkOrThrow(filename, funcName);\n    if (!link.getNode().isDirectory()) throw createError(ENOTDIR, funcName, filename);\n    return link;\n  }; // Get the immediate parent directory of the link.\n\n\n  Volume.prototype.getLinkParent = function (steps) {\n    return this.root.walk(steps, steps.length - 1);\n  };\n\n  Volume.prototype.getLinkParentAsDirOrThrow = function (filenameOrSteps, funcName) {\n    var steps = filenameOrSteps instanceof Array ? filenameOrSteps : filenameToSteps(filenameOrSteps);\n    var link = this.getLinkParent(steps);\n    if (!link) throw createError(ENOENT, funcName, sep + steps.join(sep));\n    if (!link.getNode().isDirectory()) throw createError(ENOTDIR, funcName, sep + steps.join(sep));\n    return link;\n  };\n\n  Volume.prototype.getFileByFd = function (fd) {\n    return this.fds[String(fd)];\n  };\n\n  Volume.prototype.getFileByFdOrThrow = function (fd, funcName) {\n    if (!isFd(fd)) throw TypeError(ERRSTR.FD);\n    var file = this.getFileByFd(fd);\n    if (!file) throw createError(EBADF, funcName);\n    return file;\n  };\n  /**\n   * @todo This is not used anymore. Remove.\n   */\n\n  /*\n  private getNodeByIdOrCreate(id: TFileId, flags: number, perm: number): Node {\n    if (typeof id === 'number') {\n      const file = this.getFileByFd(id);\n      if (!file) throw Error('File nto found');\n      return file.node;\n    } else {\n      const steps = pathToSteps(id as PathLike);\n      let link = this.getLink(steps);\n      if (link) return link.getNode();\n         // Try creating a node if not found.\n      if (flags & O_CREAT) {\n        const dirLink = this.getLinkParent(steps);\n        if (dirLink) {\n          const name = steps[steps.length - 1];\n          link = this.createLink(dirLink, name, false, perm);\n          return link.getNode();\n        }\n      }\n         throw createError(ENOENT, 'getNodeByIdOrCreate', pathToFilename(id));\n    }\n  }\n  */\n\n\n  Volume.prototype.wrapAsync = function (method, args, callback) {\n    var _this = this;\n\n    validateCallback(callback);\n    (0, setImmediate_1.default)(function () {\n      var result;\n\n      try {\n        result = method.apply(_this, args);\n      } catch (err) {\n        callback(err);\n        return;\n      }\n\n      callback(null, result);\n    });\n  };\n\n  Volume.prototype._toJSON = function (link, json, path) {\n    var _a;\n\n    if (link === void 0) {\n      link = this.root;\n    }\n\n    if (json === void 0) {\n      json = {};\n    }\n\n    var isEmpty = true;\n    var children = link.children;\n\n    if (link.getNode().isFile()) {\n      children = (_a = {}, _a[link.getName()] = link.parent.getChild(link.getName()), _a);\n      link = link.parent;\n    }\n\n    for (var name_1 in children) {\n      isEmpty = false;\n      var child = link.getChild(name_1);\n\n      if (!child) {\n        throw new Error('_toJSON: unexpected undefined');\n      }\n\n      var node = child.getNode();\n\n      if (node.isFile()) {\n        var filename = child.getPath();\n        if (path) filename = relative(path, filename);\n        json[filename] = node.getString();\n      } else if (node.isDirectory()) {\n        this._toJSON(child, json, path);\n      }\n    }\n\n    var dirPath = link.getPath();\n    if (path) dirPath = relative(path, dirPath);\n\n    if (dirPath && isEmpty) {\n      json[dirPath] = null;\n    }\n\n    return json;\n  };\n\n  Volume.prototype.toJSON = function (paths, json, isRelative) {\n    if (json === void 0) {\n      json = {};\n    }\n\n    if (isRelative === void 0) {\n      isRelative = false;\n    }\n\n    var links = [];\n\n    if (paths) {\n      if (!(paths instanceof Array)) paths = [paths];\n\n      for (var _i = 0, paths_1 = paths; _i < paths_1.length; _i++) {\n        var path = paths_1[_i];\n        var filename = pathToFilename(path);\n        var link = this.getResolvedLink(filename);\n        if (!link) continue;\n        links.push(link);\n      }\n    } else {\n      links.push(this.root);\n    }\n\n    if (!links.length) return json;\n\n    for (var _a = 0, links_1 = links; _a < links_1.length; _a++) {\n      var link = links_1[_a];\n\n      this._toJSON(link, json, isRelative ? link.getPath() : '');\n    }\n\n    return json;\n  };\n\n  Volume.prototype.fromJSON = function (json, cwd) {\n    if (cwd === void 0) {\n      cwd = process_1.default.cwd();\n    }\n\n    for (var filename in json) {\n      var data = json[filename];\n      filename = resolve(filename, cwd);\n\n      if (typeof data === 'string') {\n        var dir = dirname(filename);\n        this.mkdirpBase(dir, 511\n        /* MODE.DIR */\n        );\n        this.writeFileSync(filename, data);\n      } else {\n        this.mkdirpBase(filename, 511\n        /* MODE.DIR */\n        );\n      }\n    }\n  };\n\n  Volume.prototype.fromNestedJSON = function (json, cwd) {\n    this.fromJSON(flattenJSON(json), cwd);\n  };\n\n  Volume.prototype.reset = function () {\n    this.ino = 0;\n    this.inodes = {};\n    this.releasedInos = [];\n    this.fds = {};\n    this.releasedFds = [];\n    this.openFiles = 0;\n    this.root = this.createLink();\n    this.root.setNode(this.createNode(true));\n  }; // Legacy interface\n\n\n  Volume.prototype.mountSync = function (mountpoint, json) {\n    this.fromJSON(json, mountpoint);\n  };\n\n  Volume.prototype.openLink = function (link, flagsNum, resolveSymlinks) {\n    if (resolveSymlinks === void 0) {\n      resolveSymlinks = true;\n    }\n\n    if (this.openFiles >= this.maxFiles) {\n      // Too many open files.\n      throw createError(EMFILE, 'open', link.getPath());\n    } // Resolve symlinks.\n\n\n    var realLink = link;\n    if (resolveSymlinks) realLink = this.resolveSymlinks(link);\n    if (!realLink) throw createError(ENOENT, 'open', link.getPath());\n    var node = realLink.getNode(); // Check whether node is a directory\n\n    if (node.isDirectory()) {\n      if ((flagsNum & (O_RDONLY | O_RDWR | O_WRONLY)) !== O_RDONLY) throw createError(EISDIR, 'open', link.getPath());\n    } else {\n      if (flagsNum & O_DIRECTORY) throw createError(ENOTDIR, 'open', link.getPath());\n    } // Check node permissions\n\n\n    if (!(flagsNum & O_WRONLY)) {\n      if (!node.canRead()) {\n        throw createError(EACCES, 'open', link.getPath());\n      }\n    }\n\n    if (flagsNum & O_RDWR) {}\n\n    var file = new this.props.File(link, node, flagsNum, this.newFdNumber());\n    this.fds[file.fd] = file;\n    this.openFiles++;\n    if (flagsNum & O_TRUNC) file.truncate();\n    return file;\n  };\n\n  Volume.prototype.openFile = function (filename, flagsNum, modeNum, resolveSymlinks) {\n    if (resolveSymlinks === void 0) {\n      resolveSymlinks = true;\n    }\n\n    var steps = filenameToSteps(filename);\n    var link = resolveSymlinks ? this.getResolvedLink(steps) : this.getLink(steps);\n    if (link && flagsNum & O_EXCL) throw createError(EEXIST, 'open', filename); // Try creating a new file, if it does not exist.\n\n    if (!link && flagsNum & O_CREAT) {\n      // const dirLink: Link = this.getLinkParent(steps);\n      var dirLink = this.getResolvedLink(steps.slice(0, steps.length - 1)); // if(!dirLink) throw createError(ENOENT, 'open', filename);\n\n      if (!dirLink) throw createError(ENOENT, 'open', sep + steps.join(sep));\n\n      if (flagsNum & O_CREAT && typeof modeNum === 'number') {\n        link = this.createLink(dirLink, steps[steps.length - 1], false, modeNum);\n      }\n    }\n\n    if (link) return this.openLink(link, flagsNum, resolveSymlinks);\n    throw createError(ENOENT, 'open', filename);\n  };\n\n  Volume.prototype.openBase = function (filename, flagsNum, modeNum, resolveSymlinks) {\n    if (resolveSymlinks === void 0) {\n      resolveSymlinks = true;\n    }\n\n    var file = this.openFile(filename, flagsNum, modeNum, resolveSymlinks);\n    if (!file) throw createError(ENOENT, 'open', filename);\n    return file.fd;\n  };\n\n  Volume.prototype.openSync = function (path, flags, mode) {\n    if (mode === void 0) {\n      mode = 438\n      /* MODE.DEFAULT */\n      ;\n    } // Validate (1) mode; (2) path; (3) flags - in that order.\n\n\n    var modeNum = modeToNumber(mode);\n    var fileName = pathToFilename(path);\n    var flagsNum = flagsToNumber(flags);\n    return this.openBase(fileName, flagsNum, modeNum);\n  };\n\n  Volume.prototype.open = function (path, flags, a, b) {\n    var mode = a;\n    var callback = b;\n\n    if (typeof a === 'function') {\n      mode = 438\n      /* MODE.DEFAULT */\n      ;\n      callback = a;\n    }\n\n    mode = mode || 438\n    /* MODE.DEFAULT */\n    ;\n    var modeNum = modeToNumber(mode);\n    var fileName = pathToFilename(path);\n    var flagsNum = flagsToNumber(flags);\n    this.wrapAsync(this.openBase, [fileName, flagsNum, modeNum], callback);\n  };\n\n  Volume.prototype.closeFile = function (file) {\n    if (!this.fds[file.fd]) return;\n    this.openFiles--;\n    delete this.fds[file.fd];\n    this.releasedFds.push(file.fd);\n  };\n\n  Volume.prototype.closeSync = function (fd) {\n    validateFd(fd);\n    var file = this.getFileByFdOrThrow(fd, 'close');\n    this.closeFile(file);\n  };\n\n  Volume.prototype.close = function (fd, callback) {\n    validateFd(fd);\n    this.wrapAsync(this.closeSync, [fd], callback);\n  };\n\n  Volume.prototype.openFileOrGetById = function (id, flagsNum, modeNum) {\n    if (typeof id === 'number') {\n      var file = this.fds[id];\n      if (!file) throw createError(ENOENT);\n      return file;\n    } else {\n      return this.openFile(pathToFilename(id), flagsNum, modeNum);\n    }\n  };\n\n  Volume.prototype.readBase = function (fd, buffer, offset, length, position) {\n    var file = this.getFileByFdOrThrow(fd);\n    return file.read(buffer, Number(offset), Number(length), position);\n  };\n\n  Volume.prototype.readSync = function (fd, buffer, offset, length, position) {\n    validateFd(fd);\n    return this.readBase(fd, buffer, offset, length, position);\n  };\n\n  Volume.prototype.read = function (fd, buffer, offset, length, position, callback) {\n    var _this = this;\n\n    validateCallback(callback); // This `if` branch is from Node.js\n\n    if (length === 0) {\n      return process_1.default.nextTick(function () {\n        if (callback) callback(null, 0, buffer);\n      });\n    }\n\n    (0, setImmediate_1.default)(function () {\n      try {\n        var bytes = _this.readBase(fd, buffer, offset, length, position);\n\n        callback(null, bytes, buffer);\n      } catch (err) {\n        callback(err);\n      }\n    });\n  };\n\n  Volume.prototype.readFileBase = function (id, flagsNum, encoding) {\n    var result;\n    var isUserFd = typeof id === 'number';\n    var userOwnsFd = isUserFd && isFd(id);\n    var fd;\n    if (userOwnsFd) fd = id;else {\n      var filename = pathToFilename(id);\n      var steps = filenameToSteps(filename);\n      var link = this.getResolvedLink(steps);\n\n      if (link) {\n        var node = link.getNode();\n        if (node.isDirectory()) throw createError(EISDIR, 'open', link.getPath());\n      }\n\n      fd = this.openSync(id, flagsNum);\n    }\n\n    try {\n      result = bufferToEncoding(this.getFileByFdOrThrow(fd).getBuffer(), encoding);\n    } finally {\n      if (!userOwnsFd) {\n        this.closeSync(fd);\n      }\n    }\n\n    return result;\n  };\n\n  Volume.prototype.readFileSync = function (file, options) {\n    var opts = getReadFileOptions(options);\n    var flagsNum = flagsToNumber(opts.flag);\n    return this.readFileBase(file, flagsNum, opts.encoding);\n  };\n\n  Volume.prototype.readFile = function (id, a, b) {\n    var _a = optsAndCbGenerator(getReadFileOptions)(a, b),\n        opts = _a[0],\n        callback = _a[1];\n\n    var flagsNum = flagsToNumber(opts.flag);\n    this.wrapAsync(this.readFileBase, [id, flagsNum, opts.encoding], callback);\n  };\n\n  Volume.prototype.writeBase = function (fd, buf, offset, length, position) {\n    var file = this.getFileByFdOrThrow(fd, 'write');\n    return file.write(buf, offset, length, position);\n  };\n\n  Volume.prototype.writeSync = function (fd, a, b, c, d) {\n    validateFd(fd);\n    var encoding;\n    var offset;\n    var length;\n    var position;\n    var isBuffer = typeof a !== 'string';\n\n    if (isBuffer) {\n      offset = (b || 0) | 0;\n      length = c;\n      position = d;\n    } else {\n      position = b;\n      encoding = c;\n    }\n\n    var buf = dataToBuffer(a, encoding);\n\n    if (isBuffer) {\n      if (typeof length === 'undefined') {\n        length = buf.length;\n      }\n    } else {\n      offset = 0;\n      length = buf.length;\n    }\n\n    return this.writeBase(fd, buf, offset, length, position);\n  };\n\n  Volume.prototype.write = function (fd, a, b, c, d, e) {\n    var _this = this;\n\n    validateFd(fd);\n    var offset;\n    var length;\n    var position;\n    var encoding;\n    var callback;\n    var tipa = typeof a;\n    var tipb = typeof b;\n    var tipc = typeof c;\n    var tipd = typeof d;\n\n    if (tipa !== 'string') {\n      if (tipb === 'function') {\n        callback = b;\n      } else if (tipc === 'function') {\n        offset = b | 0;\n        callback = c;\n      } else if (tipd === 'function') {\n        offset = b | 0;\n        length = c;\n        callback = d;\n      } else {\n        offset = b | 0;\n        length = c;\n        position = d;\n        callback = e;\n      }\n    } else {\n      if (tipb === 'function') {\n        callback = b;\n      } else if (tipc === 'function') {\n        position = b;\n        callback = c;\n      } else if (tipd === 'function') {\n        position = b;\n        encoding = c;\n        callback = d;\n      }\n    }\n\n    var buf = dataToBuffer(a, encoding);\n\n    if (tipa !== 'string') {\n      if (typeof length === 'undefined') length = buf.length;\n    } else {\n      offset = 0;\n      length = buf.length;\n    }\n\n    var cb = validateCallback(callback);\n    (0, setImmediate_1.default)(function () {\n      try {\n        var bytes = _this.writeBase(fd, buf, offset, length, position);\n\n        if (tipa !== 'string') {\n          cb(null, bytes, buf);\n        } else {\n          cb(null, bytes, a);\n        }\n      } catch (err) {\n        cb(err);\n      }\n    });\n  };\n\n  Volume.prototype.writeFileBase = function (id, buf, flagsNum, modeNum) {\n    // console.log('writeFileBase', id, buf, flagsNum, modeNum);\n    // const node = this.getNodeByIdOrCreate(id, flagsNum, modeNum);\n    // node.setBuffer(buf);\n    var isUserFd = typeof id === 'number';\n    var fd;\n    if (isUserFd) fd = id;else {\n      fd = this.openBase(pathToFilename(id), flagsNum, modeNum); // fd = this.openSync(id as PathLike, flagsNum, modeNum);\n    }\n    var offset = 0;\n    var length = buf.length;\n    var position = flagsNum & O_APPEND ? undefined : 0;\n\n    try {\n      while (length > 0) {\n        var written = this.writeSync(fd, buf, offset, length, position);\n        offset += written;\n        length -= written;\n        if (position !== undefined) position += written;\n      }\n    } finally {\n      if (!isUserFd) this.closeSync(fd);\n    }\n  };\n\n  Volume.prototype.writeFileSync = function (id, data, options) {\n    var opts = getWriteFileOptions(options);\n    var flagsNum = flagsToNumber(opts.flag);\n    var modeNum = modeToNumber(opts.mode);\n    var buf = dataToBuffer(data, opts.encoding);\n    this.writeFileBase(id, buf, flagsNum, modeNum);\n  };\n\n  Volume.prototype.writeFile = function (id, data, a, b) {\n    var options = a;\n    var callback = b;\n\n    if (typeof a === 'function') {\n      options = writeFileDefaults;\n      callback = a;\n    }\n\n    var cb = validateCallback(callback);\n    var opts = getWriteFileOptions(options);\n    var flagsNum = flagsToNumber(opts.flag);\n    var modeNum = modeToNumber(opts.mode);\n    var buf = dataToBuffer(data, opts.encoding);\n    this.wrapAsync(this.writeFileBase, [id, buf, flagsNum, modeNum], cb);\n  };\n\n  Volume.prototype.linkBase = function (filename1, filename2) {\n    var steps1 = filenameToSteps(filename1);\n    var link1 = this.getLink(steps1);\n    if (!link1) throw createError(ENOENT, 'link', filename1, filename2);\n    var steps2 = filenameToSteps(filename2); // Check new link directory exists.\n\n    var dir2 = this.getLinkParent(steps2);\n    if (!dir2) throw createError(ENOENT, 'link', filename1, filename2);\n    var name = steps2[steps2.length - 1]; // Check if new file already exists.\n\n    if (dir2.getChild(name)) throw createError(EEXIST, 'link', filename1, filename2);\n    var node = link1.getNode();\n    node.nlink++;\n    dir2.createChild(name, node);\n  };\n\n  Volume.prototype.copyFileBase = function (src, dest, flags) {\n    var buf = this.readFileSync(src);\n\n    if (flags & COPYFILE_EXCL) {\n      if (this.existsSync(dest)) {\n        throw createError(EEXIST, 'copyFile', src, dest);\n      }\n    }\n\n    if (flags & COPYFILE_FICLONE_FORCE) {\n      throw createError(ENOSYS, 'copyFile', src, dest);\n    }\n\n    this.writeFileBase(dest, buf, FLAGS.w, 438\n    /* MODE.DEFAULT */\n    );\n  };\n\n  Volume.prototype.copyFileSync = function (src, dest, flags) {\n    var srcFilename = pathToFilename(src);\n    var destFilename = pathToFilename(dest);\n    return this.copyFileBase(srcFilename, destFilename, (flags || 0) | 0);\n  };\n\n  Volume.prototype.copyFile = function (src, dest, a, b) {\n    var srcFilename = pathToFilename(src);\n    var destFilename = pathToFilename(dest);\n    var flags;\n    var callback;\n\n    if (typeof a === 'function') {\n      flags = 0;\n      callback = a;\n    } else {\n      flags = a;\n      callback = b;\n    }\n\n    validateCallback(callback);\n    this.wrapAsync(this.copyFileBase, [srcFilename, destFilename, flags], callback);\n  };\n\n  Volume.prototype.linkSync = function (existingPath, newPath) {\n    var existingPathFilename = pathToFilename(existingPath);\n    var newPathFilename = pathToFilename(newPath);\n    this.linkBase(existingPathFilename, newPathFilename);\n  };\n\n  Volume.prototype.link = function (existingPath, newPath, callback) {\n    var existingPathFilename = pathToFilename(existingPath);\n    var newPathFilename = pathToFilename(newPath);\n    this.wrapAsync(this.linkBase, [existingPathFilename, newPathFilename], callback);\n  };\n\n  Volume.prototype.unlinkBase = function (filename) {\n    var steps = filenameToSteps(filename);\n    var link = this.getLink(steps);\n    if (!link) throw createError(ENOENT, 'unlink', filename); // TODO: Check if it is file, dir, other...\n\n    if (link.length) throw Error('Dir not empty...');\n    this.deleteLink(link);\n    var node = link.getNode();\n    node.nlink--; // When all hard links to i-node are deleted, remove the i-node, too.\n\n    if (node.nlink <= 0) {\n      this.deleteNode(node);\n    }\n  };\n\n  Volume.prototype.unlinkSync = function (path) {\n    var filename = pathToFilename(path);\n    this.unlinkBase(filename);\n  };\n\n  Volume.prototype.unlink = function (path, callback) {\n    var filename = pathToFilename(path);\n    this.wrapAsync(this.unlinkBase, [filename], callback);\n  };\n\n  Volume.prototype.symlinkBase = function (targetFilename, pathFilename) {\n    var pathSteps = filenameToSteps(pathFilename); // Check if directory exists, where we about to create a symlink.\n\n    var dirLink = this.getLinkParent(pathSteps);\n    if (!dirLink) throw createError(ENOENT, 'symlink', targetFilename, pathFilename);\n    var name = pathSteps[pathSteps.length - 1]; // Check if new file already exists.\n\n    if (dirLink.getChild(name)) throw createError(EEXIST, 'symlink', targetFilename, pathFilename); // Create symlink.\n\n    var symlink = dirLink.createChild(name);\n    symlink.getNode().makeSymlink(filenameToSteps(targetFilename));\n    return symlink;\n  }; // `type` argument works only on Windows.\n\n\n  Volume.prototype.symlinkSync = function (target, path, type) {\n    var targetFilename = pathToFilename(target);\n    var pathFilename = pathToFilename(path);\n    this.symlinkBase(targetFilename, pathFilename);\n  };\n\n  Volume.prototype.symlink = function (target, path, a, b) {\n    var callback = validateCallback(typeof a === 'function' ? a : b);\n    var targetFilename = pathToFilename(target);\n    var pathFilename = pathToFilename(path);\n    this.wrapAsync(this.symlinkBase, [targetFilename, pathFilename], callback);\n  };\n\n  Volume.prototype.realpathBase = function (filename, encoding) {\n    var steps = filenameToSteps(filename);\n    var realLink = this.getResolvedLink(steps);\n    if (!realLink) throw createError(ENOENT, 'realpath', filename);\n    return (0, encoding_1.strToEncoding)(realLink.getPath(), encoding);\n  };\n\n  Volume.prototype.realpathSync = function (path, options) {\n    return this.realpathBase(pathToFilename(path), getRealpathOptions(options).encoding);\n  };\n\n  Volume.prototype.realpath = function (path, a, b) {\n    var _a = getRealpathOptsAndCb(a, b),\n        opts = _a[0],\n        callback = _a[1];\n\n    var pathFilename = pathToFilename(path);\n    this.wrapAsync(this.realpathBase, [pathFilename, opts.encoding], callback);\n  };\n\n  Volume.prototype.lstatBase = function (filename, bigint, throwIfNoEntry) {\n    if (bigint === void 0) {\n      bigint = false;\n    }\n\n    if (throwIfNoEntry === void 0) {\n      throwIfNoEntry = false;\n    }\n\n    var link = this.getLink(filenameToSteps(filename));\n\n    if (link) {\n      return Stats_1.default.build(link.getNode(), bigint);\n    } else if (!throwIfNoEntry) {\n      return undefined;\n    } else {\n      throw createError(ENOENT, 'lstat', filename);\n    }\n  };\n\n  Volume.prototype.lstatSync = function (path, options) {\n    var _a = getStatOptions(options),\n        _b = _a.throwIfNoEntry,\n        throwIfNoEntry = _b === void 0 ? true : _b,\n        _c = _a.bigint,\n        bigint = _c === void 0 ? false : _c;\n\n    return this.lstatBase(pathToFilename(path), bigint, throwIfNoEntry);\n  };\n\n  Volume.prototype.lstat = function (path, a, b) {\n    var _a = getStatOptsAndCb(a, b),\n        _b = _a[0],\n        _c = _b.throwIfNoEntry,\n        throwIfNoEntry = _c === void 0 ? true : _c,\n        _d = _b.bigint,\n        bigint = _d === void 0 ? false : _d,\n        callback = _a[1];\n\n    this.wrapAsync(this.lstatBase, [pathToFilename(path), bigint, throwIfNoEntry], callback);\n  };\n\n  Volume.prototype.statBase = function (filename, bigint, throwIfNoEntry) {\n    if (bigint === void 0) {\n      bigint = false;\n    }\n\n    if (throwIfNoEntry === void 0) {\n      throwIfNoEntry = true;\n    }\n\n    var link = this.getResolvedLink(filenameToSteps(filename));\n\n    if (link) {\n      return Stats_1.default.build(link.getNode(), bigint);\n    } else if (!throwIfNoEntry) {\n      return undefined;\n    } else {\n      throw createError(ENOENT, 'stat', filename);\n    }\n  };\n\n  Volume.prototype.statSync = function (path, options) {\n    var _a = getStatOptions(options),\n        _b = _a.bigint,\n        bigint = _b === void 0 ? true : _b,\n        _c = _a.throwIfNoEntry,\n        throwIfNoEntry = _c === void 0 ? true : _c;\n\n    return this.statBase(pathToFilename(path), bigint, throwIfNoEntry);\n  };\n\n  Volume.prototype.stat = function (path, a, b) {\n    var _a = getStatOptsAndCb(a, b),\n        _b = _a[0],\n        _c = _b.bigint,\n        bigint = _c === void 0 ? false : _c,\n        _d = _b.throwIfNoEntry,\n        throwIfNoEntry = _d === void 0 ? true : _d,\n        callback = _a[1];\n\n    this.wrapAsync(this.statBase, [pathToFilename(path), bigint, throwIfNoEntry], callback);\n  };\n\n  Volume.prototype.fstatBase = function (fd, bigint) {\n    if (bigint === void 0) {\n      bigint = false;\n    }\n\n    var file = this.getFileByFd(fd);\n    if (!file) throw createError(EBADF, 'fstat');\n    return Stats_1.default.build(file.node, bigint);\n  };\n\n  Volume.prototype.fstatSync = function (fd, options) {\n    return this.fstatBase(fd, getStatOptions(options).bigint);\n  };\n\n  Volume.prototype.fstat = function (fd, a, b) {\n    var _a = getStatOptsAndCb(a, b),\n        opts = _a[0],\n        callback = _a[1];\n\n    this.wrapAsync(this.fstatBase, [fd, opts.bigint], callback);\n  };\n\n  Volume.prototype.renameBase = function (oldPathFilename, newPathFilename) {\n    var link = this.getLink(filenameToSteps(oldPathFilename));\n    if (!link) throw createError(ENOENT, 'rename', oldPathFilename, newPathFilename); // TODO: Check if it is directory, if non-empty, we cannot move it, right?\n\n    var newPathSteps = filenameToSteps(newPathFilename); // Check directory exists for the new location.\n\n    var newPathDirLink = this.getLinkParent(newPathSteps);\n    if (!newPathDirLink) throw createError(ENOENT, 'rename', oldPathFilename, newPathFilename); // TODO: Also treat cases with directories and symbolic links.\n    // TODO: See: http://man7.org/linux/man-pages/man2/rename.2.html\n    // Remove hard link from old folder.\n\n    var oldLinkParent = link.parent;\n\n    if (oldLinkParent) {\n      oldLinkParent.deleteChild(link);\n    } // Rename should overwrite the new path, if that exists.\n\n\n    var name = newPathSteps[newPathSteps.length - 1];\n    link.name = name;\n    link.steps = __spreadArray(__spreadArray([], newPathDirLink.steps, true), [name], false);\n    newPathDirLink.setChild(link.getName(), link);\n  };\n\n  Volume.prototype.renameSync = function (oldPath, newPath) {\n    var oldPathFilename = pathToFilename(oldPath);\n    var newPathFilename = pathToFilename(newPath);\n    this.renameBase(oldPathFilename, newPathFilename);\n  };\n\n  Volume.prototype.rename = function (oldPath, newPath, callback) {\n    var oldPathFilename = pathToFilename(oldPath);\n    var newPathFilename = pathToFilename(newPath);\n    this.wrapAsync(this.renameBase, [oldPathFilename, newPathFilename], callback);\n  };\n\n  Volume.prototype.existsBase = function (filename) {\n    return !!this.statBase(filename);\n  };\n\n  Volume.prototype.existsSync = function (path) {\n    try {\n      return this.existsBase(pathToFilename(path));\n    } catch (err) {\n      return false;\n    }\n  };\n\n  Volume.prototype.exists = function (path, callback) {\n    var _this = this;\n\n    var filename = pathToFilename(path);\n    if (typeof callback !== 'function') throw Error(ERRSTR.CB);\n    (0, setImmediate_1.default)(function () {\n      try {\n        callback(_this.existsBase(filename));\n      } catch (err) {\n        callback(false);\n      }\n    });\n  };\n\n  Volume.prototype.accessBase = function (filename, mode) {\n    var link = this.getLinkOrThrow(filename, 'access'); // TODO: Verify permissions\n  };\n\n  Volume.prototype.accessSync = function (path, mode) {\n    if (mode === void 0) {\n      mode = F_OK;\n    }\n\n    var filename = pathToFilename(path);\n    mode = mode | 0;\n    this.accessBase(filename, mode);\n  };\n\n  Volume.prototype.access = function (path, a, b) {\n    var mode = F_OK;\n    var callback;\n\n    if (typeof a !== 'function') {\n      mode = a | 0; // cast to number\n\n      callback = validateCallback(b);\n    } else {\n      callback = a;\n    }\n\n    var filename = pathToFilename(path);\n    this.wrapAsync(this.accessBase, [filename, mode], callback);\n  };\n\n  Volume.prototype.appendFileSync = function (id, data, options) {\n    if (options === void 0) {\n      options = appendFileDefaults;\n    }\n\n    var opts = getAppendFileOpts(options); // force append behavior when using a supplied file descriptor\n\n    if (!opts.flag || isFd(id)) opts.flag = 'a';\n    this.writeFileSync(id, data, opts);\n  };\n\n  Volume.prototype.appendFile = function (id, data, a, b) {\n    var _a = getAppendFileOptsAndCb(a, b),\n        opts = _a[0],\n        callback = _a[1]; // force append behavior when using a supplied file descriptor\n\n\n    if (!opts.flag || isFd(id)) opts.flag = 'a';\n    this.writeFile(id, data, opts, callback);\n  };\n\n  Volume.prototype.readdirBase = function (filename, options) {\n    var steps = filenameToSteps(filename);\n    var link = this.getResolvedLink(steps);\n    if (!link) throw createError(ENOENT, 'readdir', filename);\n    var node = link.getNode();\n    if (!node.isDirectory()) throw createError(ENOTDIR, 'scandir', filename);\n\n    if (options.withFileTypes) {\n      var list_1 = [];\n\n      for (var name_2 in link.children) {\n        var child = link.getChild(name_2);\n\n        if (!child) {\n          continue;\n        }\n\n        list_1.push(Dirent_1.default.build(child, options.encoding));\n      }\n\n      if (!isWin && options.encoding !== 'buffer') list_1.sort(function (a, b) {\n        if (a.name < b.name) return -1;\n        if (a.name > b.name) return 1;\n        return 0;\n      });\n      return list_1;\n    }\n\n    var list = [];\n\n    for (var name_3 in link.children) {\n      list.push((0, encoding_1.strToEncoding)(name_3, options.encoding));\n    }\n\n    if (!isWin && options.encoding !== 'buffer') list.sort();\n    return list;\n  };\n\n  Volume.prototype.readdirSync = function (path, options) {\n    var opts = getReaddirOptions(options);\n    var filename = pathToFilename(path);\n    return this.readdirBase(filename, opts);\n  };\n\n  Volume.prototype.readdir = function (path, a, b) {\n    var _a = getReaddirOptsAndCb(a, b),\n        options = _a[0],\n        callback = _a[1];\n\n    var filename = pathToFilename(path);\n    this.wrapAsync(this.readdirBase, [filename, options], callback);\n  };\n\n  Volume.prototype.readlinkBase = function (filename, encoding) {\n    var link = this.getLinkOrThrow(filename, 'readlink');\n    var node = link.getNode();\n    if (!node.isSymlink()) throw createError(EINVAL, 'readlink', filename);\n    var str = sep + node.symlink.join(sep);\n    return (0, encoding_1.strToEncoding)(str, encoding);\n  };\n\n  Volume.prototype.readlinkSync = function (path, options) {\n    var opts = getDefaultOpts(options);\n    var filename = pathToFilename(path);\n    return this.readlinkBase(filename, opts.encoding);\n  };\n\n  Volume.prototype.readlink = function (path, a, b) {\n    var _a = getDefaultOptsAndCb(a, b),\n        opts = _a[0],\n        callback = _a[1];\n\n    var filename = pathToFilename(path);\n    this.wrapAsync(this.readlinkBase, [filename, opts.encoding], callback);\n  };\n\n  Volume.prototype.fsyncBase = function (fd) {\n    this.getFileByFdOrThrow(fd, 'fsync');\n  };\n\n  Volume.prototype.fsyncSync = function (fd) {\n    this.fsyncBase(fd);\n  };\n\n  Volume.prototype.fsync = function (fd, callback) {\n    this.wrapAsync(this.fsyncBase, [fd], callback);\n  };\n\n  Volume.prototype.fdatasyncBase = function (fd) {\n    this.getFileByFdOrThrow(fd, 'fdatasync');\n  };\n\n  Volume.prototype.fdatasyncSync = function (fd) {\n    this.fdatasyncBase(fd);\n  };\n\n  Volume.prototype.fdatasync = function (fd, callback) {\n    this.wrapAsync(this.fdatasyncBase, [fd], callback);\n  };\n\n  Volume.prototype.ftruncateBase = function (fd, len) {\n    var file = this.getFileByFdOrThrow(fd, 'ftruncate');\n    file.truncate(len);\n  };\n\n  Volume.prototype.ftruncateSync = function (fd, len) {\n    this.ftruncateBase(fd, len);\n  };\n\n  Volume.prototype.ftruncate = function (fd, a, b) {\n    var len = typeof a === 'number' ? a : 0;\n    var callback = validateCallback(typeof a === 'number' ? b : a);\n    this.wrapAsync(this.ftruncateBase, [fd, len], callback);\n  };\n\n  Volume.prototype.truncateBase = function (path, len) {\n    var fd = this.openSync(path, 'r+');\n\n    try {\n      this.ftruncateSync(fd, len);\n    } finally {\n      this.closeSync(fd);\n    }\n  };\n\n  Volume.prototype.truncateSync = function (id, len) {\n    if (isFd(id)) return this.ftruncateSync(id, len);\n    this.truncateBase(id, len);\n  };\n\n  Volume.prototype.truncate = function (id, a, b) {\n    var len = typeof a === 'number' ? a : 0;\n    var callback = validateCallback(typeof a === 'number' ? b : a);\n    if (isFd(id)) return this.ftruncate(id, len, callback);\n    this.wrapAsync(this.truncateBase, [id, len], callback);\n  };\n\n  Volume.prototype.futimesBase = function (fd, atime, mtime) {\n    var file = this.getFileByFdOrThrow(fd, 'futimes');\n    var node = file.node;\n    node.atime = new Date(atime * 1000);\n    node.mtime = new Date(mtime * 1000);\n  };\n\n  Volume.prototype.futimesSync = function (fd, atime, mtime) {\n    this.futimesBase(fd, toUnixTimestamp(atime), toUnixTimestamp(mtime));\n  };\n\n  Volume.prototype.futimes = function (fd, atime, mtime, callback) {\n    this.wrapAsync(this.futimesBase, [fd, toUnixTimestamp(atime), toUnixTimestamp(mtime)], callback);\n  };\n\n  Volume.prototype.utimesBase = function (filename, atime, mtime) {\n    var fd = this.openSync(filename, 'r+');\n\n    try {\n      this.futimesBase(fd, atime, mtime);\n    } finally {\n      this.closeSync(fd);\n    }\n  };\n\n  Volume.prototype.utimesSync = function (path, atime, mtime) {\n    this.utimesBase(pathToFilename(path), toUnixTimestamp(atime), toUnixTimestamp(mtime));\n  };\n\n  Volume.prototype.utimes = function (path, atime, mtime, callback) {\n    this.wrapAsync(this.utimesBase, [pathToFilename(path), toUnixTimestamp(atime), toUnixTimestamp(mtime)], callback);\n  };\n\n  Volume.prototype.mkdirBase = function (filename, modeNum) {\n    var steps = filenameToSteps(filename); // This will throw if user tries to create root dir `fs.mkdirSync('/')`.\n\n    if (!steps.length) {\n      throw createError(EEXIST, 'mkdir', filename);\n    }\n\n    var dir = this.getLinkParentAsDirOrThrow(filename, 'mkdir'); // Check path already exists.\n\n    var name = steps[steps.length - 1];\n    if (dir.getChild(name)) throw createError(EEXIST, 'mkdir', filename);\n    dir.createChild(name, this.createNode(true, modeNum));\n  };\n  /**\n   * Creates directory tree recursively.\n   * @param filename\n   * @param modeNum\n   */\n\n\n  Volume.prototype.mkdirpBase = function (filename, modeNum) {\n    var steps = filenameToSteps(filename);\n    var link = this.root;\n\n    for (var i = 0; i < steps.length; i++) {\n      var step = steps[i];\n      if (!link.getNode().isDirectory()) throw createError(ENOTDIR, 'mkdir', link.getPath());\n      var child = link.getChild(step);\n\n      if (child) {\n        if (child.getNode().isDirectory()) link = child;else throw createError(ENOTDIR, 'mkdir', child.getPath());\n      } else {\n        link = link.createChild(step, this.createNode(true, modeNum));\n      }\n    }\n  };\n\n  Volume.prototype.mkdirSync = function (path, options) {\n    var opts = getMkdirOptions(options);\n    var modeNum = modeToNumber(opts.mode, 511);\n    var filename = pathToFilename(path);\n    if (opts.recursive) this.mkdirpBase(filename, modeNum);else this.mkdirBase(filename, modeNum);\n  };\n\n  Volume.prototype.mkdir = function (path, a, b) {\n    var opts = getMkdirOptions(a);\n    var callback = validateCallback(typeof a === 'function' ? a : b);\n    var modeNum = modeToNumber(opts.mode, 511);\n    var filename = pathToFilename(path);\n    if (opts.recursive) this.wrapAsync(this.mkdirpBase, [filename, modeNum], callback);else this.wrapAsync(this.mkdirBase, [filename, modeNum], callback);\n  }; // legacy interface\n\n\n  Volume.prototype.mkdirpSync = function (path, mode) {\n    this.mkdirSync(path, {\n      mode: mode,\n      recursive: true\n    });\n  };\n\n  Volume.prototype.mkdirp = function (path, a, b) {\n    var mode = typeof a === 'function' ? undefined : a;\n    var callback = validateCallback(typeof a === 'function' ? a : b);\n    this.mkdir(path, {\n      mode: mode,\n      recursive: true\n    }, callback);\n  };\n\n  Volume.prototype.mkdtempBase = function (prefix, encoding, retry) {\n    if (retry === void 0) {\n      retry = 5;\n    }\n\n    var filename = prefix + this.genRndStr();\n\n    try {\n      this.mkdirBase(filename, 511\n      /* MODE.DIR */\n      );\n      return (0, encoding_1.strToEncoding)(filename, encoding);\n    } catch (err) {\n      if (err.code === EEXIST) {\n        if (retry > 1) return this.mkdtempBase(prefix, encoding, retry - 1);else throw Error('Could not create temp dir.');\n      } else throw err;\n    }\n  };\n\n  Volume.prototype.mkdtempSync = function (prefix, options) {\n    var encoding = getDefaultOpts(options).encoding;\n    if (!prefix || typeof prefix !== 'string') throw new TypeError('filename prefix is required');\n    nullCheck(prefix);\n    return this.mkdtempBase(prefix, encoding);\n  };\n\n  Volume.prototype.mkdtemp = function (prefix, a, b) {\n    var _a = getDefaultOptsAndCb(a, b),\n        encoding = _a[0].encoding,\n        callback = _a[1];\n\n    if (!prefix || typeof prefix !== 'string') throw new TypeError('filename prefix is required');\n    if (!nullCheck(prefix)) return;\n    this.wrapAsync(this.mkdtempBase, [prefix, encoding], callback);\n  };\n\n  Volume.prototype.rmdirBase = function (filename, options) {\n    var opts = getRmdirOptions(options);\n    var link = this.getLinkAsDirOrThrow(filename, 'rmdir'); // Check directory is empty.\n\n    if (link.length && !opts.recursive) throw createError(ENOTEMPTY, 'rmdir', filename);\n    this.deleteLink(link);\n  };\n\n  Volume.prototype.rmdirSync = function (path, options) {\n    this.rmdirBase(pathToFilename(path), options);\n  };\n\n  Volume.prototype.rmdir = function (path, a, b) {\n    var opts = getRmdirOptions(a);\n    var callback = validateCallback(typeof a === 'function' ? a : b);\n    this.wrapAsync(this.rmdirBase, [pathToFilename(path), opts], callback);\n  };\n\n  Volume.prototype.rmBase = function (filename, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var link = this.getResolvedLink(filename);\n\n    if (!link) {\n      // \"stat\" is used to match Node's native error message.\n      if (!options.force) throw createError(ENOENT, 'stat', filename);\n      return;\n    }\n\n    if (link.getNode().isDirectory()) {\n      if (!options.recursive) {\n        throw createError(ERR_FS_EISDIR, 'rm', filename);\n      }\n    }\n\n    this.deleteLink(link);\n  };\n\n  Volume.prototype.rmSync = function (path, options) {\n    this.rmBase(pathToFilename(path), options);\n  };\n\n  Volume.prototype.rm = function (path, a, b) {\n    var _a = getRmOptsAndCb(a, b),\n        opts = _a[0],\n        callback = _a[1];\n\n    this.wrapAsync(this.rmBase, [pathToFilename(path), opts], callback);\n  };\n\n  Volume.prototype.fchmodBase = function (fd, modeNum) {\n    var file = this.getFileByFdOrThrow(fd, 'fchmod');\n    file.chmod(modeNum);\n  };\n\n  Volume.prototype.fchmodSync = function (fd, mode) {\n    this.fchmodBase(fd, modeToNumber(mode));\n  };\n\n  Volume.prototype.fchmod = function (fd, mode, callback) {\n    this.wrapAsync(this.fchmodBase, [fd, modeToNumber(mode)], callback);\n  };\n\n  Volume.prototype.chmodBase = function (filename, modeNum) {\n    var fd = this.openSync(filename, 'r+');\n\n    try {\n      this.fchmodBase(fd, modeNum);\n    } finally {\n      this.closeSync(fd);\n    }\n  };\n\n  Volume.prototype.chmodSync = function (path, mode) {\n    var modeNum = modeToNumber(mode);\n    var filename = pathToFilename(path);\n    this.chmodBase(filename, modeNum);\n  };\n\n  Volume.prototype.chmod = function (path, mode, callback) {\n    var modeNum = modeToNumber(mode);\n    var filename = pathToFilename(path);\n    this.wrapAsync(this.chmodBase, [filename, modeNum], callback);\n  };\n\n  Volume.prototype.lchmodBase = function (filename, modeNum) {\n    var fd = this.openBase(filename, O_RDWR, 0, false);\n\n    try {\n      this.fchmodBase(fd, modeNum);\n    } finally {\n      this.closeSync(fd);\n    }\n  };\n\n  Volume.prototype.lchmodSync = function (path, mode) {\n    var modeNum = modeToNumber(mode);\n    var filename = pathToFilename(path);\n    this.lchmodBase(filename, modeNum);\n  };\n\n  Volume.prototype.lchmod = function (path, mode, callback) {\n    var modeNum = modeToNumber(mode);\n    var filename = pathToFilename(path);\n    this.wrapAsync(this.lchmodBase, [filename, modeNum], callback);\n  };\n\n  Volume.prototype.fchownBase = function (fd, uid, gid) {\n    this.getFileByFdOrThrow(fd, 'fchown').chown(uid, gid);\n  };\n\n  Volume.prototype.fchownSync = function (fd, uid, gid) {\n    validateUid(uid);\n    validateGid(gid);\n    this.fchownBase(fd, uid, gid);\n  };\n\n  Volume.prototype.fchown = function (fd, uid, gid, callback) {\n    validateUid(uid);\n    validateGid(gid);\n    this.wrapAsync(this.fchownBase, [fd, uid, gid], callback);\n  };\n\n  Volume.prototype.chownBase = function (filename, uid, gid) {\n    var link = this.getResolvedLinkOrThrow(filename, 'chown');\n    var node = link.getNode();\n    node.chown(uid, gid); // if(node.isFile() || node.isSymlink()) {\n    //\n    // } else if(node.isDirectory()) {\n    //\n    // } else {\n    // TODO: What do we do here?\n    // }\n  };\n\n  Volume.prototype.chownSync = function (path, uid, gid) {\n    validateUid(uid);\n    validateGid(gid);\n    this.chownBase(pathToFilename(path), uid, gid);\n  };\n\n  Volume.prototype.chown = function (path, uid, gid, callback) {\n    validateUid(uid);\n    validateGid(gid);\n    this.wrapAsync(this.chownBase, [pathToFilename(path), uid, gid], callback);\n  };\n\n  Volume.prototype.lchownBase = function (filename, uid, gid) {\n    this.getLinkOrThrow(filename, 'lchown').getNode().chown(uid, gid);\n  };\n\n  Volume.prototype.lchownSync = function (path, uid, gid) {\n    validateUid(uid);\n    validateGid(gid);\n    this.lchownBase(pathToFilename(path), uid, gid);\n  };\n\n  Volume.prototype.lchown = function (path, uid, gid, callback) {\n    validateUid(uid);\n    validateGid(gid);\n    this.wrapAsync(this.lchownBase, [pathToFilename(path), uid, gid], callback);\n  };\n\n  Volume.prototype.watchFile = function (path, a, b) {\n    var filename = pathToFilename(path);\n    var options = a;\n    var listener = b;\n\n    if (typeof options === 'function') {\n      listener = a;\n      options = null;\n    }\n\n    if (typeof listener !== 'function') {\n      throw Error('\"watchFile()\" requires a listener function');\n    }\n\n    var interval = 5007;\n    var persistent = true;\n\n    if (options && typeof options === 'object') {\n      if (typeof options.interval === 'number') interval = options.interval;\n      if (typeof options.persistent === 'boolean') persistent = options.persistent;\n    }\n\n    var watcher = this.statWatchers[filename];\n\n    if (!watcher) {\n      watcher = new this.StatWatcher();\n      watcher.start(filename, persistent, interval);\n      this.statWatchers[filename] = watcher;\n    }\n\n    watcher.addListener('change', listener);\n    return watcher;\n  };\n\n  Volume.prototype.unwatchFile = function (path, listener) {\n    var filename = pathToFilename(path);\n    var watcher = this.statWatchers[filename];\n    if (!watcher) return;\n\n    if (typeof listener === 'function') {\n      watcher.removeListener('change', listener);\n    } else {\n      watcher.removeAllListeners('change');\n    }\n\n    if (watcher.listenerCount('change') === 0) {\n      watcher.stop();\n      delete this.statWatchers[filename];\n    }\n  };\n\n  Volume.prototype.createReadStream = function (path, options) {\n    return new this.ReadStream(path, options);\n  };\n\n  Volume.prototype.createWriteStream = function (path, options) {\n    return new this.WriteStream(path, options);\n  }; // watch(path: PathLike): FSWatcher;\n  // watch(path: PathLike, options?: IWatchOptions | string): FSWatcher;\n\n\n  Volume.prototype.watch = function (path, options, listener) {\n    var filename = pathToFilename(path);\n    var givenOptions = options;\n\n    if (typeof options === 'function') {\n      listener = options;\n      givenOptions = null;\n    } // tslint:disable-next-line prefer-const\n\n\n    var _a = getDefaultOpts(givenOptions),\n        persistent = _a.persistent,\n        recursive = _a.recursive,\n        encoding = _a.encoding;\n\n    if (persistent === undefined) persistent = true;\n    if (recursive === undefined) recursive = false;\n    var watcher = new this.FSWatcher();\n    watcher.start(filename, persistent, recursive, encoding);\n\n    if (listener) {\n      watcher.addListener('change', listener);\n    }\n\n    return watcher;\n  };\n  /**\n   * Global file descriptor counter. UNIX file descriptors start from 0 and go sequentially\n   * up, so here, in order not to conflict with them, we choose some big number and descrease\n   * the file descriptor of every new opened file.\n   * @type {number}\n   * @todo This should not be static, right?\n   */\n\n\n  Volume.fd = 0x7fffffff;\n  return Volume;\n}();\n\nexports.Volume = Volume;\n\nfunction emitStop(self) {\n  self.emit('stop');\n}\n\nvar StatWatcher =\n/** @class */\nfunction (_super) {\n  __extends(StatWatcher, _super);\n\n  function StatWatcher(vol) {\n    var _this = _super.call(this) || this;\n\n    _this.onInterval = function () {\n      try {\n        var stats = _this.vol.statSync(_this.filename);\n\n        if (_this.hasChanged(stats)) {\n          _this.emit('change', stats, _this.prev);\n\n          _this.prev = stats;\n        }\n      } finally {\n        _this.loop();\n      }\n    };\n\n    _this.vol = vol;\n    return _this;\n  }\n\n  StatWatcher.prototype.loop = function () {\n    this.timeoutRef = this.setTimeout(this.onInterval, this.interval);\n  };\n\n  StatWatcher.prototype.hasChanged = function (stats) {\n    // if(!this.prev) return false;\n    if (stats.mtimeMs > this.prev.mtimeMs) return true;\n    if (stats.nlink !== this.prev.nlink) return true;\n    return false;\n  };\n\n  StatWatcher.prototype.start = function (path, persistent, interval) {\n    if (persistent === void 0) {\n      persistent = true;\n    }\n\n    if (interval === void 0) {\n      interval = 5007;\n    }\n\n    this.filename = pathToFilename(path);\n    this.setTimeout = persistent ? setTimeout.bind(typeof globalThis !== 'undefined' ? globalThis : global) : setTimeoutUnref_1.default;\n    this.interval = interval;\n    this.prev = this.vol.statSync(this.filename);\n    this.loop();\n  };\n\n  StatWatcher.prototype.stop = function () {\n    clearTimeout(this.timeoutRef);\n    process_1.default.nextTick(emitStop, this);\n  };\n\n  return StatWatcher;\n}(events_1.EventEmitter);\n\nexports.StatWatcher = StatWatcher;\nvar pool;\n\nfunction allocNewPool(poolSize) {\n  pool = (0, buffer_1.bufferAllocUnsafe)(poolSize);\n  pool.used = 0;\n}\n\nutil.inherits(FsReadStream, stream_1.Readable);\nexports.ReadStream = FsReadStream;\n\nfunction FsReadStream(vol, path, options) {\n  if (!(this instanceof FsReadStream)) return new FsReadStream(vol, path, options);\n  this._vol = vol; // a little bit bigger buffer and water marks by default\n\n  options = Object.assign({}, getOptions(options, {}));\n  if (options.highWaterMark === undefined) options.highWaterMark = 64 * 1024;\n  stream_1.Readable.call(this, options);\n  this.path = pathToFilename(path);\n  this.fd = options.fd === undefined ? null : options.fd;\n  this.flags = options.flags === undefined ? 'r' : options.flags;\n  this.mode = options.mode === undefined ? 438 : options.mode;\n  this.start = options.start;\n  this.end = options.end;\n  this.autoClose = options.autoClose === undefined ? true : options.autoClose;\n  this.pos = undefined;\n  this.bytesRead = 0;\n\n  if (this.start !== undefined) {\n    if (typeof this.start !== 'number') {\n      throw new TypeError('\"start\" option must be a Number');\n    }\n\n    if (this.end === undefined) {\n      this.end = Infinity;\n    } else if (typeof this.end !== 'number') {\n      throw new TypeError('\"end\" option must be a Number');\n    }\n\n    if (this.start > this.end) {\n      throw new Error('\"start\" option must be <= \"end\" option');\n    }\n\n    this.pos = this.start;\n  }\n\n  if (typeof this.fd !== 'number') this.open();\n  this.on('end', function () {\n    if (this.autoClose) {\n      if (this.destroy) this.destroy();\n    }\n  });\n}\n\nFsReadStream.prototype.open = function () {\n  var self = this; // tslint:disable-line no-this-assignment\n\n  this._vol.open(this.path, this.flags, this.mode, function (er, fd) {\n    if (er) {\n      if (self.autoClose) {\n        if (self.destroy) self.destroy();\n      }\n\n      self.emit('error', er);\n      return;\n    }\n\n    self.fd = fd;\n    self.emit('open', fd); // start the flow of data.\n\n    self.read();\n  });\n};\n\nFsReadStream.prototype._read = function (n) {\n  if (typeof this.fd !== 'number') {\n    return this.once('open', function () {\n      this._read(n);\n    });\n  }\n\n  if (this.destroyed) return;\n\n  if (!pool || pool.length - pool.used < kMinPoolSpace) {\n    // discard the old pool.\n    allocNewPool(this._readableState.highWaterMark);\n  } // Grab another reference to the pool in the case that while we're\n  // in the thread pool another read() finishes up the pool, and\n  // allocates a new one.\n\n\n  var thisPool = pool;\n  var toRead = Math.min(pool.length - pool.used, n);\n  var start = pool.used;\n  if (this.pos !== undefined) toRead = Math.min(this.end - this.pos + 1, toRead); // already read everything we were supposed to read!\n  // treat as EOF.\n\n  if (toRead <= 0) return this.push(null); // the actual read.\n\n  var self = this; // tslint:disable-line no-this-assignment\n\n  this._vol.read(this.fd, pool, pool.used, toRead, this.pos, onread); // move the pool positions, and internal position for reading.\n\n\n  if (this.pos !== undefined) this.pos += toRead;\n  pool.used += toRead;\n\n  function onread(er, bytesRead) {\n    if (er) {\n      if (self.autoClose && self.destroy) {\n        self.destroy();\n      }\n\n      self.emit('error', er);\n    } else {\n      var b = null;\n\n      if (bytesRead > 0) {\n        self.bytesRead += bytesRead;\n        b = thisPool.slice(start, start + bytesRead);\n      }\n\n      self.push(b);\n    }\n  }\n};\n\nFsReadStream.prototype._destroy = function (err, cb) {\n  this.close(function (err2) {\n    cb(err || err2);\n  });\n};\n\nFsReadStream.prototype.close = function (cb) {\n  var _this = this;\n\n  var _a;\n\n  if (cb) this.once('close', cb);\n\n  if (this.closed || typeof this.fd !== 'number') {\n    if (typeof this.fd !== 'number') {\n      this.once('open', closeOnOpen);\n      return;\n    }\n\n    return process_1.default.nextTick(function () {\n      return _this.emit('close');\n    });\n  } // Since Node 18, there is only a getter for '.closed'.\n  // The first branch mimics other setters from Readable.\n  // See https://github.com/nodejs/node/blob/v18.0.0/lib/internal/streams/readable.js#L1243\n\n\n  if (typeof ((_a = this._readableState) === null || _a === void 0 ? void 0 : _a.closed) === 'boolean') {\n    this._readableState.closed = true;\n  } else {\n    this.closed = true;\n  }\n\n  this._vol.close(this.fd, function (er) {\n    if (er) _this.emit('error', er);else _this.emit('close');\n  });\n\n  this.fd = null;\n}; // needed because as it will be called with arguments\n// that does not match this.close() signature\n\n\nfunction closeOnOpen(fd) {\n  this.close();\n}\n\nutil.inherits(FsWriteStream, stream_1.Writable);\nexports.WriteStream = FsWriteStream;\n\nfunction FsWriteStream(vol, path, options) {\n  if (!(this instanceof FsWriteStream)) return new FsWriteStream(vol, path, options);\n  this._vol = vol;\n  options = Object.assign({}, getOptions(options, {}));\n  stream_1.Writable.call(this, options);\n  this.path = pathToFilename(path);\n  this.fd = options.fd === undefined ? null : options.fd;\n  this.flags = options.flags === undefined ? 'w' : options.flags;\n  this.mode = options.mode === undefined ? 438 : options.mode;\n  this.start = options.start;\n  this.autoClose = options.autoClose === undefined ? true : !!options.autoClose;\n  this.pos = undefined;\n  this.bytesWritten = 0;\n\n  if (this.start !== undefined) {\n    if (typeof this.start !== 'number') {\n      throw new TypeError('\"start\" option must be a Number');\n    }\n\n    if (this.start < 0) {\n      throw new Error('\"start\" must be >= zero');\n    }\n\n    this.pos = this.start;\n  }\n\n  if (options.encoding) this.setDefaultEncoding(options.encoding);\n  if (typeof this.fd !== 'number') this.open(); // dispose on finish.\n\n  this.once('finish', function () {\n    if (this.autoClose) {\n      this.close();\n    }\n  });\n}\n\nFsWriteStream.prototype.open = function () {\n  this._vol.open(this.path, this.flags, this.mode, function (er, fd) {\n    if (er) {\n      if (this.autoClose && this.destroy) {\n        this.destroy();\n      }\n\n      this.emit('error', er);\n      return;\n    }\n\n    this.fd = fd;\n    this.emit('open', fd);\n  }.bind(this));\n};\n\nFsWriteStream.prototype._write = function (data, encoding, cb) {\n  if (!(data instanceof buffer_1.Buffer || data instanceof Uint8Array)) return this.emit('error', new Error('Invalid data'));\n\n  if (typeof this.fd !== 'number') {\n    return this.once('open', function () {\n      this._write(data, encoding, cb);\n    });\n  }\n\n  var self = this; // tslint:disable-line no-this-assignment\n\n  this._vol.write(this.fd, data, 0, data.length, this.pos, function (er, bytes) {\n    if (er) {\n      if (self.autoClose && self.destroy) {\n        self.destroy();\n      }\n\n      return cb(er);\n    }\n\n    self.bytesWritten += bytes;\n    cb();\n  });\n\n  if (this.pos !== undefined) this.pos += data.length;\n};\n\nFsWriteStream.prototype._writev = function (data, cb) {\n  if (typeof this.fd !== 'number') {\n    return this.once('open', function () {\n      this._writev(data, cb);\n    });\n  }\n\n  var self = this; // tslint:disable-line no-this-assignment\n\n  var len = data.length;\n  var chunks = new Array(len);\n  var size = 0;\n\n  for (var i = 0; i < len; i++) {\n    var chunk = data[i].chunk;\n    chunks[i] = chunk;\n    size += chunk.length;\n  }\n\n  var buf = buffer_1.Buffer.concat(chunks);\n\n  this._vol.write(this.fd, buf, 0, buf.length, this.pos, function (er, bytes) {\n    if (er) {\n      if (self.destroy) self.destroy();\n      return cb(er);\n    }\n\n    self.bytesWritten += bytes;\n    cb();\n  });\n\n  if (this.pos !== undefined) this.pos += size;\n};\n\nFsWriteStream.prototype.close = function (cb) {\n  var _this = this;\n\n  var _a;\n\n  if (cb) this.once('close', cb);\n\n  if (this.closed || typeof this.fd !== 'number') {\n    if (typeof this.fd !== 'number') {\n      this.once('open', closeOnOpen);\n      return;\n    }\n\n    return process_1.default.nextTick(function () {\n      return _this.emit('close');\n    });\n  } // Since Node 18, there is only a getter for '.closed'.\n  // The first branch mimics other setters from Writable.\n  // See https://github.com/nodejs/node/blob/v18.0.0/lib/internal/streams/writable.js#L766\n\n\n  if (typeof ((_a = this._writableState) === null || _a === void 0 ? void 0 : _a.closed) === 'boolean') {\n    this._writableState.closed = true;\n  } else {\n    this.closed = true;\n  }\n\n  this._vol.close(this.fd, function (er) {\n    if (er) _this.emit('error', er);else _this.emit('close');\n  });\n\n  this.fd = null;\n};\n\nFsWriteStream.prototype._destroy = FsReadStream.prototype._destroy; // There is no shutdown() for files.\n\nFsWriteStream.prototype.destroySoon = FsWriteStream.prototype.end; // ---------------------------------------- FSWatcher\n\nvar FSWatcher =\n/** @class */\nfunction (_super) {\n  __extends(FSWatcher, _super);\n\n  function FSWatcher(vol) {\n    var _this = _super.call(this) || this;\n\n    _this._filename = '';\n    _this._filenameEncoded = ''; // _persistent: boolean = true;\n\n    _this._recursive = false;\n    _this._encoding = encoding_1.ENCODING_UTF8;\n\n    _this._onNodeChange = function () {\n      _this._emit('change');\n    };\n\n    _this._onParentChild = function (link) {\n      if (link.getName() === _this._getName()) {\n        _this._emit('rename');\n      }\n    };\n\n    _this._emit = function (type) {\n      _this.emit('change', type, _this._filenameEncoded);\n    };\n\n    _this._persist = function () {\n      _this._timer = setTimeout(_this._persist, 1e6);\n    };\n\n    _this._vol = vol;\n    return _this; // TODO: Emit \"error\" messages when watching.\n    // this._handle.onchange = function(status, eventType, filename) {\n    //     if (status < 0) {\n    //         self._handle.close();\n    //         const error = !filename ?\n    //             errnoException(status, 'Error watching file for changes:') :\n    //             errnoException(status, `Error watching file ${filename} for changes:`);\n    //         error.filename = filename;\n    //         self.emit('error', error);\n    //     } else {\n    //         self.emit('change', eventType, filename);\n    //     }\n    // };\n  }\n\n  FSWatcher.prototype._getName = function () {\n    return this._steps[this._steps.length - 1];\n  };\n\n  FSWatcher.prototype.start = function (path, persistent, recursive, encoding) {\n    if (persistent === void 0) {\n      persistent = true;\n    }\n\n    if (recursive === void 0) {\n      recursive = false;\n    }\n\n    if (encoding === void 0) {\n      encoding = encoding_1.ENCODING_UTF8;\n    }\n\n    this._filename = pathToFilename(path);\n    this._steps = filenameToSteps(this._filename);\n    this._filenameEncoded = (0, encoding_1.strToEncoding)(this._filename); // this._persistent = persistent;\n\n    this._recursive = recursive;\n    this._encoding = encoding;\n\n    try {\n      this._link = this._vol.getLinkOrThrow(this._filename, 'FSWatcher');\n    } catch (err) {\n      var error = new Error(\"watch \".concat(this._filename, \" \").concat(err.code));\n      error.code = err.code;\n      error.errno = err.code;\n      throw error;\n    }\n\n    this._link.getNode().on('change', this._onNodeChange);\n\n    this._link.on('child:add', this._onNodeChange);\n\n    this._link.on('child:delete', this._onNodeChange);\n\n    var parent = this._link.parent;\n\n    if (parent) {\n      // parent.on('child:add', this._onParentChild);\n      parent.setMaxListeners(parent.getMaxListeners() + 1);\n      parent.on('child:delete', this._onParentChild);\n    }\n\n    if (persistent) this._persist();\n  };\n\n  FSWatcher.prototype.close = function () {\n    clearTimeout(this._timer);\n\n    this._link.getNode().removeListener('change', this._onNodeChange);\n\n    var parent = this._link.parent;\n\n    if (parent) {\n      // parent.removeListener('child:add', this._onParentChild);\n      parent.removeListener('child:delete', this._onParentChild);\n    }\n  };\n\n  return FSWatcher;\n}(events_1.EventEmitter);\n\nexports.FSWatcher = FSWatcher;","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__spreadArray","to","from","pack","arguments","length","i","l","ar","slice","concat","defineProperty","exports","value","FSWatcher","StatWatcher","Volume","toUnixTimestamp","bufferToEncoding","dataToBuffer","dataToStr","pathToSteps","filenameToSteps","pathToFilename","flagsToNumber","FLAGS","pathModule","require","node_1","Stats_1","Dirent_1","buffer_1","setImmediate_1","process_1","setTimeoutUnref_1","stream_1","constants_1","events_1","encoding_1","errors","util","promises_1","resolveCrossPlatform","resolve","O_RDONLY","constants","O_WRONLY","O_RDWR","O_CREAT","O_EXCL","O_TRUNC","O_APPEND","O_SYNC","O_DIRECTORY","F_OK","COPYFILE_EXCL","COPYFILE_FICLONE_FORCE","_a","posix","sep","relative","join","dirname","isWin","default","platform","kMinPoolSpace","ERRSTR","PATH_STR","FD","MODE_INT","CB","UID","GID","LEN","ATIME","MTIME","PREFIX","BUFFER","OFFSET","LENGTH","POSITION","ERRSTR_OPTS","tipeof","ENOENT","EBADF","EINVAL","EPERM","EPROTO","EEXIST","ENOTDIR","EMFILE","EACCES","EISDIR","ENOTEMPTY","ENOSYS","ERR_FS_EISDIR","formatError","errorCode","func","path","path2","pathFormatted","createError","Constructor","Error","error","code","rs","wx","ax","flags","flagsNum","getOptions","defaults","options","opts","assign","encoding","assertEncoding","optsGenerator","validateCallback","callback","optsAndCbGenerator","getOpts","optsDefaults","getDefaultOpts","getDefaultOptsAndCb","readFileOptsDefaults","flag","getReadFileOptions","writeFileDefaults","mode","w","getWriteFileOptions","appendFileDefaults","a","getAppendFileOpts","getAppendFileOptsAndCb","realpathDefaults","getRealpathOptions","getRealpathOptsAndCb","mkdirDefaults","recursive","getMkdirOptions","rmdirDefaults","getRmdirOptions","getRmOpts","getRmOptsAndCb","readdirDefaults","withFileTypes","getReaddirOptions","getReaddirOptsAndCb","statDefaults","bigint","getStatOptions","getStatOptsAndCb","getPathFromURLPosix","url","hostname","pathname","n","third","codePointAt","decodeURIComponent","Buffer","isBuffer","URL","err","pathString","nullCheck","filename","base","cwd","_resolve_1","unixify_1","unixify","fullPath","fullPathSansSlash","substr","split","data","ENCODING_UTF8","toString","Uint8Array","bufferFrom","buffer","indexOf","er","nextTick","_modeToNumber","def","parseInt","modeToNumber","undefined","result","isNaN","isFd","validateFd","fd","time","Date","getTime","isFinite","now","validateUid","uid","validateGid","gid","flattenJSON","nestedJSON","flatJSON","flatten","pathPrefix","node","contentOrNode","joinedPath","keys","props","ino","inodes","releasedInos","fds","releasedFds","maxFiles","openFiles","promisesApi","statWatchers","Node","Link","File","root","createLink","setNode","createNode","self","_super","_ReadStream","FsReadStream","ReadStream","class_1","args","_i","apply","_WriteStream","FsWriteStream","WriteStream","class_2","fromJSON","json","vol","fromNestedJSON","get","enumerable","configurable","parent","name","isDirectory","perm","createChild","deleteLink","link","deleteChild","newInoNumber","releasedFd","pop","newFdNumber","setIsDirectory","getNode","deleteNode","del","push","genRndStr","str","Math","random","getLink","steps","walk","getLinkOrThrow","funcName","getResolvedLink","filenameOrSteps","step","getChild","isSymlink","symlink","getResolvedLinkOrThrow","resolveSymlinks","getLinkAsDirOrThrow","getLinkParent","getLinkParentAsDirOrThrow","getFileByFd","getFileByFdOrThrow","file","wrapAsync","method","_this","_toJSON","isEmpty","children","isFile","getName","name_1","child","getPath","getString","dirPath","toJSON","paths","isRelative","links","paths_1","links_1","dir","mkdirpBase","writeFileSync","reset","mountSync","mountpoint","openLink","realLink","canRead","truncate","openFile","modeNum","dirLink","openBase","openSync","fileName","open","closeFile","closeSync","close","openFileOrGetById","id","readBase","offset","position","read","Number","readSync","bytes","readFileBase","isUserFd","userOwnsFd","getBuffer","readFileSync","readFile","writeBase","buf","write","writeSync","c","e","tipa","tipb","tipc","tipd","cb","writeFileBase","written","writeFile","linkBase","filename1","filename2","steps1","link1","steps2","dir2","nlink","copyFileBase","src","dest","existsSync","copyFileSync","srcFilename","destFilename","copyFile","linkSync","existingPath","newPath","existingPathFilename","newPathFilename","unlinkBase","unlinkSync","unlink","symlinkBase","targetFilename","pathFilename","pathSteps","makeSymlink","symlinkSync","target","type","realpathBase","strToEncoding","realpathSync","realpath","lstatBase","throwIfNoEntry","build","lstatSync","_b","_c","lstat","_d","statBase","statSync","stat","fstatBase","fstatSync","fstat","renameBase","oldPathFilename","newPathSteps","newPathDirLink","oldLinkParent","setChild","renameSync","oldPath","rename","existsBase","exists","accessBase","accessSync","access","appendFileSync","appendFile","readdirBase","list_1","name_2","sort","list","name_3","readdirSync","readdir","readlinkBase","readlinkSync","readlink","fsyncBase","fsyncSync","fsync","fdatasyncBase","fdatasyncSync","fdatasync","ftruncateBase","len","ftruncateSync","ftruncate","truncateBase","truncateSync","futimesBase","atime","mtime","futimesSync","futimes","utimesBase","utimesSync","utimes","mkdirBase","mkdirSync","mkdir","mkdirpSync","mkdirp","mkdtempBase","prefix","retry","mkdtempSync","mkdtemp","rmdirBase","rmdirSync","rmdir","rmBase","force","rmSync","rm","fchmodBase","chmod","fchmodSync","fchmod","chmodBase","chmodSync","lchmodBase","lchmodSync","lchmod","fchownBase","chown","fchownSync","fchown","chownBase","chownSync","lchownBase","lchownSync","lchown","watchFile","listener","interval","persistent","watcher","start","addListener","unwatchFile","removeListener","removeAllListeners","listenerCount","stop","createReadStream","createWriteStream","watch","givenOptions","emitStop","emit","onInterval","stats","hasChanged","prev","loop","timeoutRef","setTimeout","mtimeMs","bind","globalThis","global","clearTimeout","EventEmitter","pool","allocNewPool","poolSize","bufferAllocUnsafe","used","inherits","Readable","_vol","highWaterMark","end","autoClose","pos","bytesRead","Infinity","on","destroy","_read","once","destroyed","_readableState","thisPool","toRead","min","onread","_destroy","err2","closed","closeOnOpen","Writable","bytesWritten","setDefaultEncoding","_write","_writev","chunks","size","chunk","_writableState","destroySoon","_filename","_filenameEncoded","_recursive","_encoding","_onNodeChange","_emit","_onParentChild","_getName","_persist","_timer","_steps","_link","errno","setMaxListeners","getMaxListeners"],"sources":["C:/Users/Rohith/mern/frontend/node_modules/memfs/lib/volume.js"],"sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FSWatcher = exports.StatWatcher = exports.Volume = exports.toUnixTimestamp = exports.bufferToEncoding = exports.dataToBuffer = exports.dataToStr = exports.pathToSteps = exports.filenameToSteps = exports.pathToFilename = exports.flagsToNumber = exports.FLAGS = void 0;\nvar pathModule = require(\"path\");\nvar node_1 = require(\"./node\");\nvar Stats_1 = require(\"./Stats\");\nvar Dirent_1 = require(\"./Dirent\");\nvar buffer_1 = require(\"./internal/buffer\");\nvar setImmediate_1 = require(\"./setImmediate\");\nvar process_1 = require(\"./process\");\nvar setTimeoutUnref_1 = require(\"./setTimeoutUnref\");\nvar stream_1 = require(\"stream\");\nvar constants_1 = require(\"./constants\");\nvar events_1 = require(\"events\");\nvar encoding_1 = require(\"./encoding\");\nvar errors = require(\"./internal/errors\");\nvar util = require(\"util\");\nvar promises_1 = require(\"./promises\");\nvar resolveCrossPlatform = pathModule.resolve;\nvar O_RDONLY = constants_1.constants.O_RDONLY, O_WRONLY = constants_1.constants.O_WRONLY, O_RDWR = constants_1.constants.O_RDWR, O_CREAT = constants_1.constants.O_CREAT, O_EXCL = constants_1.constants.O_EXCL, O_TRUNC = constants_1.constants.O_TRUNC, O_APPEND = constants_1.constants.O_APPEND, O_SYNC = constants_1.constants.O_SYNC, O_DIRECTORY = constants_1.constants.O_DIRECTORY, F_OK = constants_1.constants.F_OK, COPYFILE_EXCL = constants_1.constants.COPYFILE_EXCL, COPYFILE_FICLONE_FORCE = constants_1.constants.COPYFILE_FICLONE_FORCE;\nvar _a = pathModule.posix ? pathModule.posix : pathModule, sep = _a.sep, relative = _a.relative, join = _a.join, dirname = _a.dirname;\nvar isWin = process_1.default.platform === 'win32';\nvar kMinPoolSpace = 128;\n// const kMaxLength = require('buffer').kMaxLength;\n// ---------------------------------------- Error messages\n// TODO: Use `internal/errors.js` in the future.\nvar ERRSTR = {\n    PATH_STR: 'path must be a string or Buffer',\n    // FD:             'file descriptor must be a unsigned 32-bit integer',\n    FD: 'fd must be a file descriptor',\n    MODE_INT: 'mode must be an int',\n    CB: 'callback must be a function',\n    UID: 'uid must be an unsigned int',\n    GID: 'gid must be an unsigned int',\n    LEN: 'len must be an integer',\n    ATIME: 'atime must be an integer',\n    MTIME: 'mtime must be an integer',\n    PREFIX: 'filename prefix is required',\n    BUFFER: 'buffer must be an instance of Buffer or StaticBuffer',\n    OFFSET: 'offset must be an integer',\n    LENGTH: 'length must be an integer',\n    POSITION: 'position must be an integer',\n};\nvar ERRSTR_OPTS = function (tipeof) { return \"Expected options to be either an object or a string, but got \".concat(tipeof, \" instead\"); };\n// const ERRSTR_FLAG = flag => `Unknown file open flag: ${flag}`;\nvar ENOENT = 'ENOENT';\nvar EBADF = 'EBADF';\nvar EINVAL = 'EINVAL';\nvar EPERM = 'EPERM';\nvar EPROTO = 'EPROTO';\nvar EEXIST = 'EEXIST';\nvar ENOTDIR = 'ENOTDIR';\nvar EMFILE = 'EMFILE';\nvar EACCES = 'EACCES';\nvar EISDIR = 'EISDIR';\nvar ENOTEMPTY = 'ENOTEMPTY';\nvar ENOSYS = 'ENOSYS';\nvar ERR_FS_EISDIR = 'ERR_FS_EISDIR';\nfunction formatError(errorCode, func, path, path2) {\n    if (func === void 0) { func = ''; }\n    if (path === void 0) { path = ''; }\n    if (path2 === void 0) { path2 = ''; }\n    var pathFormatted = '';\n    if (path)\n        pathFormatted = \" '\".concat(path, \"'\");\n    if (path2)\n        pathFormatted += \" -> '\".concat(path2, \"'\");\n    switch (errorCode) {\n        case ENOENT:\n            return \"ENOENT: no such file or directory, \".concat(func).concat(pathFormatted);\n        case EBADF:\n            return \"EBADF: bad file descriptor, \".concat(func).concat(pathFormatted);\n        case EINVAL:\n            return \"EINVAL: invalid argument, \".concat(func).concat(pathFormatted);\n        case EPERM:\n            return \"EPERM: operation not permitted, \".concat(func).concat(pathFormatted);\n        case EPROTO:\n            return \"EPROTO: protocol error, \".concat(func).concat(pathFormatted);\n        case EEXIST:\n            return \"EEXIST: file already exists, \".concat(func).concat(pathFormatted);\n        case ENOTDIR:\n            return \"ENOTDIR: not a directory, \".concat(func).concat(pathFormatted);\n        case EISDIR:\n            return \"EISDIR: illegal operation on a directory, \".concat(func).concat(pathFormatted);\n        case EACCES:\n            return \"EACCES: permission denied, \".concat(func).concat(pathFormatted);\n        case ENOTEMPTY:\n            return \"ENOTEMPTY: directory not empty, \".concat(func).concat(pathFormatted);\n        case EMFILE:\n            return \"EMFILE: too many open files, \".concat(func).concat(pathFormatted);\n        case ENOSYS:\n            return \"ENOSYS: function not implemented, \".concat(func).concat(pathFormatted);\n        case ERR_FS_EISDIR:\n            return \"[ERR_FS_EISDIR]: Path is a directory: \".concat(func, \" returned EISDIR (is a directory) \").concat(path);\n        default:\n            return \"\".concat(errorCode, \": error occurred, \").concat(func).concat(pathFormatted);\n    }\n}\nfunction createError(errorCode, func, path, path2, Constructor) {\n    if (func === void 0) { func = ''; }\n    if (path === void 0) { path = ''; }\n    if (path2 === void 0) { path2 = ''; }\n    if (Constructor === void 0) { Constructor = Error; }\n    var error = new Constructor(formatError(errorCode, func, path, path2));\n    error.code = errorCode;\n    return error;\n}\n// ---------------------------------------- Flags\n// List of file `flags` as defined by Node.\nvar FLAGS;\n(function (FLAGS) {\n    // Open file for reading. An exception occurs if the file does not exist.\n    FLAGS[FLAGS[\"r\"] = O_RDONLY] = \"r\";\n    // Open file for reading and writing. An exception occurs if the file does not exist.\n    FLAGS[FLAGS[\"r+\"] = O_RDWR] = \"r+\";\n    // Open file for reading in synchronous mode. Instructs the operating system to bypass the local file system cache.\n    FLAGS[FLAGS[\"rs\"] = O_RDONLY | O_SYNC] = \"rs\";\n    FLAGS[FLAGS[\"sr\"] = FLAGS.rs] = \"sr\";\n    // Open file for reading and writing, telling the OS to open it synchronously. See notes for 'rs' about using this with caution.\n    FLAGS[FLAGS[\"rs+\"] = O_RDWR | O_SYNC] = \"rs+\";\n    FLAGS[FLAGS[\"sr+\"] = FLAGS['rs+']] = \"sr+\";\n    // Open file for writing. The file is created (if it does not exist) or truncated (if it exists).\n    FLAGS[FLAGS[\"w\"] = O_WRONLY | O_CREAT | O_TRUNC] = \"w\";\n    // Like 'w' but fails if path exists.\n    FLAGS[FLAGS[\"wx\"] = O_WRONLY | O_CREAT | O_TRUNC | O_EXCL] = \"wx\";\n    FLAGS[FLAGS[\"xw\"] = FLAGS.wx] = \"xw\";\n    // Open file for reading and writing. The file is created (if it does not exist) or truncated (if it exists).\n    FLAGS[FLAGS[\"w+\"] = O_RDWR | O_CREAT | O_TRUNC] = \"w+\";\n    // Like 'w+' but fails if path exists.\n    FLAGS[FLAGS[\"wx+\"] = O_RDWR | O_CREAT | O_TRUNC | O_EXCL] = \"wx+\";\n    FLAGS[FLAGS[\"xw+\"] = FLAGS['wx+']] = \"xw+\";\n    // Open file for appending. The file is created if it does not exist.\n    FLAGS[FLAGS[\"a\"] = O_WRONLY | O_APPEND | O_CREAT] = \"a\";\n    // Like 'a' but fails if path exists.\n    FLAGS[FLAGS[\"ax\"] = O_WRONLY | O_APPEND | O_CREAT | O_EXCL] = \"ax\";\n    FLAGS[FLAGS[\"xa\"] = FLAGS.ax] = \"xa\";\n    // Open file for reading and appending. The file is created if it does not exist.\n    FLAGS[FLAGS[\"a+\"] = O_RDWR | O_APPEND | O_CREAT] = \"a+\";\n    // Like 'a+' but fails if path exists.\n    FLAGS[FLAGS[\"ax+\"] = O_RDWR | O_APPEND | O_CREAT | O_EXCL] = \"ax+\";\n    FLAGS[FLAGS[\"xa+\"] = FLAGS['ax+']] = \"xa+\";\n})(FLAGS = exports.FLAGS || (exports.FLAGS = {}));\nfunction flagsToNumber(flags) {\n    if (typeof flags === 'number')\n        return flags;\n    if (typeof flags === 'string') {\n        var flagsNum = FLAGS[flags];\n        if (typeof flagsNum !== 'undefined')\n            return flagsNum;\n    }\n    // throw new TypeError(formatError(ERRSTR_FLAG(flags)));\n    throw new errors.TypeError('ERR_INVALID_OPT_VALUE', 'flags', flags);\n}\nexports.flagsToNumber = flagsToNumber;\n// ---------------------------------------- Options\nfunction getOptions(defaults, options) {\n    var opts;\n    if (!options)\n        return defaults;\n    else {\n        var tipeof = typeof options;\n        switch (tipeof) {\n            case 'string':\n                opts = Object.assign({}, defaults, { encoding: options });\n                break;\n            case 'object':\n                opts = Object.assign({}, defaults, options);\n                break;\n            default:\n                throw TypeError(ERRSTR_OPTS(tipeof));\n        }\n    }\n    if (opts.encoding !== 'buffer')\n        (0, encoding_1.assertEncoding)(opts.encoding);\n    return opts;\n}\nfunction optsGenerator(defaults) {\n    return function (options) { return getOptions(defaults, options); };\n}\nfunction validateCallback(callback) {\n    if (typeof callback !== 'function')\n        throw TypeError(ERRSTR.CB);\n    return callback;\n}\nfunction optsAndCbGenerator(getOpts) {\n    return function (options, callback) {\n        return typeof options === 'function' ? [getOpts(), options] : [getOpts(options), validateCallback(callback)];\n    };\n}\nvar optsDefaults = {\n    encoding: 'utf8',\n};\nvar getDefaultOpts = optsGenerator(optsDefaults);\nvar getDefaultOptsAndCb = optsAndCbGenerator(getDefaultOpts);\nvar readFileOptsDefaults = {\n    flag: 'r',\n};\nvar getReadFileOptions = optsGenerator(readFileOptsDefaults);\nvar writeFileDefaults = {\n    encoding: 'utf8',\n    mode: 438 /* MODE.DEFAULT */,\n    flag: FLAGS[FLAGS.w],\n};\nvar getWriteFileOptions = optsGenerator(writeFileDefaults);\nvar appendFileDefaults = {\n    encoding: 'utf8',\n    mode: 438 /* MODE.DEFAULT */,\n    flag: FLAGS[FLAGS.a],\n};\nvar getAppendFileOpts = optsGenerator(appendFileDefaults);\nvar getAppendFileOptsAndCb = optsAndCbGenerator(getAppendFileOpts);\nvar realpathDefaults = optsDefaults;\nvar getRealpathOptions = optsGenerator(realpathDefaults);\nvar getRealpathOptsAndCb = optsAndCbGenerator(getRealpathOptions);\nvar mkdirDefaults = {\n    mode: 511 /* MODE.DIR */,\n    recursive: false,\n};\nvar getMkdirOptions = function (options) {\n    if (typeof options === 'number')\n        return Object.assign({}, mkdirDefaults, { mode: options });\n    return Object.assign({}, mkdirDefaults, options);\n};\nvar rmdirDefaults = {\n    recursive: false,\n};\nvar getRmdirOptions = function (options) {\n    return Object.assign({}, rmdirDefaults, options);\n};\nvar getRmOpts = optsGenerator(optsDefaults);\nvar getRmOptsAndCb = optsAndCbGenerator(getRmOpts);\nvar readdirDefaults = {\n    encoding: 'utf8',\n    withFileTypes: false,\n};\nvar getReaddirOptions = optsGenerator(readdirDefaults);\nvar getReaddirOptsAndCb = optsAndCbGenerator(getReaddirOptions);\nvar statDefaults = {\n    bigint: false,\n};\nvar getStatOptions = function (options) {\n    if (options === void 0) { options = {}; }\n    return Object.assign({}, statDefaults, options);\n};\nvar getStatOptsAndCb = function (options, callback) {\n    return typeof options === 'function' ? [getStatOptions(), options] : [getStatOptions(options), validateCallback(callback)];\n};\n// ---------------------------------------- Utility functions\nfunction getPathFromURLPosix(url) {\n    if (url.hostname !== '') {\n        throw new errors.TypeError('ERR_INVALID_FILE_URL_HOST', process_1.default.platform);\n    }\n    var pathname = url.pathname;\n    for (var n = 0; n < pathname.length; n++) {\n        if (pathname[n] === '%') {\n            var third = pathname.codePointAt(n + 2) | 0x20;\n            if (pathname[n + 1] === '2' && third === 102) {\n                throw new errors.TypeError('ERR_INVALID_FILE_URL_PATH', 'must not include encoded / characters');\n            }\n        }\n    }\n    return decodeURIComponent(pathname);\n}\nfunction pathToFilename(path) {\n    if (typeof path !== 'string' && !buffer_1.Buffer.isBuffer(path)) {\n        try {\n            if (!(path instanceof require('url').URL))\n                throw new TypeError(ERRSTR.PATH_STR);\n        }\n        catch (err) {\n            throw new TypeError(ERRSTR.PATH_STR);\n        }\n        path = getPathFromURLPosix(path);\n    }\n    var pathString = String(path);\n    nullCheck(pathString);\n    // return slash(pathString);\n    return pathString;\n}\nexports.pathToFilename = pathToFilename;\nvar resolve = function (filename, base) {\n    if (base === void 0) { base = process_1.default.cwd(); }\n    return resolveCrossPlatform(base, filename);\n};\nif (isWin) {\n    var _resolve_1 = resolve;\n    var unixify_1 = require('fs-monkey/lib/correctPath').unixify;\n    resolve = function (filename, base) { return unixify_1(_resolve_1(filename, base)); };\n}\nfunction filenameToSteps(filename, base) {\n    var fullPath = resolve(filename, base);\n    var fullPathSansSlash = fullPath.substr(1);\n    if (!fullPathSansSlash)\n        return [];\n    return fullPathSansSlash.split(sep);\n}\nexports.filenameToSteps = filenameToSteps;\nfunction pathToSteps(path) {\n    return filenameToSteps(pathToFilename(path));\n}\nexports.pathToSteps = pathToSteps;\nfunction dataToStr(data, encoding) {\n    if (encoding === void 0) { encoding = encoding_1.ENCODING_UTF8; }\n    if (buffer_1.Buffer.isBuffer(data))\n        return data.toString(encoding);\n    else if (data instanceof Uint8Array)\n        return (0, buffer_1.bufferFrom)(data).toString(encoding);\n    else\n        return String(data);\n}\nexports.dataToStr = dataToStr;\nfunction dataToBuffer(data, encoding) {\n    if (encoding === void 0) { encoding = encoding_1.ENCODING_UTF8; }\n    if (buffer_1.Buffer.isBuffer(data))\n        return data;\n    else if (data instanceof Uint8Array)\n        return (0, buffer_1.bufferFrom)(data);\n    else\n        return (0, buffer_1.bufferFrom)(String(data), encoding);\n}\nexports.dataToBuffer = dataToBuffer;\nfunction bufferToEncoding(buffer, encoding) {\n    if (!encoding || encoding === 'buffer')\n        return buffer;\n    else\n        return buffer.toString(encoding);\n}\nexports.bufferToEncoding = bufferToEncoding;\nfunction nullCheck(path, callback) {\n    if (('' + path).indexOf('\\u0000') !== -1) {\n        var er = new Error('Path must be a string without null bytes');\n        er.code = ENOENT;\n        if (typeof callback !== 'function')\n            throw er;\n        process_1.default.nextTick(callback, er);\n        return false;\n    }\n    return true;\n}\nfunction _modeToNumber(mode, def) {\n    if (typeof mode === 'number')\n        return mode;\n    if (typeof mode === 'string')\n        return parseInt(mode, 8);\n    if (def)\n        return modeToNumber(def);\n    return undefined;\n}\nfunction modeToNumber(mode, def) {\n    var result = _modeToNumber(mode, def);\n    if (typeof result !== 'number' || isNaN(result))\n        throw new TypeError(ERRSTR.MODE_INT);\n    return result;\n}\nfunction isFd(path) {\n    return path >>> 0 === path;\n}\nfunction validateFd(fd) {\n    if (!isFd(fd))\n        throw TypeError(ERRSTR.FD);\n}\n// converts Date or number to a fractional UNIX timestamp\nfunction toUnixTimestamp(time) {\n    // tslint:disable-next-line triple-equals\n    if (typeof time === 'string' && +time == time) {\n        return +time;\n    }\n    if (time instanceof Date) {\n        return time.getTime() / 1000;\n    }\n    if (isFinite(time)) {\n        if (time < 0) {\n            return Date.now() / 1000;\n        }\n        return time;\n    }\n    throw new Error('Cannot parse time: ' + time);\n}\nexports.toUnixTimestamp = toUnixTimestamp;\nfunction validateUid(uid) {\n    if (typeof uid !== 'number')\n        throw TypeError(ERRSTR.UID);\n}\nfunction validateGid(gid) {\n    if (typeof gid !== 'number')\n        throw TypeError(ERRSTR.GID);\n}\nfunction flattenJSON(nestedJSON) {\n    var flatJSON = {};\n    function flatten(pathPrefix, node) {\n        for (var path in node) {\n            var contentOrNode = node[path];\n            var joinedPath = join(pathPrefix, path);\n            if (typeof contentOrNode === 'string') {\n                flatJSON[joinedPath] = contentOrNode;\n            }\n            else if (typeof contentOrNode === 'object' && contentOrNode !== null && Object.keys(contentOrNode).length > 0) {\n                // empty directories need an explicit entry and therefore get handled in `else`, non-empty ones are implicitly considered\n                flatten(joinedPath, contentOrNode);\n            }\n            else {\n                // without this branch null, empty-object or non-object entries would not be handled in the same way\n                // by both fromJSON() and fromNestedJSON()\n                flatJSON[joinedPath] = null;\n            }\n        }\n    }\n    flatten('', nestedJSON);\n    return flatJSON;\n}\n/**\n * `Volume` represents a file system.\n */\nvar Volume = /** @class */ (function () {\n    function Volume(props) {\n        if (props === void 0) { props = {}; }\n        // I-node number counter.\n        this.ino = 0;\n        // A mapping for i-node numbers to i-nodes (`Node`);\n        this.inodes = {};\n        // List of released i-node numbers, for reuse.\n        this.releasedInos = [];\n        // A mapping for file descriptors to `File`s.\n        this.fds = {};\n        // A list of reusable (opened and closed) file descriptors, that should be\n        // used first before creating a new file descriptor.\n        this.releasedFds = [];\n        // Max number of open files.\n        this.maxFiles = 10000;\n        // Current number of open files.\n        this.openFiles = 0;\n        this.promisesApi = (0, promises_1.default)(this);\n        this.statWatchers = {};\n        this.props = Object.assign({ Node: node_1.Node, Link: node_1.Link, File: node_1.File }, props);\n        var root = this.createLink();\n        root.setNode(this.createNode(true));\n        var self = this; // tslint:disable-line no-this-assignment\n        this.StatWatcher = /** @class */ (function (_super) {\n            __extends(StatWatcher, _super);\n            function StatWatcher() {\n                return _super.call(this, self) || this;\n            }\n            return StatWatcher;\n        }(StatWatcher));\n        var _ReadStream = FsReadStream;\n        this.ReadStream = /** @class */ (function (_super) {\n            __extends(class_1, _super);\n            function class_1() {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                return _super.apply(this, __spreadArray([self], args, false)) || this;\n            }\n            return class_1;\n        }(_ReadStream));\n        var _WriteStream = FsWriteStream;\n        this.WriteStream = /** @class */ (function (_super) {\n            __extends(class_2, _super);\n            function class_2() {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                return _super.apply(this, __spreadArray([self], args, false)) || this;\n            }\n            return class_2;\n        }(_WriteStream));\n        this.FSWatcher = /** @class */ (function (_super) {\n            __extends(FSWatcher, _super);\n            function FSWatcher() {\n                return _super.call(this, self) || this;\n            }\n            return FSWatcher;\n        }(FSWatcher));\n        // root.setChild('.', root);\n        // root.getNode().nlink++;\n        // root.setChild('..', root);\n        // root.getNode().nlink++;\n        this.root = root;\n    }\n    Volume.fromJSON = function (json, cwd) {\n        var vol = new Volume();\n        vol.fromJSON(json, cwd);\n        return vol;\n    };\n    Volume.fromNestedJSON = function (json, cwd) {\n        var vol = new Volume();\n        vol.fromNestedJSON(json, cwd);\n        return vol;\n    };\n    Object.defineProperty(Volume.prototype, \"promises\", {\n        get: function () {\n            if (this.promisesApi === null)\n                throw new Error('Promise is not supported in this environment.');\n            return this.promisesApi;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Volume.prototype.createLink = function (parent, name, isDirectory, perm) {\n        if (isDirectory === void 0) { isDirectory = false; }\n        if (!parent) {\n            return new this.props.Link(this, null, '');\n        }\n        if (!name) {\n            throw new Error('createLink: name cannot be empty');\n        }\n        return parent.createChild(name, this.createNode(isDirectory, perm));\n    };\n    Volume.prototype.deleteLink = function (link) {\n        var parent = link.parent;\n        if (parent) {\n            parent.deleteChild(link);\n            return true;\n        }\n        return false;\n    };\n    Volume.prototype.newInoNumber = function () {\n        var releasedFd = this.releasedInos.pop();\n        if (releasedFd)\n            return releasedFd;\n        else {\n            this.ino = (this.ino + 1) % 0xffffffff;\n            return this.ino;\n        }\n    };\n    Volume.prototype.newFdNumber = function () {\n        var releasedFd = this.releasedFds.pop();\n        return typeof releasedFd === 'number' ? releasedFd : Volume.fd--;\n    };\n    Volume.prototype.createNode = function (isDirectory, perm) {\n        if (isDirectory === void 0) { isDirectory = false; }\n        var node = new this.props.Node(this.newInoNumber(), perm);\n        if (isDirectory)\n            node.setIsDirectory();\n        this.inodes[node.ino] = node;\n        return node;\n    };\n    Volume.prototype.getNode = function (ino) {\n        return this.inodes[ino];\n    };\n    Volume.prototype.deleteNode = function (node) {\n        node.del();\n        delete this.inodes[node.ino];\n        this.releasedInos.push(node.ino);\n    };\n    // Generates 6 character long random string, used by `mkdtemp`.\n    Volume.prototype.genRndStr = function () {\n        var str = (Math.random() + 1).toString(36).substr(2, 6);\n        if (str.length === 6)\n            return str;\n        else\n            return this.genRndStr();\n    };\n    // Returns a `Link` (hard link) referenced by path \"split\" into steps.\n    Volume.prototype.getLink = function (steps) {\n        return this.root.walk(steps);\n    };\n    // Just link `getLink`, but throws a correct user error, if link to found.\n    Volume.prototype.getLinkOrThrow = function (filename, funcName) {\n        var steps = filenameToSteps(filename);\n        var link = this.getLink(steps);\n        if (!link)\n            throw createError(ENOENT, funcName, filename);\n        return link;\n    };\n    // Just like `getLink`, but also dereference/resolves symbolic links.\n    Volume.prototype.getResolvedLink = function (filenameOrSteps) {\n        var steps = typeof filenameOrSteps === 'string' ? filenameToSteps(filenameOrSteps) : filenameOrSteps;\n        var link = this.root;\n        var i = 0;\n        while (i < steps.length) {\n            var step = steps[i];\n            link = link.getChild(step);\n            if (!link)\n                return null;\n            var node = link.getNode();\n            if (node.isSymlink()) {\n                steps = node.symlink.concat(steps.slice(i + 1));\n                link = this.root;\n                i = 0;\n                continue;\n            }\n            i++;\n        }\n        return link;\n    };\n    // Just like `getLinkOrThrow`, but also dereference/resolves symbolic links.\n    Volume.prototype.getResolvedLinkOrThrow = function (filename, funcName) {\n        var link = this.getResolvedLink(filename);\n        if (!link)\n            throw createError(ENOENT, funcName, filename);\n        return link;\n    };\n    Volume.prototype.resolveSymlinks = function (link) {\n        // let node: Node = link.getNode();\n        // while(link && node.isSymlink()) {\n        //     link = this.getLink(node.symlink);\n        //     if(!link) return null;\n        //     node = link.getNode();\n        // }\n        // return link;\n        return this.getResolvedLink(link.steps.slice(1));\n    };\n    // Just like `getLinkOrThrow`, but also verifies that the link is a directory.\n    Volume.prototype.getLinkAsDirOrThrow = function (filename, funcName) {\n        var link = this.getLinkOrThrow(filename, funcName);\n        if (!link.getNode().isDirectory())\n            throw createError(ENOTDIR, funcName, filename);\n        return link;\n    };\n    // Get the immediate parent directory of the link.\n    Volume.prototype.getLinkParent = function (steps) {\n        return this.root.walk(steps, steps.length - 1);\n    };\n    Volume.prototype.getLinkParentAsDirOrThrow = function (filenameOrSteps, funcName) {\n        var steps = filenameOrSteps instanceof Array ? filenameOrSteps : filenameToSteps(filenameOrSteps);\n        var link = this.getLinkParent(steps);\n        if (!link)\n            throw createError(ENOENT, funcName, sep + steps.join(sep));\n        if (!link.getNode().isDirectory())\n            throw createError(ENOTDIR, funcName, sep + steps.join(sep));\n        return link;\n    };\n    Volume.prototype.getFileByFd = function (fd) {\n        return this.fds[String(fd)];\n    };\n    Volume.prototype.getFileByFdOrThrow = function (fd, funcName) {\n        if (!isFd(fd))\n            throw TypeError(ERRSTR.FD);\n        var file = this.getFileByFd(fd);\n        if (!file)\n            throw createError(EBADF, funcName);\n        return file;\n    };\n    /**\n     * @todo This is not used anymore. Remove.\n     */\n    /*\n    private getNodeByIdOrCreate(id: TFileId, flags: number, perm: number): Node {\n      if (typeof id === 'number') {\n        const file = this.getFileByFd(id);\n        if (!file) throw Error('File nto found');\n        return file.node;\n      } else {\n        const steps = pathToSteps(id as PathLike);\n        let link = this.getLink(steps);\n        if (link) return link.getNode();\n  \n        // Try creating a node if not found.\n        if (flags & O_CREAT) {\n          const dirLink = this.getLinkParent(steps);\n          if (dirLink) {\n            const name = steps[steps.length - 1];\n            link = this.createLink(dirLink, name, false, perm);\n            return link.getNode();\n          }\n        }\n  \n        throw createError(ENOENT, 'getNodeByIdOrCreate', pathToFilename(id));\n      }\n    }\n    */\n    Volume.prototype.wrapAsync = function (method, args, callback) {\n        var _this = this;\n        validateCallback(callback);\n        (0, setImmediate_1.default)(function () {\n            var result;\n            try {\n                result = method.apply(_this, args);\n            }\n            catch (err) {\n                callback(err);\n                return;\n            }\n            callback(null, result);\n        });\n    };\n    Volume.prototype._toJSON = function (link, json, path) {\n        var _a;\n        if (link === void 0) { link = this.root; }\n        if (json === void 0) { json = {}; }\n        var isEmpty = true;\n        var children = link.children;\n        if (link.getNode().isFile()) {\n            children = (_a = {}, _a[link.getName()] = link.parent.getChild(link.getName()), _a);\n            link = link.parent;\n        }\n        for (var name_1 in children) {\n            isEmpty = false;\n            var child = link.getChild(name_1);\n            if (!child) {\n                throw new Error('_toJSON: unexpected undefined');\n            }\n            var node = child.getNode();\n            if (node.isFile()) {\n                var filename = child.getPath();\n                if (path)\n                    filename = relative(path, filename);\n                json[filename] = node.getString();\n            }\n            else if (node.isDirectory()) {\n                this._toJSON(child, json, path);\n            }\n        }\n        var dirPath = link.getPath();\n        if (path)\n            dirPath = relative(path, dirPath);\n        if (dirPath && isEmpty) {\n            json[dirPath] = null;\n        }\n        return json;\n    };\n    Volume.prototype.toJSON = function (paths, json, isRelative) {\n        if (json === void 0) { json = {}; }\n        if (isRelative === void 0) { isRelative = false; }\n        var links = [];\n        if (paths) {\n            if (!(paths instanceof Array))\n                paths = [paths];\n            for (var _i = 0, paths_1 = paths; _i < paths_1.length; _i++) {\n                var path = paths_1[_i];\n                var filename = pathToFilename(path);\n                var link = this.getResolvedLink(filename);\n                if (!link)\n                    continue;\n                links.push(link);\n            }\n        }\n        else {\n            links.push(this.root);\n        }\n        if (!links.length)\n            return json;\n        for (var _a = 0, links_1 = links; _a < links_1.length; _a++) {\n            var link = links_1[_a];\n            this._toJSON(link, json, isRelative ? link.getPath() : '');\n        }\n        return json;\n    };\n    Volume.prototype.fromJSON = function (json, cwd) {\n        if (cwd === void 0) { cwd = process_1.default.cwd(); }\n        for (var filename in json) {\n            var data = json[filename];\n            filename = resolve(filename, cwd);\n            if (typeof data === 'string') {\n                var dir = dirname(filename);\n                this.mkdirpBase(dir, 511 /* MODE.DIR */);\n                this.writeFileSync(filename, data);\n            }\n            else {\n                this.mkdirpBase(filename, 511 /* MODE.DIR */);\n            }\n        }\n    };\n    Volume.prototype.fromNestedJSON = function (json, cwd) {\n        this.fromJSON(flattenJSON(json), cwd);\n    };\n    Volume.prototype.reset = function () {\n        this.ino = 0;\n        this.inodes = {};\n        this.releasedInos = [];\n        this.fds = {};\n        this.releasedFds = [];\n        this.openFiles = 0;\n        this.root = this.createLink();\n        this.root.setNode(this.createNode(true));\n    };\n    // Legacy interface\n    Volume.prototype.mountSync = function (mountpoint, json) {\n        this.fromJSON(json, mountpoint);\n    };\n    Volume.prototype.openLink = function (link, flagsNum, resolveSymlinks) {\n        if (resolveSymlinks === void 0) { resolveSymlinks = true; }\n        if (this.openFiles >= this.maxFiles) {\n            // Too many open files.\n            throw createError(EMFILE, 'open', link.getPath());\n        }\n        // Resolve symlinks.\n        var realLink = link;\n        if (resolveSymlinks)\n            realLink = this.resolveSymlinks(link);\n        if (!realLink)\n            throw createError(ENOENT, 'open', link.getPath());\n        var node = realLink.getNode();\n        // Check whether node is a directory\n        if (node.isDirectory()) {\n            if ((flagsNum & (O_RDONLY | O_RDWR | O_WRONLY)) !== O_RDONLY)\n                throw createError(EISDIR, 'open', link.getPath());\n        }\n        else {\n            if (flagsNum & O_DIRECTORY)\n                throw createError(ENOTDIR, 'open', link.getPath());\n        }\n        // Check node permissions\n        if (!(flagsNum & O_WRONLY)) {\n            if (!node.canRead()) {\n                throw createError(EACCES, 'open', link.getPath());\n            }\n        }\n        if (flagsNum & O_RDWR) {\n        }\n        var file = new this.props.File(link, node, flagsNum, this.newFdNumber());\n        this.fds[file.fd] = file;\n        this.openFiles++;\n        if (flagsNum & O_TRUNC)\n            file.truncate();\n        return file;\n    };\n    Volume.prototype.openFile = function (filename, flagsNum, modeNum, resolveSymlinks) {\n        if (resolveSymlinks === void 0) { resolveSymlinks = true; }\n        var steps = filenameToSteps(filename);\n        var link = resolveSymlinks ? this.getResolvedLink(steps) : this.getLink(steps);\n        if (link && flagsNum & O_EXCL)\n            throw createError(EEXIST, 'open', filename);\n        // Try creating a new file, if it does not exist.\n        if (!link && flagsNum & O_CREAT) {\n            // const dirLink: Link = this.getLinkParent(steps);\n            var dirLink = this.getResolvedLink(steps.slice(0, steps.length - 1));\n            // if(!dirLink) throw createError(ENOENT, 'open', filename);\n            if (!dirLink)\n                throw createError(ENOENT, 'open', sep + steps.join(sep));\n            if (flagsNum & O_CREAT && typeof modeNum === 'number') {\n                link = this.createLink(dirLink, steps[steps.length - 1], false, modeNum);\n            }\n        }\n        if (link)\n            return this.openLink(link, flagsNum, resolveSymlinks);\n        throw createError(ENOENT, 'open', filename);\n    };\n    Volume.prototype.openBase = function (filename, flagsNum, modeNum, resolveSymlinks) {\n        if (resolveSymlinks === void 0) { resolveSymlinks = true; }\n        var file = this.openFile(filename, flagsNum, modeNum, resolveSymlinks);\n        if (!file)\n            throw createError(ENOENT, 'open', filename);\n        return file.fd;\n    };\n    Volume.prototype.openSync = function (path, flags, mode) {\n        if (mode === void 0) { mode = 438 /* MODE.DEFAULT */; }\n        // Validate (1) mode; (2) path; (3) flags - in that order.\n        var modeNum = modeToNumber(mode);\n        var fileName = pathToFilename(path);\n        var flagsNum = flagsToNumber(flags);\n        return this.openBase(fileName, flagsNum, modeNum);\n    };\n    Volume.prototype.open = function (path, flags, a, b) {\n        var mode = a;\n        var callback = b;\n        if (typeof a === 'function') {\n            mode = 438 /* MODE.DEFAULT */;\n            callback = a;\n        }\n        mode = mode || 438 /* MODE.DEFAULT */;\n        var modeNum = modeToNumber(mode);\n        var fileName = pathToFilename(path);\n        var flagsNum = flagsToNumber(flags);\n        this.wrapAsync(this.openBase, [fileName, flagsNum, modeNum], callback);\n    };\n    Volume.prototype.closeFile = function (file) {\n        if (!this.fds[file.fd])\n            return;\n        this.openFiles--;\n        delete this.fds[file.fd];\n        this.releasedFds.push(file.fd);\n    };\n    Volume.prototype.closeSync = function (fd) {\n        validateFd(fd);\n        var file = this.getFileByFdOrThrow(fd, 'close');\n        this.closeFile(file);\n    };\n    Volume.prototype.close = function (fd, callback) {\n        validateFd(fd);\n        this.wrapAsync(this.closeSync, [fd], callback);\n    };\n    Volume.prototype.openFileOrGetById = function (id, flagsNum, modeNum) {\n        if (typeof id === 'number') {\n            var file = this.fds[id];\n            if (!file)\n                throw createError(ENOENT);\n            return file;\n        }\n        else {\n            return this.openFile(pathToFilename(id), flagsNum, modeNum);\n        }\n    };\n    Volume.prototype.readBase = function (fd, buffer, offset, length, position) {\n        var file = this.getFileByFdOrThrow(fd);\n        return file.read(buffer, Number(offset), Number(length), position);\n    };\n    Volume.prototype.readSync = function (fd, buffer, offset, length, position) {\n        validateFd(fd);\n        return this.readBase(fd, buffer, offset, length, position);\n    };\n    Volume.prototype.read = function (fd, buffer, offset, length, position, callback) {\n        var _this = this;\n        validateCallback(callback);\n        // This `if` branch is from Node.js\n        if (length === 0) {\n            return process_1.default.nextTick(function () {\n                if (callback)\n                    callback(null, 0, buffer);\n            });\n        }\n        (0, setImmediate_1.default)(function () {\n            try {\n                var bytes = _this.readBase(fd, buffer, offset, length, position);\n                callback(null, bytes, buffer);\n            }\n            catch (err) {\n                callback(err);\n            }\n        });\n    };\n    Volume.prototype.readFileBase = function (id, flagsNum, encoding) {\n        var result;\n        var isUserFd = typeof id === 'number';\n        var userOwnsFd = isUserFd && isFd(id);\n        var fd;\n        if (userOwnsFd)\n            fd = id;\n        else {\n            var filename = pathToFilename(id);\n            var steps = filenameToSteps(filename);\n            var link = this.getResolvedLink(steps);\n            if (link) {\n                var node = link.getNode();\n                if (node.isDirectory())\n                    throw createError(EISDIR, 'open', link.getPath());\n            }\n            fd = this.openSync(id, flagsNum);\n        }\n        try {\n            result = bufferToEncoding(this.getFileByFdOrThrow(fd).getBuffer(), encoding);\n        }\n        finally {\n            if (!userOwnsFd) {\n                this.closeSync(fd);\n            }\n        }\n        return result;\n    };\n    Volume.prototype.readFileSync = function (file, options) {\n        var opts = getReadFileOptions(options);\n        var flagsNum = flagsToNumber(opts.flag);\n        return this.readFileBase(file, flagsNum, opts.encoding);\n    };\n    Volume.prototype.readFile = function (id, a, b) {\n        var _a = optsAndCbGenerator(getReadFileOptions)(a, b), opts = _a[0], callback = _a[1];\n        var flagsNum = flagsToNumber(opts.flag);\n        this.wrapAsync(this.readFileBase, [id, flagsNum, opts.encoding], callback);\n    };\n    Volume.prototype.writeBase = function (fd, buf, offset, length, position) {\n        var file = this.getFileByFdOrThrow(fd, 'write');\n        return file.write(buf, offset, length, position);\n    };\n    Volume.prototype.writeSync = function (fd, a, b, c, d) {\n        validateFd(fd);\n        var encoding;\n        var offset;\n        var length;\n        var position;\n        var isBuffer = typeof a !== 'string';\n        if (isBuffer) {\n            offset = (b || 0) | 0;\n            length = c;\n            position = d;\n        }\n        else {\n            position = b;\n            encoding = c;\n        }\n        var buf = dataToBuffer(a, encoding);\n        if (isBuffer) {\n            if (typeof length === 'undefined') {\n                length = buf.length;\n            }\n        }\n        else {\n            offset = 0;\n            length = buf.length;\n        }\n        return this.writeBase(fd, buf, offset, length, position);\n    };\n    Volume.prototype.write = function (fd, a, b, c, d, e) {\n        var _this = this;\n        validateFd(fd);\n        var offset;\n        var length;\n        var position;\n        var encoding;\n        var callback;\n        var tipa = typeof a;\n        var tipb = typeof b;\n        var tipc = typeof c;\n        var tipd = typeof d;\n        if (tipa !== 'string') {\n            if (tipb === 'function') {\n                callback = b;\n            }\n            else if (tipc === 'function') {\n                offset = b | 0;\n                callback = c;\n            }\n            else if (tipd === 'function') {\n                offset = b | 0;\n                length = c;\n                callback = d;\n            }\n            else {\n                offset = b | 0;\n                length = c;\n                position = d;\n                callback = e;\n            }\n        }\n        else {\n            if (tipb === 'function') {\n                callback = b;\n            }\n            else if (tipc === 'function') {\n                position = b;\n                callback = c;\n            }\n            else if (tipd === 'function') {\n                position = b;\n                encoding = c;\n                callback = d;\n            }\n        }\n        var buf = dataToBuffer(a, encoding);\n        if (tipa !== 'string') {\n            if (typeof length === 'undefined')\n                length = buf.length;\n        }\n        else {\n            offset = 0;\n            length = buf.length;\n        }\n        var cb = validateCallback(callback);\n        (0, setImmediate_1.default)(function () {\n            try {\n                var bytes = _this.writeBase(fd, buf, offset, length, position);\n                if (tipa !== 'string') {\n                    cb(null, bytes, buf);\n                }\n                else {\n                    cb(null, bytes, a);\n                }\n            }\n            catch (err) {\n                cb(err);\n            }\n        });\n    };\n    Volume.prototype.writeFileBase = function (id, buf, flagsNum, modeNum) {\n        // console.log('writeFileBase', id, buf, flagsNum, modeNum);\n        // const node = this.getNodeByIdOrCreate(id, flagsNum, modeNum);\n        // node.setBuffer(buf);\n        var isUserFd = typeof id === 'number';\n        var fd;\n        if (isUserFd)\n            fd = id;\n        else {\n            fd = this.openBase(pathToFilename(id), flagsNum, modeNum);\n            // fd = this.openSync(id as PathLike, flagsNum, modeNum);\n        }\n        var offset = 0;\n        var length = buf.length;\n        var position = flagsNum & O_APPEND ? undefined : 0;\n        try {\n            while (length > 0) {\n                var written = this.writeSync(fd, buf, offset, length, position);\n                offset += written;\n                length -= written;\n                if (position !== undefined)\n                    position += written;\n            }\n        }\n        finally {\n            if (!isUserFd)\n                this.closeSync(fd);\n        }\n    };\n    Volume.prototype.writeFileSync = function (id, data, options) {\n        var opts = getWriteFileOptions(options);\n        var flagsNum = flagsToNumber(opts.flag);\n        var modeNum = modeToNumber(opts.mode);\n        var buf = dataToBuffer(data, opts.encoding);\n        this.writeFileBase(id, buf, flagsNum, modeNum);\n    };\n    Volume.prototype.writeFile = function (id, data, a, b) {\n        var options = a;\n        var callback = b;\n        if (typeof a === 'function') {\n            options = writeFileDefaults;\n            callback = a;\n        }\n        var cb = validateCallback(callback);\n        var opts = getWriteFileOptions(options);\n        var flagsNum = flagsToNumber(opts.flag);\n        var modeNum = modeToNumber(opts.mode);\n        var buf = dataToBuffer(data, opts.encoding);\n        this.wrapAsync(this.writeFileBase, [id, buf, flagsNum, modeNum], cb);\n    };\n    Volume.prototype.linkBase = function (filename1, filename2) {\n        var steps1 = filenameToSteps(filename1);\n        var link1 = this.getLink(steps1);\n        if (!link1)\n            throw createError(ENOENT, 'link', filename1, filename2);\n        var steps2 = filenameToSteps(filename2);\n        // Check new link directory exists.\n        var dir2 = this.getLinkParent(steps2);\n        if (!dir2)\n            throw createError(ENOENT, 'link', filename1, filename2);\n        var name = steps2[steps2.length - 1];\n        // Check if new file already exists.\n        if (dir2.getChild(name))\n            throw createError(EEXIST, 'link', filename1, filename2);\n        var node = link1.getNode();\n        node.nlink++;\n        dir2.createChild(name, node);\n    };\n    Volume.prototype.copyFileBase = function (src, dest, flags) {\n        var buf = this.readFileSync(src);\n        if (flags & COPYFILE_EXCL) {\n            if (this.existsSync(dest)) {\n                throw createError(EEXIST, 'copyFile', src, dest);\n            }\n        }\n        if (flags & COPYFILE_FICLONE_FORCE) {\n            throw createError(ENOSYS, 'copyFile', src, dest);\n        }\n        this.writeFileBase(dest, buf, FLAGS.w, 438 /* MODE.DEFAULT */);\n    };\n    Volume.prototype.copyFileSync = function (src, dest, flags) {\n        var srcFilename = pathToFilename(src);\n        var destFilename = pathToFilename(dest);\n        return this.copyFileBase(srcFilename, destFilename, (flags || 0) | 0);\n    };\n    Volume.prototype.copyFile = function (src, dest, a, b) {\n        var srcFilename = pathToFilename(src);\n        var destFilename = pathToFilename(dest);\n        var flags;\n        var callback;\n        if (typeof a === 'function') {\n            flags = 0;\n            callback = a;\n        }\n        else {\n            flags = a;\n            callback = b;\n        }\n        validateCallback(callback);\n        this.wrapAsync(this.copyFileBase, [srcFilename, destFilename, flags], callback);\n    };\n    Volume.prototype.linkSync = function (existingPath, newPath) {\n        var existingPathFilename = pathToFilename(existingPath);\n        var newPathFilename = pathToFilename(newPath);\n        this.linkBase(existingPathFilename, newPathFilename);\n    };\n    Volume.prototype.link = function (existingPath, newPath, callback) {\n        var existingPathFilename = pathToFilename(existingPath);\n        var newPathFilename = pathToFilename(newPath);\n        this.wrapAsync(this.linkBase, [existingPathFilename, newPathFilename], callback);\n    };\n    Volume.prototype.unlinkBase = function (filename) {\n        var steps = filenameToSteps(filename);\n        var link = this.getLink(steps);\n        if (!link)\n            throw createError(ENOENT, 'unlink', filename);\n        // TODO: Check if it is file, dir, other...\n        if (link.length)\n            throw Error('Dir not empty...');\n        this.deleteLink(link);\n        var node = link.getNode();\n        node.nlink--;\n        // When all hard links to i-node are deleted, remove the i-node, too.\n        if (node.nlink <= 0) {\n            this.deleteNode(node);\n        }\n    };\n    Volume.prototype.unlinkSync = function (path) {\n        var filename = pathToFilename(path);\n        this.unlinkBase(filename);\n    };\n    Volume.prototype.unlink = function (path, callback) {\n        var filename = pathToFilename(path);\n        this.wrapAsync(this.unlinkBase, [filename], callback);\n    };\n    Volume.prototype.symlinkBase = function (targetFilename, pathFilename) {\n        var pathSteps = filenameToSteps(pathFilename);\n        // Check if directory exists, where we about to create a symlink.\n        var dirLink = this.getLinkParent(pathSteps);\n        if (!dirLink)\n            throw createError(ENOENT, 'symlink', targetFilename, pathFilename);\n        var name = pathSteps[pathSteps.length - 1];\n        // Check if new file already exists.\n        if (dirLink.getChild(name))\n            throw createError(EEXIST, 'symlink', targetFilename, pathFilename);\n        // Create symlink.\n        var symlink = dirLink.createChild(name);\n        symlink.getNode().makeSymlink(filenameToSteps(targetFilename));\n        return symlink;\n    };\n    // `type` argument works only on Windows.\n    Volume.prototype.symlinkSync = function (target, path, type) {\n        var targetFilename = pathToFilename(target);\n        var pathFilename = pathToFilename(path);\n        this.symlinkBase(targetFilename, pathFilename);\n    };\n    Volume.prototype.symlink = function (target, path, a, b) {\n        var callback = validateCallback(typeof a === 'function' ? a : b);\n        var targetFilename = pathToFilename(target);\n        var pathFilename = pathToFilename(path);\n        this.wrapAsync(this.symlinkBase, [targetFilename, pathFilename], callback);\n    };\n    Volume.prototype.realpathBase = function (filename, encoding) {\n        var steps = filenameToSteps(filename);\n        var realLink = this.getResolvedLink(steps);\n        if (!realLink)\n            throw createError(ENOENT, 'realpath', filename);\n        return (0, encoding_1.strToEncoding)(realLink.getPath(), encoding);\n    };\n    Volume.prototype.realpathSync = function (path, options) {\n        return this.realpathBase(pathToFilename(path), getRealpathOptions(options).encoding);\n    };\n    Volume.prototype.realpath = function (path, a, b) {\n        var _a = getRealpathOptsAndCb(a, b), opts = _a[0], callback = _a[1];\n        var pathFilename = pathToFilename(path);\n        this.wrapAsync(this.realpathBase, [pathFilename, opts.encoding], callback);\n    };\n    Volume.prototype.lstatBase = function (filename, bigint, throwIfNoEntry) {\n        if (bigint === void 0) { bigint = false; }\n        if (throwIfNoEntry === void 0) { throwIfNoEntry = false; }\n        var link = this.getLink(filenameToSteps(filename));\n        if (link) {\n            return Stats_1.default.build(link.getNode(), bigint);\n        }\n        else if (!throwIfNoEntry) {\n            return undefined;\n        }\n        else {\n            throw createError(ENOENT, 'lstat', filename);\n        }\n    };\n    Volume.prototype.lstatSync = function (path, options) {\n        var _a = getStatOptions(options), _b = _a.throwIfNoEntry, throwIfNoEntry = _b === void 0 ? true : _b, _c = _a.bigint, bigint = _c === void 0 ? false : _c;\n        return this.lstatBase(pathToFilename(path), bigint, throwIfNoEntry);\n    };\n    Volume.prototype.lstat = function (path, a, b) {\n        var _a = getStatOptsAndCb(a, b), _b = _a[0], _c = _b.throwIfNoEntry, throwIfNoEntry = _c === void 0 ? true : _c, _d = _b.bigint, bigint = _d === void 0 ? false : _d, callback = _a[1];\n        this.wrapAsync(this.lstatBase, [pathToFilename(path), bigint, throwIfNoEntry], callback);\n    };\n    Volume.prototype.statBase = function (filename, bigint, throwIfNoEntry) {\n        if (bigint === void 0) { bigint = false; }\n        if (throwIfNoEntry === void 0) { throwIfNoEntry = true; }\n        var link = this.getResolvedLink(filenameToSteps(filename));\n        if (link) {\n            return Stats_1.default.build(link.getNode(), bigint);\n        }\n        else if (!throwIfNoEntry) {\n            return undefined;\n        }\n        else {\n            throw createError(ENOENT, 'stat', filename);\n        }\n    };\n    Volume.prototype.statSync = function (path, options) {\n        var _a = getStatOptions(options), _b = _a.bigint, bigint = _b === void 0 ? true : _b, _c = _a.throwIfNoEntry, throwIfNoEntry = _c === void 0 ? true : _c;\n        return this.statBase(pathToFilename(path), bigint, throwIfNoEntry);\n    };\n    Volume.prototype.stat = function (path, a, b) {\n        var _a = getStatOptsAndCb(a, b), _b = _a[0], _c = _b.bigint, bigint = _c === void 0 ? false : _c, _d = _b.throwIfNoEntry, throwIfNoEntry = _d === void 0 ? true : _d, callback = _a[1];\n        this.wrapAsync(this.statBase, [pathToFilename(path), bigint, throwIfNoEntry], callback);\n    };\n    Volume.prototype.fstatBase = function (fd, bigint) {\n        if (bigint === void 0) { bigint = false; }\n        var file = this.getFileByFd(fd);\n        if (!file)\n            throw createError(EBADF, 'fstat');\n        return Stats_1.default.build(file.node, bigint);\n    };\n    Volume.prototype.fstatSync = function (fd, options) {\n        return this.fstatBase(fd, getStatOptions(options).bigint);\n    };\n    Volume.prototype.fstat = function (fd, a, b) {\n        var _a = getStatOptsAndCb(a, b), opts = _a[0], callback = _a[1];\n        this.wrapAsync(this.fstatBase, [fd, opts.bigint], callback);\n    };\n    Volume.prototype.renameBase = function (oldPathFilename, newPathFilename) {\n        var link = this.getLink(filenameToSteps(oldPathFilename));\n        if (!link)\n            throw createError(ENOENT, 'rename', oldPathFilename, newPathFilename);\n        // TODO: Check if it is directory, if non-empty, we cannot move it, right?\n        var newPathSteps = filenameToSteps(newPathFilename);\n        // Check directory exists for the new location.\n        var newPathDirLink = this.getLinkParent(newPathSteps);\n        if (!newPathDirLink)\n            throw createError(ENOENT, 'rename', oldPathFilename, newPathFilename);\n        // TODO: Also treat cases with directories and symbolic links.\n        // TODO: See: http://man7.org/linux/man-pages/man2/rename.2.html\n        // Remove hard link from old folder.\n        var oldLinkParent = link.parent;\n        if (oldLinkParent) {\n            oldLinkParent.deleteChild(link);\n        }\n        // Rename should overwrite the new path, if that exists.\n        var name = newPathSteps[newPathSteps.length - 1];\n        link.name = name;\n        link.steps = __spreadArray(__spreadArray([], newPathDirLink.steps, true), [name], false);\n        newPathDirLink.setChild(link.getName(), link);\n    };\n    Volume.prototype.renameSync = function (oldPath, newPath) {\n        var oldPathFilename = pathToFilename(oldPath);\n        var newPathFilename = pathToFilename(newPath);\n        this.renameBase(oldPathFilename, newPathFilename);\n    };\n    Volume.prototype.rename = function (oldPath, newPath, callback) {\n        var oldPathFilename = pathToFilename(oldPath);\n        var newPathFilename = pathToFilename(newPath);\n        this.wrapAsync(this.renameBase, [oldPathFilename, newPathFilename], callback);\n    };\n    Volume.prototype.existsBase = function (filename) {\n        return !!this.statBase(filename);\n    };\n    Volume.prototype.existsSync = function (path) {\n        try {\n            return this.existsBase(pathToFilename(path));\n        }\n        catch (err) {\n            return false;\n        }\n    };\n    Volume.prototype.exists = function (path, callback) {\n        var _this = this;\n        var filename = pathToFilename(path);\n        if (typeof callback !== 'function')\n            throw Error(ERRSTR.CB);\n        (0, setImmediate_1.default)(function () {\n            try {\n                callback(_this.existsBase(filename));\n            }\n            catch (err) {\n                callback(false);\n            }\n        });\n    };\n    Volume.prototype.accessBase = function (filename, mode) {\n        var link = this.getLinkOrThrow(filename, 'access');\n        // TODO: Verify permissions\n    };\n    Volume.prototype.accessSync = function (path, mode) {\n        if (mode === void 0) { mode = F_OK; }\n        var filename = pathToFilename(path);\n        mode = mode | 0;\n        this.accessBase(filename, mode);\n    };\n    Volume.prototype.access = function (path, a, b) {\n        var mode = F_OK;\n        var callback;\n        if (typeof a !== 'function') {\n            mode = a | 0; // cast to number\n            callback = validateCallback(b);\n        }\n        else {\n            callback = a;\n        }\n        var filename = pathToFilename(path);\n        this.wrapAsync(this.accessBase, [filename, mode], callback);\n    };\n    Volume.prototype.appendFileSync = function (id, data, options) {\n        if (options === void 0) { options = appendFileDefaults; }\n        var opts = getAppendFileOpts(options);\n        // force append behavior when using a supplied file descriptor\n        if (!opts.flag || isFd(id))\n            opts.flag = 'a';\n        this.writeFileSync(id, data, opts);\n    };\n    Volume.prototype.appendFile = function (id, data, a, b) {\n        var _a = getAppendFileOptsAndCb(a, b), opts = _a[0], callback = _a[1];\n        // force append behavior when using a supplied file descriptor\n        if (!opts.flag || isFd(id))\n            opts.flag = 'a';\n        this.writeFile(id, data, opts, callback);\n    };\n    Volume.prototype.readdirBase = function (filename, options) {\n        var steps = filenameToSteps(filename);\n        var link = this.getResolvedLink(steps);\n        if (!link)\n            throw createError(ENOENT, 'readdir', filename);\n        var node = link.getNode();\n        if (!node.isDirectory())\n            throw createError(ENOTDIR, 'scandir', filename);\n        if (options.withFileTypes) {\n            var list_1 = [];\n            for (var name_2 in link.children) {\n                var child = link.getChild(name_2);\n                if (!child) {\n                    continue;\n                }\n                list_1.push(Dirent_1.default.build(child, options.encoding));\n            }\n            if (!isWin && options.encoding !== 'buffer')\n                list_1.sort(function (a, b) {\n                    if (a.name < b.name)\n                        return -1;\n                    if (a.name > b.name)\n                        return 1;\n                    return 0;\n                });\n            return list_1;\n        }\n        var list = [];\n        for (var name_3 in link.children) {\n            list.push((0, encoding_1.strToEncoding)(name_3, options.encoding));\n        }\n        if (!isWin && options.encoding !== 'buffer')\n            list.sort();\n        return list;\n    };\n    Volume.prototype.readdirSync = function (path, options) {\n        var opts = getReaddirOptions(options);\n        var filename = pathToFilename(path);\n        return this.readdirBase(filename, opts);\n    };\n    Volume.prototype.readdir = function (path, a, b) {\n        var _a = getReaddirOptsAndCb(a, b), options = _a[0], callback = _a[1];\n        var filename = pathToFilename(path);\n        this.wrapAsync(this.readdirBase, [filename, options], callback);\n    };\n    Volume.prototype.readlinkBase = function (filename, encoding) {\n        var link = this.getLinkOrThrow(filename, 'readlink');\n        var node = link.getNode();\n        if (!node.isSymlink())\n            throw createError(EINVAL, 'readlink', filename);\n        var str = sep + node.symlink.join(sep);\n        return (0, encoding_1.strToEncoding)(str, encoding);\n    };\n    Volume.prototype.readlinkSync = function (path, options) {\n        var opts = getDefaultOpts(options);\n        var filename = pathToFilename(path);\n        return this.readlinkBase(filename, opts.encoding);\n    };\n    Volume.prototype.readlink = function (path, a, b) {\n        var _a = getDefaultOptsAndCb(a, b), opts = _a[0], callback = _a[1];\n        var filename = pathToFilename(path);\n        this.wrapAsync(this.readlinkBase, [filename, opts.encoding], callback);\n    };\n    Volume.prototype.fsyncBase = function (fd) {\n        this.getFileByFdOrThrow(fd, 'fsync');\n    };\n    Volume.prototype.fsyncSync = function (fd) {\n        this.fsyncBase(fd);\n    };\n    Volume.prototype.fsync = function (fd, callback) {\n        this.wrapAsync(this.fsyncBase, [fd], callback);\n    };\n    Volume.prototype.fdatasyncBase = function (fd) {\n        this.getFileByFdOrThrow(fd, 'fdatasync');\n    };\n    Volume.prototype.fdatasyncSync = function (fd) {\n        this.fdatasyncBase(fd);\n    };\n    Volume.prototype.fdatasync = function (fd, callback) {\n        this.wrapAsync(this.fdatasyncBase, [fd], callback);\n    };\n    Volume.prototype.ftruncateBase = function (fd, len) {\n        var file = this.getFileByFdOrThrow(fd, 'ftruncate');\n        file.truncate(len);\n    };\n    Volume.prototype.ftruncateSync = function (fd, len) {\n        this.ftruncateBase(fd, len);\n    };\n    Volume.prototype.ftruncate = function (fd, a, b) {\n        var len = typeof a === 'number' ? a : 0;\n        var callback = validateCallback(typeof a === 'number' ? b : a);\n        this.wrapAsync(this.ftruncateBase, [fd, len], callback);\n    };\n    Volume.prototype.truncateBase = function (path, len) {\n        var fd = this.openSync(path, 'r+');\n        try {\n            this.ftruncateSync(fd, len);\n        }\n        finally {\n            this.closeSync(fd);\n        }\n    };\n    Volume.prototype.truncateSync = function (id, len) {\n        if (isFd(id))\n            return this.ftruncateSync(id, len);\n        this.truncateBase(id, len);\n    };\n    Volume.prototype.truncate = function (id, a, b) {\n        var len = typeof a === 'number' ? a : 0;\n        var callback = validateCallback(typeof a === 'number' ? b : a);\n        if (isFd(id))\n            return this.ftruncate(id, len, callback);\n        this.wrapAsync(this.truncateBase, [id, len], callback);\n    };\n    Volume.prototype.futimesBase = function (fd, atime, mtime) {\n        var file = this.getFileByFdOrThrow(fd, 'futimes');\n        var node = file.node;\n        node.atime = new Date(atime * 1000);\n        node.mtime = new Date(mtime * 1000);\n    };\n    Volume.prototype.futimesSync = function (fd, atime, mtime) {\n        this.futimesBase(fd, toUnixTimestamp(atime), toUnixTimestamp(mtime));\n    };\n    Volume.prototype.futimes = function (fd, atime, mtime, callback) {\n        this.wrapAsync(this.futimesBase, [fd, toUnixTimestamp(atime), toUnixTimestamp(mtime)], callback);\n    };\n    Volume.prototype.utimesBase = function (filename, atime, mtime) {\n        var fd = this.openSync(filename, 'r+');\n        try {\n            this.futimesBase(fd, atime, mtime);\n        }\n        finally {\n            this.closeSync(fd);\n        }\n    };\n    Volume.prototype.utimesSync = function (path, atime, mtime) {\n        this.utimesBase(pathToFilename(path), toUnixTimestamp(atime), toUnixTimestamp(mtime));\n    };\n    Volume.prototype.utimes = function (path, atime, mtime, callback) {\n        this.wrapAsync(this.utimesBase, [pathToFilename(path), toUnixTimestamp(atime), toUnixTimestamp(mtime)], callback);\n    };\n    Volume.prototype.mkdirBase = function (filename, modeNum) {\n        var steps = filenameToSteps(filename);\n        // This will throw if user tries to create root dir `fs.mkdirSync('/')`.\n        if (!steps.length) {\n            throw createError(EEXIST, 'mkdir', filename);\n        }\n        var dir = this.getLinkParentAsDirOrThrow(filename, 'mkdir');\n        // Check path already exists.\n        var name = steps[steps.length - 1];\n        if (dir.getChild(name))\n            throw createError(EEXIST, 'mkdir', filename);\n        dir.createChild(name, this.createNode(true, modeNum));\n    };\n    /**\n     * Creates directory tree recursively.\n     * @param filename\n     * @param modeNum\n     */\n    Volume.prototype.mkdirpBase = function (filename, modeNum) {\n        var steps = filenameToSteps(filename);\n        var link = this.root;\n        for (var i = 0; i < steps.length; i++) {\n            var step = steps[i];\n            if (!link.getNode().isDirectory())\n                throw createError(ENOTDIR, 'mkdir', link.getPath());\n            var child = link.getChild(step);\n            if (child) {\n                if (child.getNode().isDirectory())\n                    link = child;\n                else\n                    throw createError(ENOTDIR, 'mkdir', child.getPath());\n            }\n            else {\n                link = link.createChild(step, this.createNode(true, modeNum));\n            }\n        }\n    };\n    Volume.prototype.mkdirSync = function (path, options) {\n        var opts = getMkdirOptions(options);\n        var modeNum = modeToNumber(opts.mode, 511);\n        var filename = pathToFilename(path);\n        if (opts.recursive)\n            this.mkdirpBase(filename, modeNum);\n        else\n            this.mkdirBase(filename, modeNum);\n    };\n    Volume.prototype.mkdir = function (path, a, b) {\n        var opts = getMkdirOptions(a);\n        var callback = validateCallback(typeof a === 'function' ? a : b);\n        var modeNum = modeToNumber(opts.mode, 511);\n        var filename = pathToFilename(path);\n        if (opts.recursive)\n            this.wrapAsync(this.mkdirpBase, [filename, modeNum], callback);\n        else\n            this.wrapAsync(this.mkdirBase, [filename, modeNum], callback);\n    };\n    // legacy interface\n    Volume.prototype.mkdirpSync = function (path, mode) {\n        this.mkdirSync(path, { mode: mode, recursive: true });\n    };\n    Volume.prototype.mkdirp = function (path, a, b) {\n        var mode = typeof a === 'function' ? undefined : a;\n        var callback = validateCallback(typeof a === 'function' ? a : b);\n        this.mkdir(path, { mode: mode, recursive: true }, callback);\n    };\n    Volume.prototype.mkdtempBase = function (prefix, encoding, retry) {\n        if (retry === void 0) { retry = 5; }\n        var filename = prefix + this.genRndStr();\n        try {\n            this.mkdirBase(filename, 511 /* MODE.DIR */);\n            return (0, encoding_1.strToEncoding)(filename, encoding);\n        }\n        catch (err) {\n            if (err.code === EEXIST) {\n                if (retry > 1)\n                    return this.mkdtempBase(prefix, encoding, retry - 1);\n                else\n                    throw Error('Could not create temp dir.');\n            }\n            else\n                throw err;\n        }\n    };\n    Volume.prototype.mkdtempSync = function (prefix, options) {\n        var encoding = getDefaultOpts(options).encoding;\n        if (!prefix || typeof prefix !== 'string')\n            throw new TypeError('filename prefix is required');\n        nullCheck(prefix);\n        return this.mkdtempBase(prefix, encoding);\n    };\n    Volume.prototype.mkdtemp = function (prefix, a, b) {\n        var _a = getDefaultOptsAndCb(a, b), encoding = _a[0].encoding, callback = _a[1];\n        if (!prefix || typeof prefix !== 'string')\n            throw new TypeError('filename prefix is required');\n        if (!nullCheck(prefix))\n            return;\n        this.wrapAsync(this.mkdtempBase, [prefix, encoding], callback);\n    };\n    Volume.prototype.rmdirBase = function (filename, options) {\n        var opts = getRmdirOptions(options);\n        var link = this.getLinkAsDirOrThrow(filename, 'rmdir');\n        // Check directory is empty.\n        if (link.length && !opts.recursive)\n            throw createError(ENOTEMPTY, 'rmdir', filename);\n        this.deleteLink(link);\n    };\n    Volume.prototype.rmdirSync = function (path, options) {\n        this.rmdirBase(pathToFilename(path), options);\n    };\n    Volume.prototype.rmdir = function (path, a, b) {\n        var opts = getRmdirOptions(a);\n        var callback = validateCallback(typeof a === 'function' ? a : b);\n        this.wrapAsync(this.rmdirBase, [pathToFilename(path), opts], callback);\n    };\n    Volume.prototype.rmBase = function (filename, options) {\n        if (options === void 0) { options = {}; }\n        var link = this.getResolvedLink(filename);\n        if (!link) {\n            // \"stat\" is used to match Node's native error message.\n            if (!options.force)\n                throw createError(ENOENT, 'stat', filename);\n            return;\n        }\n        if (link.getNode().isDirectory()) {\n            if (!options.recursive) {\n                throw createError(ERR_FS_EISDIR, 'rm', filename);\n            }\n        }\n        this.deleteLink(link);\n    };\n    Volume.prototype.rmSync = function (path, options) {\n        this.rmBase(pathToFilename(path), options);\n    };\n    Volume.prototype.rm = function (path, a, b) {\n        var _a = getRmOptsAndCb(a, b), opts = _a[0], callback = _a[1];\n        this.wrapAsync(this.rmBase, [pathToFilename(path), opts], callback);\n    };\n    Volume.prototype.fchmodBase = function (fd, modeNum) {\n        var file = this.getFileByFdOrThrow(fd, 'fchmod');\n        file.chmod(modeNum);\n    };\n    Volume.prototype.fchmodSync = function (fd, mode) {\n        this.fchmodBase(fd, modeToNumber(mode));\n    };\n    Volume.prototype.fchmod = function (fd, mode, callback) {\n        this.wrapAsync(this.fchmodBase, [fd, modeToNumber(mode)], callback);\n    };\n    Volume.prototype.chmodBase = function (filename, modeNum) {\n        var fd = this.openSync(filename, 'r+');\n        try {\n            this.fchmodBase(fd, modeNum);\n        }\n        finally {\n            this.closeSync(fd);\n        }\n    };\n    Volume.prototype.chmodSync = function (path, mode) {\n        var modeNum = modeToNumber(mode);\n        var filename = pathToFilename(path);\n        this.chmodBase(filename, modeNum);\n    };\n    Volume.prototype.chmod = function (path, mode, callback) {\n        var modeNum = modeToNumber(mode);\n        var filename = pathToFilename(path);\n        this.wrapAsync(this.chmodBase, [filename, modeNum], callback);\n    };\n    Volume.prototype.lchmodBase = function (filename, modeNum) {\n        var fd = this.openBase(filename, O_RDWR, 0, false);\n        try {\n            this.fchmodBase(fd, modeNum);\n        }\n        finally {\n            this.closeSync(fd);\n        }\n    };\n    Volume.prototype.lchmodSync = function (path, mode) {\n        var modeNum = modeToNumber(mode);\n        var filename = pathToFilename(path);\n        this.lchmodBase(filename, modeNum);\n    };\n    Volume.prototype.lchmod = function (path, mode, callback) {\n        var modeNum = modeToNumber(mode);\n        var filename = pathToFilename(path);\n        this.wrapAsync(this.lchmodBase, [filename, modeNum], callback);\n    };\n    Volume.prototype.fchownBase = function (fd, uid, gid) {\n        this.getFileByFdOrThrow(fd, 'fchown').chown(uid, gid);\n    };\n    Volume.prototype.fchownSync = function (fd, uid, gid) {\n        validateUid(uid);\n        validateGid(gid);\n        this.fchownBase(fd, uid, gid);\n    };\n    Volume.prototype.fchown = function (fd, uid, gid, callback) {\n        validateUid(uid);\n        validateGid(gid);\n        this.wrapAsync(this.fchownBase, [fd, uid, gid], callback);\n    };\n    Volume.prototype.chownBase = function (filename, uid, gid) {\n        var link = this.getResolvedLinkOrThrow(filename, 'chown');\n        var node = link.getNode();\n        node.chown(uid, gid);\n        // if(node.isFile() || node.isSymlink()) {\n        //\n        // } else if(node.isDirectory()) {\n        //\n        // } else {\n        // TODO: What do we do here?\n        // }\n    };\n    Volume.prototype.chownSync = function (path, uid, gid) {\n        validateUid(uid);\n        validateGid(gid);\n        this.chownBase(pathToFilename(path), uid, gid);\n    };\n    Volume.prototype.chown = function (path, uid, gid, callback) {\n        validateUid(uid);\n        validateGid(gid);\n        this.wrapAsync(this.chownBase, [pathToFilename(path), uid, gid], callback);\n    };\n    Volume.prototype.lchownBase = function (filename, uid, gid) {\n        this.getLinkOrThrow(filename, 'lchown').getNode().chown(uid, gid);\n    };\n    Volume.prototype.lchownSync = function (path, uid, gid) {\n        validateUid(uid);\n        validateGid(gid);\n        this.lchownBase(pathToFilename(path), uid, gid);\n    };\n    Volume.prototype.lchown = function (path, uid, gid, callback) {\n        validateUid(uid);\n        validateGid(gid);\n        this.wrapAsync(this.lchownBase, [pathToFilename(path), uid, gid], callback);\n    };\n    Volume.prototype.watchFile = function (path, a, b) {\n        var filename = pathToFilename(path);\n        var options = a;\n        var listener = b;\n        if (typeof options === 'function') {\n            listener = a;\n            options = null;\n        }\n        if (typeof listener !== 'function') {\n            throw Error('\"watchFile()\" requires a listener function');\n        }\n        var interval = 5007;\n        var persistent = true;\n        if (options && typeof options === 'object') {\n            if (typeof options.interval === 'number')\n                interval = options.interval;\n            if (typeof options.persistent === 'boolean')\n                persistent = options.persistent;\n        }\n        var watcher = this.statWatchers[filename];\n        if (!watcher) {\n            watcher = new this.StatWatcher();\n            watcher.start(filename, persistent, interval);\n            this.statWatchers[filename] = watcher;\n        }\n        watcher.addListener('change', listener);\n        return watcher;\n    };\n    Volume.prototype.unwatchFile = function (path, listener) {\n        var filename = pathToFilename(path);\n        var watcher = this.statWatchers[filename];\n        if (!watcher)\n            return;\n        if (typeof listener === 'function') {\n            watcher.removeListener('change', listener);\n        }\n        else {\n            watcher.removeAllListeners('change');\n        }\n        if (watcher.listenerCount('change') === 0) {\n            watcher.stop();\n            delete this.statWatchers[filename];\n        }\n    };\n    Volume.prototype.createReadStream = function (path, options) {\n        return new this.ReadStream(path, options);\n    };\n    Volume.prototype.createWriteStream = function (path, options) {\n        return new this.WriteStream(path, options);\n    };\n    // watch(path: PathLike): FSWatcher;\n    // watch(path: PathLike, options?: IWatchOptions | string): FSWatcher;\n    Volume.prototype.watch = function (path, options, listener) {\n        var filename = pathToFilename(path);\n        var givenOptions = options;\n        if (typeof options === 'function') {\n            listener = options;\n            givenOptions = null;\n        }\n        // tslint:disable-next-line prefer-const\n        var _a = getDefaultOpts(givenOptions), persistent = _a.persistent, recursive = _a.recursive, encoding = _a.encoding;\n        if (persistent === undefined)\n            persistent = true;\n        if (recursive === undefined)\n            recursive = false;\n        var watcher = new this.FSWatcher();\n        watcher.start(filename, persistent, recursive, encoding);\n        if (listener) {\n            watcher.addListener('change', listener);\n        }\n        return watcher;\n    };\n    /**\n     * Global file descriptor counter. UNIX file descriptors start from 0 and go sequentially\n     * up, so here, in order not to conflict with them, we choose some big number and descrease\n     * the file descriptor of every new opened file.\n     * @type {number}\n     * @todo This should not be static, right?\n     */\n    Volume.fd = 0x7fffffff;\n    return Volume;\n}());\nexports.Volume = Volume;\nfunction emitStop(self) {\n    self.emit('stop');\n}\nvar StatWatcher = /** @class */ (function (_super) {\n    __extends(StatWatcher, _super);\n    function StatWatcher(vol) {\n        var _this = _super.call(this) || this;\n        _this.onInterval = function () {\n            try {\n                var stats = _this.vol.statSync(_this.filename);\n                if (_this.hasChanged(stats)) {\n                    _this.emit('change', stats, _this.prev);\n                    _this.prev = stats;\n                }\n            }\n            finally {\n                _this.loop();\n            }\n        };\n        _this.vol = vol;\n        return _this;\n    }\n    StatWatcher.prototype.loop = function () {\n        this.timeoutRef = this.setTimeout(this.onInterval, this.interval);\n    };\n    StatWatcher.prototype.hasChanged = function (stats) {\n        // if(!this.prev) return false;\n        if (stats.mtimeMs > this.prev.mtimeMs)\n            return true;\n        if (stats.nlink !== this.prev.nlink)\n            return true;\n        return false;\n    };\n    StatWatcher.prototype.start = function (path, persistent, interval) {\n        if (persistent === void 0) { persistent = true; }\n        if (interval === void 0) { interval = 5007; }\n        this.filename = pathToFilename(path);\n        this.setTimeout = persistent\n            ? setTimeout.bind(typeof globalThis !== 'undefined' ? globalThis : global)\n            : setTimeoutUnref_1.default;\n        this.interval = interval;\n        this.prev = this.vol.statSync(this.filename);\n        this.loop();\n    };\n    StatWatcher.prototype.stop = function () {\n        clearTimeout(this.timeoutRef);\n        process_1.default.nextTick(emitStop, this);\n    };\n    return StatWatcher;\n}(events_1.EventEmitter));\nexports.StatWatcher = StatWatcher;\nvar pool;\nfunction allocNewPool(poolSize) {\n    pool = (0, buffer_1.bufferAllocUnsafe)(poolSize);\n    pool.used = 0;\n}\nutil.inherits(FsReadStream, stream_1.Readable);\nexports.ReadStream = FsReadStream;\nfunction FsReadStream(vol, path, options) {\n    if (!(this instanceof FsReadStream))\n        return new FsReadStream(vol, path, options);\n    this._vol = vol;\n    // a little bit bigger buffer and water marks by default\n    options = Object.assign({}, getOptions(options, {}));\n    if (options.highWaterMark === undefined)\n        options.highWaterMark = 64 * 1024;\n    stream_1.Readable.call(this, options);\n    this.path = pathToFilename(path);\n    this.fd = options.fd === undefined ? null : options.fd;\n    this.flags = options.flags === undefined ? 'r' : options.flags;\n    this.mode = options.mode === undefined ? 438 : options.mode;\n    this.start = options.start;\n    this.end = options.end;\n    this.autoClose = options.autoClose === undefined ? true : options.autoClose;\n    this.pos = undefined;\n    this.bytesRead = 0;\n    if (this.start !== undefined) {\n        if (typeof this.start !== 'number') {\n            throw new TypeError('\"start\" option must be a Number');\n        }\n        if (this.end === undefined) {\n            this.end = Infinity;\n        }\n        else if (typeof this.end !== 'number') {\n            throw new TypeError('\"end\" option must be a Number');\n        }\n        if (this.start > this.end) {\n            throw new Error('\"start\" option must be <= \"end\" option');\n        }\n        this.pos = this.start;\n    }\n    if (typeof this.fd !== 'number')\n        this.open();\n    this.on('end', function () {\n        if (this.autoClose) {\n            if (this.destroy)\n                this.destroy();\n        }\n    });\n}\nFsReadStream.prototype.open = function () {\n    var self = this; // tslint:disable-line no-this-assignment\n    this._vol.open(this.path, this.flags, this.mode, function (er, fd) {\n        if (er) {\n            if (self.autoClose) {\n                if (self.destroy)\n                    self.destroy();\n            }\n            self.emit('error', er);\n            return;\n        }\n        self.fd = fd;\n        self.emit('open', fd);\n        // start the flow of data.\n        self.read();\n    });\n};\nFsReadStream.prototype._read = function (n) {\n    if (typeof this.fd !== 'number') {\n        return this.once('open', function () {\n            this._read(n);\n        });\n    }\n    if (this.destroyed)\n        return;\n    if (!pool || pool.length - pool.used < kMinPoolSpace) {\n        // discard the old pool.\n        allocNewPool(this._readableState.highWaterMark);\n    }\n    // Grab another reference to the pool in the case that while we're\n    // in the thread pool another read() finishes up the pool, and\n    // allocates a new one.\n    var thisPool = pool;\n    var toRead = Math.min(pool.length - pool.used, n);\n    var start = pool.used;\n    if (this.pos !== undefined)\n        toRead = Math.min(this.end - this.pos + 1, toRead);\n    // already read everything we were supposed to read!\n    // treat as EOF.\n    if (toRead <= 0)\n        return this.push(null);\n    // the actual read.\n    var self = this; // tslint:disable-line no-this-assignment\n    this._vol.read(this.fd, pool, pool.used, toRead, this.pos, onread);\n    // move the pool positions, and internal position for reading.\n    if (this.pos !== undefined)\n        this.pos += toRead;\n    pool.used += toRead;\n    function onread(er, bytesRead) {\n        if (er) {\n            if (self.autoClose && self.destroy) {\n                self.destroy();\n            }\n            self.emit('error', er);\n        }\n        else {\n            var b = null;\n            if (bytesRead > 0) {\n                self.bytesRead += bytesRead;\n                b = thisPool.slice(start, start + bytesRead);\n            }\n            self.push(b);\n        }\n    }\n};\nFsReadStream.prototype._destroy = function (err, cb) {\n    this.close(function (err2) {\n        cb(err || err2);\n    });\n};\nFsReadStream.prototype.close = function (cb) {\n    var _this = this;\n    var _a;\n    if (cb)\n        this.once('close', cb);\n    if (this.closed || typeof this.fd !== 'number') {\n        if (typeof this.fd !== 'number') {\n            this.once('open', closeOnOpen);\n            return;\n        }\n        return process_1.default.nextTick(function () { return _this.emit('close'); });\n    }\n    // Since Node 18, there is only a getter for '.closed'.\n    // The first branch mimics other setters from Readable.\n    // See https://github.com/nodejs/node/blob/v18.0.0/lib/internal/streams/readable.js#L1243\n    if (typeof ((_a = this._readableState) === null || _a === void 0 ? void 0 : _a.closed) === 'boolean') {\n        this._readableState.closed = true;\n    }\n    else {\n        this.closed = true;\n    }\n    this._vol.close(this.fd, function (er) {\n        if (er)\n            _this.emit('error', er);\n        else\n            _this.emit('close');\n    });\n    this.fd = null;\n};\n// needed because as it will be called with arguments\n// that does not match this.close() signature\nfunction closeOnOpen(fd) {\n    this.close();\n}\nutil.inherits(FsWriteStream, stream_1.Writable);\nexports.WriteStream = FsWriteStream;\nfunction FsWriteStream(vol, path, options) {\n    if (!(this instanceof FsWriteStream))\n        return new FsWriteStream(vol, path, options);\n    this._vol = vol;\n    options = Object.assign({}, getOptions(options, {}));\n    stream_1.Writable.call(this, options);\n    this.path = pathToFilename(path);\n    this.fd = options.fd === undefined ? null : options.fd;\n    this.flags = options.flags === undefined ? 'w' : options.flags;\n    this.mode = options.mode === undefined ? 438 : options.mode;\n    this.start = options.start;\n    this.autoClose = options.autoClose === undefined ? true : !!options.autoClose;\n    this.pos = undefined;\n    this.bytesWritten = 0;\n    if (this.start !== undefined) {\n        if (typeof this.start !== 'number') {\n            throw new TypeError('\"start\" option must be a Number');\n        }\n        if (this.start < 0) {\n            throw new Error('\"start\" must be >= zero');\n        }\n        this.pos = this.start;\n    }\n    if (options.encoding)\n        this.setDefaultEncoding(options.encoding);\n    if (typeof this.fd !== 'number')\n        this.open();\n    // dispose on finish.\n    this.once('finish', function () {\n        if (this.autoClose) {\n            this.close();\n        }\n    });\n}\nFsWriteStream.prototype.open = function () {\n    this._vol.open(this.path, this.flags, this.mode, function (er, fd) {\n        if (er) {\n            if (this.autoClose && this.destroy) {\n                this.destroy();\n            }\n            this.emit('error', er);\n            return;\n        }\n        this.fd = fd;\n        this.emit('open', fd);\n    }.bind(this));\n};\nFsWriteStream.prototype._write = function (data, encoding, cb) {\n    if (!(data instanceof buffer_1.Buffer || data instanceof Uint8Array))\n        return this.emit('error', new Error('Invalid data'));\n    if (typeof this.fd !== 'number') {\n        return this.once('open', function () {\n            this._write(data, encoding, cb);\n        });\n    }\n    var self = this; // tslint:disable-line no-this-assignment\n    this._vol.write(this.fd, data, 0, data.length, this.pos, function (er, bytes) {\n        if (er) {\n            if (self.autoClose && self.destroy) {\n                self.destroy();\n            }\n            return cb(er);\n        }\n        self.bytesWritten += bytes;\n        cb();\n    });\n    if (this.pos !== undefined)\n        this.pos += data.length;\n};\nFsWriteStream.prototype._writev = function (data, cb) {\n    if (typeof this.fd !== 'number') {\n        return this.once('open', function () {\n            this._writev(data, cb);\n        });\n    }\n    var self = this; // tslint:disable-line no-this-assignment\n    var len = data.length;\n    var chunks = new Array(len);\n    var size = 0;\n    for (var i = 0; i < len; i++) {\n        var chunk = data[i].chunk;\n        chunks[i] = chunk;\n        size += chunk.length;\n    }\n    var buf = buffer_1.Buffer.concat(chunks);\n    this._vol.write(this.fd, buf, 0, buf.length, this.pos, function (er, bytes) {\n        if (er) {\n            if (self.destroy)\n                self.destroy();\n            return cb(er);\n        }\n        self.bytesWritten += bytes;\n        cb();\n    });\n    if (this.pos !== undefined)\n        this.pos += size;\n};\nFsWriteStream.prototype.close = function (cb) {\n    var _this = this;\n    var _a;\n    if (cb)\n        this.once('close', cb);\n    if (this.closed || typeof this.fd !== 'number') {\n        if (typeof this.fd !== 'number') {\n            this.once('open', closeOnOpen);\n            return;\n        }\n        return process_1.default.nextTick(function () { return _this.emit('close'); });\n    }\n    // Since Node 18, there is only a getter for '.closed'.\n    // The first branch mimics other setters from Writable.\n    // See https://github.com/nodejs/node/blob/v18.0.0/lib/internal/streams/writable.js#L766\n    if (typeof ((_a = this._writableState) === null || _a === void 0 ? void 0 : _a.closed) === 'boolean') {\n        this._writableState.closed = true;\n    }\n    else {\n        this.closed = true;\n    }\n    this._vol.close(this.fd, function (er) {\n        if (er)\n            _this.emit('error', er);\n        else\n            _this.emit('close');\n    });\n    this.fd = null;\n};\nFsWriteStream.prototype._destroy = FsReadStream.prototype._destroy;\n// There is no shutdown() for files.\nFsWriteStream.prototype.destroySoon = FsWriteStream.prototype.end;\n// ---------------------------------------- FSWatcher\nvar FSWatcher = /** @class */ (function (_super) {\n    __extends(FSWatcher, _super);\n    function FSWatcher(vol) {\n        var _this = _super.call(this) || this;\n        _this._filename = '';\n        _this._filenameEncoded = '';\n        // _persistent: boolean = true;\n        _this._recursive = false;\n        _this._encoding = encoding_1.ENCODING_UTF8;\n        _this._onNodeChange = function () {\n            _this._emit('change');\n        };\n        _this._onParentChild = function (link) {\n            if (link.getName() === _this._getName()) {\n                _this._emit('rename');\n            }\n        };\n        _this._emit = function (type) {\n            _this.emit('change', type, _this._filenameEncoded);\n        };\n        _this._persist = function () {\n            _this._timer = setTimeout(_this._persist, 1e6);\n        };\n        _this._vol = vol;\n        return _this;\n        // TODO: Emit \"error\" messages when watching.\n        // this._handle.onchange = function(status, eventType, filename) {\n        //     if (status < 0) {\n        //         self._handle.close();\n        //         const error = !filename ?\n        //             errnoException(status, 'Error watching file for changes:') :\n        //             errnoException(status, `Error watching file ${filename} for changes:`);\n        //         error.filename = filename;\n        //         self.emit('error', error);\n        //     } else {\n        //         self.emit('change', eventType, filename);\n        //     }\n        // };\n    }\n    FSWatcher.prototype._getName = function () {\n        return this._steps[this._steps.length - 1];\n    };\n    FSWatcher.prototype.start = function (path, persistent, recursive, encoding) {\n        if (persistent === void 0) { persistent = true; }\n        if (recursive === void 0) { recursive = false; }\n        if (encoding === void 0) { encoding = encoding_1.ENCODING_UTF8; }\n        this._filename = pathToFilename(path);\n        this._steps = filenameToSteps(this._filename);\n        this._filenameEncoded = (0, encoding_1.strToEncoding)(this._filename);\n        // this._persistent = persistent;\n        this._recursive = recursive;\n        this._encoding = encoding;\n        try {\n            this._link = this._vol.getLinkOrThrow(this._filename, 'FSWatcher');\n        }\n        catch (err) {\n            var error = new Error(\"watch \".concat(this._filename, \" \").concat(err.code));\n            error.code = err.code;\n            error.errno = err.code;\n            throw error;\n        }\n        this._link.getNode().on('change', this._onNodeChange);\n        this._link.on('child:add', this._onNodeChange);\n        this._link.on('child:delete', this._onNodeChange);\n        var parent = this._link.parent;\n        if (parent) {\n            // parent.on('child:add', this._onParentChild);\n            parent.setMaxListeners(parent.getMaxListeners() + 1);\n            parent.on('child:delete', this._onParentChild);\n        }\n        if (persistent)\n            this._persist();\n    };\n    FSWatcher.prototype.close = function () {\n        clearTimeout(this._timer);\n        this._link.getNode().removeListener('change', this._onNodeChange);\n        var parent = this._link.parent;\n        if (parent) {\n            // parent.removeListener('child:add', this._onParentChild);\n            parent.removeListener('child:delete', this._onParentChild);\n        }\n    };\n    return FSWatcher;\n}(events_1.EventEmitter));\nexports.FSWatcher = FSWatcher;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}