{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst util = __importStar(require(\"../util\"));\n\nconst util_1 = require(\"../util\");\n\nconst definition = {\n  type: 'object',\n  properties: {\n    before: {\n      type: 'boolean'\n    },\n    after: {\n      type: 'boolean'\n    }\n  },\n  additionalProperties: false\n};\n\nfunction createRules(options) {\n  var _a;\n\n  const globals = Object.assign(Object.assign({}, (options === null || options === void 0 ? void 0 : options.before) !== undefined ? {\n    before: options.before\n  } : {}), (options === null || options === void 0 ? void 0 : options.after) !== undefined ? {\n    after: options.after\n  } : {});\n  const override = (_a = options === null || options === void 0 ? void 0 : options.overrides) !== null && _a !== void 0 ? _a : {};\n  const colon = Object.assign(Object.assign({\n    before: false,\n    after: true\n  }, globals), override === null || override === void 0 ? void 0 : override.colon);\n  const arrow = Object.assign(Object.assign({\n    before: true,\n    after: true\n  }, globals), override === null || override === void 0 ? void 0 : override.arrow);\n  return {\n    colon: colon,\n    arrow: arrow,\n    variable: Object.assign(Object.assign({}, colon), override === null || override === void 0 ? void 0 : override.variable),\n    property: Object.assign(Object.assign({}, colon), override === null || override === void 0 ? void 0 : override.property),\n    parameter: Object.assign(Object.assign({}, colon), override === null || override === void 0 ? void 0 : override.parameter),\n    returnType: Object.assign(Object.assign({}, colon), override === null || override === void 0 ? void 0 : override.returnType)\n  };\n}\n\nfunction getIdentifierRules(rules, node) {\n  const scope = node === null || node === void 0 ? void 0 : node.parent;\n\n  if ((0, util_1.isVariableDeclarator)(scope)) {\n    return rules.variable;\n  } else if ((0, util_1.isFunctionOrFunctionType)(scope)) {\n    return rules.parameter;\n  } else {\n    return rules.colon;\n  }\n}\n\nfunction getRules(rules, node) {\n  var _a;\n\n  const scope = (_a = node === null || node === void 0 ? void 0 : node.parent) === null || _a === void 0 ? void 0 : _a.parent;\n\n  if ((0, util_1.isTSFunctionType)(scope) || (0, util_1.isTSConstructorType)(scope)) {\n    return rules.arrow;\n  } else if ((0, util_1.isIdentifier)(scope)) {\n    return getIdentifierRules(rules, scope);\n  } else if ((0, util_1.isClassOrTypeElement)(scope)) {\n    return rules.property;\n  } else if ((0, util_1.isFunction)(scope)) {\n    return rules.returnType;\n  } else {\n    return rules.colon;\n  }\n}\n\nexports.default = util.createRule({\n  name: 'type-annotation-spacing',\n  meta: {\n    type: 'layout',\n    docs: {\n      description: 'Require consistent spacing around type annotations',\n      recommended: false\n    },\n    fixable: 'whitespace',\n    messages: {\n      expectedSpaceAfter: \"Expected a space after the '{{type}}'.\",\n      expectedSpaceBefore: \"Expected a space before the '{{type}}'.\",\n      unexpectedSpaceAfter: \"Unexpected space after the '{{type}}'.\",\n      unexpectedSpaceBefore: \"Unexpected space before the '{{type}}'.\",\n      unexpectedSpaceBetween: \"Unexpected space between the '{{previousToken}}' and the '{{type}}'.\"\n    },\n    schema: [{\n      type: 'object',\n      properties: {\n        before: {\n          type: 'boolean'\n        },\n        after: {\n          type: 'boolean'\n        },\n        overrides: {\n          type: 'object',\n          properties: {\n            colon: definition,\n            arrow: definition,\n            variable: definition,\n            parameter: definition,\n            property: definition,\n            returnType: definition\n          },\n          additionalProperties: false\n        }\n      },\n      additionalProperties: false\n    }]\n  },\n  defaultOptions: [// technically there is a default, but the overrides mean\n  // that if we apply them here, it will break the no override case.\n  {}],\n\n  create(context, _ref) {\n    let [options] = _ref;\n    const punctuators = [':', '=>'];\n    const sourceCode = context.getSourceCode();\n    const ruleSet = createRules(options);\n    /**\n     * Checks if there's proper spacing around type annotations (no space\n     * before colon, one space after).\n     */\n\n    function checkTypeAnnotationSpacing(typeAnnotation) {\n      const nextToken = typeAnnotation;\n      const punctuatorTokenEnd = sourceCode.getTokenBefore(nextToken);\n      let punctuatorTokenStart = punctuatorTokenEnd;\n      let previousToken = sourceCode.getTokenBefore(punctuatorTokenEnd);\n      let type = punctuatorTokenEnd.value;\n\n      if (!punctuators.includes(type)) {\n        return;\n      }\n\n      const {\n        before,\n        after\n      } = getRules(ruleSet, typeAnnotation);\n\n      if (type === ':' && previousToken.value === '?') {\n        if ( // eslint-disable-next-line deprecation/deprecation -- TODO - switch once our min ESLint version is 6.7.0\n        sourceCode.isSpaceBetweenTokens(previousToken, punctuatorTokenStart)) {\n          context.report({\n            node: punctuatorTokenStart,\n            messageId: 'unexpectedSpaceBetween',\n            data: {\n              type,\n              previousToken: previousToken.value\n            },\n\n            fix(fixer) {\n              return fixer.removeRange([previousToken.range[1], punctuatorTokenStart.range[0]]);\n            }\n\n          });\n        } // shift the start to the ?\n\n\n        type = '?:';\n        punctuatorTokenStart = previousToken;\n        previousToken = sourceCode.getTokenBefore(previousToken); // handle the +/- modifiers for optional modification operators\n\n        if (previousToken.value === '+' || previousToken.value === '-') {\n          type = `${previousToken.value}?:`;\n          punctuatorTokenStart = previousToken;\n          previousToken = sourceCode.getTokenBefore(previousToken);\n        }\n      }\n\n      const previousDelta = punctuatorTokenStart.range[0] - previousToken.range[1];\n      const nextDelta = nextToken.range[0] - punctuatorTokenEnd.range[1];\n\n      if (after && nextDelta === 0) {\n        context.report({\n          node: punctuatorTokenEnd,\n          messageId: 'expectedSpaceAfter',\n          data: {\n            type\n          },\n\n          fix(fixer) {\n            return fixer.insertTextAfter(punctuatorTokenEnd, ' ');\n          }\n\n        });\n      } else if (!after && nextDelta > 0) {\n        context.report({\n          node: punctuatorTokenEnd,\n          messageId: 'unexpectedSpaceAfter',\n          data: {\n            type\n          },\n\n          fix(fixer) {\n            return fixer.removeRange([punctuatorTokenEnd.range[1], nextToken.range[0]]);\n          }\n\n        });\n      }\n\n      if (before && previousDelta === 0) {\n        context.report({\n          node: punctuatorTokenStart,\n          messageId: 'expectedSpaceBefore',\n          data: {\n            type\n          },\n\n          fix(fixer) {\n            return fixer.insertTextAfter(previousToken, ' ');\n          }\n\n        });\n      } else if (!before && previousDelta > 0) {\n        context.report({\n          node: punctuatorTokenStart,\n          messageId: 'unexpectedSpaceBefore',\n          data: {\n            type\n          },\n\n          fix(fixer) {\n            return fixer.removeRange([previousToken.range[1], punctuatorTokenStart.range[0]]);\n          }\n\n        });\n      }\n    }\n\n    return {\n      TSMappedType(node) {\n        if (node.typeAnnotation) {\n          checkTypeAnnotationSpacing(node.typeAnnotation);\n        }\n      },\n\n      TSTypeAnnotation(node) {\n        checkTypeAnnotationSpacing(node.typeAnnotation);\n      }\n\n    };\n  }\n\n});","map":{"version":3,"mappings":"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","names":["definition","type","properties","before","after","additionalProperties","createRules","options","globals","undefined","override","overrides","_a","colon","arrow","variable","property","parameter","returnType","getIdentifierRules","rules","node","scope","parent","getRules","exports","util","createRule","name","meta","docs","description","recommended","fixable","messages","expectedSpaceAfter","expectedSpaceBefore","unexpectedSpaceAfter","unexpectedSpaceBefore","unexpectedSpaceBetween","schema","defaultOptions","create","context","punctuators","sourceCode","getSourceCode","ruleSet","checkTypeAnnotationSpacing","typeAnnotation","nextToken","punctuatorTokenEnd","getTokenBefore","punctuatorTokenStart","previousToken","value","includes","isSpaceBetweenTokens","report","messageId","data","fix","fixer","removeRange","range","previousDelta","nextDelta","insertTextAfter","TSMappedType","TSTypeAnnotation"],"sources":["../../src/rules/type-annotation-spacing.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}