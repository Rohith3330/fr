{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RULE_NAME = void 0;\n\nconst create_testing_library_rule_1 = require(\"../create-testing-library-rule\");\n\nconst node_utils_1 = require(\"../node-utils\");\n\nexports.RULE_NAME = 'no-wait-for-side-effects';\nexports.default = (0, create_testing_library_rule_1.createTestingLibraryRule)({\n  name: exports.RULE_NAME,\n  meta: {\n    type: 'suggestion',\n    docs: {\n      description: 'Disallow the use of side effects in `waitFor`',\n      recommendedConfig: {\n        dom: 'error',\n        angular: 'error',\n        react: 'error',\n        vue: 'error',\n        marko: 'error'\n      }\n    },\n    messages: {\n      noSideEffectsWaitFor: 'Avoid using side effects within `waitFor` callback'\n    },\n    schema: []\n  },\n  defaultOptions: [],\n\n  create(context, _, helpers) {\n    function isCallerWaitFor(node) {\n      if (!node.parent) {\n        return false;\n      }\n\n      const callExpressionNode = node.parent.parent;\n      const callExpressionIdentifier = (0, node_utils_1.getPropertyIdentifierNode)(callExpressionNode);\n      return !!callExpressionIdentifier && helpers.isAsyncUtil(callExpressionIdentifier, ['waitFor']);\n    }\n\n    function isCallerThen(node) {\n      if (!node.parent) {\n        return false;\n      }\n\n      const callExpressionNode = node.parent.parent;\n      return (0, node_utils_1.hasThenProperty)(callExpressionNode.callee);\n    }\n\n    function isRenderInVariableDeclaration(node) {\n      return (0, node_utils_1.isVariableDeclaration)(node) && node.declarations.some(helpers.isRenderVariableDeclarator);\n    }\n\n    function isRenderInExpressionStatement(node) {\n      if (!(0, node_utils_1.isExpressionStatement)(node) || !(0, node_utils_1.isAssignmentExpression)(node.expression)) {\n        return false;\n      }\n\n      const expressionIdentifier = (0, node_utils_1.getPropertyIdentifierNode)(node.expression.right);\n\n      if (!expressionIdentifier) {\n        return false;\n      }\n\n      return helpers.isRenderUtil(expressionIdentifier);\n    }\n\n    function isRenderInAssignmentExpression(node) {\n      if (!(0, node_utils_1.isAssignmentExpression)(node)) {\n        return false;\n      }\n\n      const expressionIdentifier = (0, node_utils_1.getPropertyIdentifierNode)(node.right);\n\n      if (!expressionIdentifier) {\n        return false;\n      }\n\n      return helpers.isRenderUtil(expressionIdentifier);\n    }\n\n    function isRenderInSequenceAssignment(node) {\n      if (!(0, node_utils_1.isSequenceExpression)(node)) {\n        return false;\n      }\n\n      return node.expressions.some(isRenderInAssignmentExpression);\n    }\n\n    function getSideEffectNodes(body) {\n      return body.filter(node => {\n        if (!(0, node_utils_1.isExpressionStatement)(node) && !(0, node_utils_1.isVariableDeclaration)(node)) {\n          return false;\n        }\n\n        if (isRenderInVariableDeclaration(node) || isRenderInExpressionStatement(node)) {\n          return true;\n        }\n\n        const expressionIdentifier = (0, node_utils_1.getPropertyIdentifierNode)(node);\n\n        if (!expressionIdentifier) {\n          return false;\n        }\n\n        return helpers.isFireEventUtil(expressionIdentifier) || helpers.isUserEventUtil(expressionIdentifier) || helpers.isRenderUtil(expressionIdentifier);\n      });\n    }\n\n    function reportSideEffects(node) {\n      if (!isCallerWaitFor(node)) {\n        return;\n      }\n\n      if (isCallerThen(node)) {\n        return;\n      }\n\n      getSideEffectNodes(node.body).forEach(sideEffectNode => context.report({\n        node: sideEffectNode,\n        messageId: 'noSideEffectsWaitFor'\n      }));\n    }\n\n    function reportImplicitReturnSideEffect(node) {\n      if (!isCallerWaitFor(node)) {\n        return;\n      }\n\n      const expressionIdentifier = (0, node_utils_1.isCallExpression)(node) ? (0, node_utils_1.getPropertyIdentifierNode)(node.callee) : null;\n\n      if (!expressionIdentifier && !isRenderInAssignmentExpression(node) && !isRenderInSequenceAssignment(node)) {\n        return;\n      }\n\n      if (expressionIdentifier && !helpers.isFireEventUtil(expressionIdentifier) && !helpers.isUserEventUtil(expressionIdentifier) && !helpers.isRenderUtil(expressionIdentifier)) {\n        return;\n      }\n\n      context.report({\n        node,\n        messageId: 'noSideEffectsWaitFor'\n      });\n    }\n\n    return {\n      'CallExpression > ArrowFunctionExpression > BlockStatement': reportSideEffects,\n      'CallExpression > ArrowFunctionExpression > CallExpression': reportImplicitReturnSideEffect,\n      'CallExpression > ArrowFunctionExpression > AssignmentExpression': reportImplicitReturnSideEffect,\n      'CallExpression > ArrowFunctionExpression > SequenceExpression': reportImplicitReturnSideEffect,\n      'CallExpression > FunctionExpression > BlockStatement': reportSideEffects\n    };\n  }\n\n});","map":{"version":3,"names":["Object","defineProperty","exports","value","RULE_NAME","create_testing_library_rule_1","require","node_utils_1","default","createTestingLibraryRule","name","meta","type","docs","description","recommendedConfig","dom","angular","react","vue","marko","messages","noSideEffectsWaitFor","schema","defaultOptions","create","context","_","helpers","isCallerWaitFor","node","parent","callExpressionNode","callExpressionIdentifier","getPropertyIdentifierNode","isAsyncUtil","isCallerThen","hasThenProperty","callee","isRenderInVariableDeclaration","isVariableDeclaration","declarations","some","isRenderVariableDeclarator","isRenderInExpressionStatement","isExpressionStatement","isAssignmentExpression","expression","expressionIdentifier","right","isRenderUtil","isRenderInAssignmentExpression","isRenderInSequenceAssignment","isSequenceExpression","expressions","getSideEffectNodes","body","filter","isFireEventUtil","isUserEventUtil","reportSideEffects","forEach","sideEffectNode","report","messageId","reportImplicitReturnSideEffect","isCallExpression"],"sources":["C:/Users/Rohith/mern/frontend/node_modules/eslint-plugin-testing-library/rules/no-wait-for-side-effects.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RULE_NAME = void 0;\nconst create_testing_library_rule_1 = require(\"../create-testing-library-rule\");\nconst node_utils_1 = require(\"../node-utils\");\nexports.RULE_NAME = 'no-wait-for-side-effects';\nexports.default = (0, create_testing_library_rule_1.createTestingLibraryRule)({\n    name: exports.RULE_NAME,\n    meta: {\n        type: 'suggestion',\n        docs: {\n            description: 'Disallow the use of side effects in `waitFor`',\n            recommendedConfig: {\n                dom: 'error',\n                angular: 'error',\n                react: 'error',\n                vue: 'error',\n                marko: 'error',\n            },\n        },\n        messages: {\n            noSideEffectsWaitFor: 'Avoid using side effects within `waitFor` callback',\n        },\n        schema: [],\n    },\n    defaultOptions: [],\n    create(context, _, helpers) {\n        function isCallerWaitFor(node) {\n            if (!node.parent) {\n                return false;\n            }\n            const callExpressionNode = node.parent.parent;\n            const callExpressionIdentifier = (0, node_utils_1.getPropertyIdentifierNode)(callExpressionNode);\n            return (!!callExpressionIdentifier &&\n                helpers.isAsyncUtil(callExpressionIdentifier, ['waitFor']));\n        }\n        function isCallerThen(node) {\n            if (!node.parent) {\n                return false;\n            }\n            const callExpressionNode = node.parent.parent;\n            return (0, node_utils_1.hasThenProperty)(callExpressionNode.callee);\n        }\n        function isRenderInVariableDeclaration(node) {\n            return ((0, node_utils_1.isVariableDeclaration)(node) &&\n                node.declarations.some(helpers.isRenderVariableDeclarator));\n        }\n        function isRenderInExpressionStatement(node) {\n            if (!(0, node_utils_1.isExpressionStatement)(node) ||\n                !(0, node_utils_1.isAssignmentExpression)(node.expression)) {\n                return false;\n            }\n            const expressionIdentifier = (0, node_utils_1.getPropertyIdentifierNode)(node.expression.right);\n            if (!expressionIdentifier) {\n                return false;\n            }\n            return helpers.isRenderUtil(expressionIdentifier);\n        }\n        function isRenderInAssignmentExpression(node) {\n            if (!(0, node_utils_1.isAssignmentExpression)(node)) {\n                return false;\n            }\n            const expressionIdentifier = (0, node_utils_1.getPropertyIdentifierNode)(node.right);\n            if (!expressionIdentifier) {\n                return false;\n            }\n            return helpers.isRenderUtil(expressionIdentifier);\n        }\n        function isRenderInSequenceAssignment(node) {\n            if (!(0, node_utils_1.isSequenceExpression)(node)) {\n                return false;\n            }\n            return node.expressions.some(isRenderInAssignmentExpression);\n        }\n        function getSideEffectNodes(body) {\n            return body.filter((node) => {\n                if (!(0, node_utils_1.isExpressionStatement)(node) && !(0, node_utils_1.isVariableDeclaration)(node)) {\n                    return false;\n                }\n                if (isRenderInVariableDeclaration(node) ||\n                    isRenderInExpressionStatement(node)) {\n                    return true;\n                }\n                const expressionIdentifier = (0, node_utils_1.getPropertyIdentifierNode)(node);\n                if (!expressionIdentifier) {\n                    return false;\n                }\n                return (helpers.isFireEventUtil(expressionIdentifier) ||\n                    helpers.isUserEventUtil(expressionIdentifier) ||\n                    helpers.isRenderUtil(expressionIdentifier));\n            });\n        }\n        function reportSideEffects(node) {\n            if (!isCallerWaitFor(node)) {\n                return;\n            }\n            if (isCallerThen(node)) {\n                return;\n            }\n            getSideEffectNodes(node.body).forEach((sideEffectNode) => context.report({\n                node: sideEffectNode,\n                messageId: 'noSideEffectsWaitFor',\n            }));\n        }\n        function reportImplicitReturnSideEffect(node) {\n            if (!isCallerWaitFor(node)) {\n                return;\n            }\n            const expressionIdentifier = (0, node_utils_1.isCallExpression)(node)\n                ? (0, node_utils_1.getPropertyIdentifierNode)(node.callee)\n                : null;\n            if (!expressionIdentifier &&\n                !isRenderInAssignmentExpression(node) &&\n                !isRenderInSequenceAssignment(node)) {\n                return;\n            }\n            if (expressionIdentifier &&\n                !helpers.isFireEventUtil(expressionIdentifier) &&\n                !helpers.isUserEventUtil(expressionIdentifier) &&\n                !helpers.isRenderUtil(expressionIdentifier)) {\n                return;\n            }\n            context.report({\n                node,\n                messageId: 'noSideEffectsWaitFor',\n            });\n        }\n        return {\n            'CallExpression > ArrowFunctionExpression > BlockStatement': reportSideEffects,\n            'CallExpression > ArrowFunctionExpression > CallExpression': reportImplicitReturnSideEffect,\n            'CallExpression > ArrowFunctionExpression > AssignmentExpression': reportImplicitReturnSideEffect,\n            'CallExpression > ArrowFunctionExpression > SequenceExpression': reportImplicitReturnSideEffect,\n            'CallExpression > FunctionExpression > BlockStatement': reportSideEffects,\n        };\n    },\n});\n"],"mappings":"AAAA;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;EAAEC,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,SAAR,GAAoB,KAAK,CAAzB;;AACA,MAAMC,6BAA6B,GAAGC,OAAO,CAAC,gCAAD,CAA7C;;AACA,MAAMC,YAAY,GAAGD,OAAO,CAAC,eAAD,CAA5B;;AACAJ,OAAO,CAACE,SAAR,GAAoB,0BAApB;AACAF,OAAO,CAACM,OAAR,GAAkB,CAAC,GAAGH,6BAA6B,CAACI,wBAAlC,EAA4D;EAC1EC,IAAI,EAAER,OAAO,CAACE,SAD4D;EAE1EO,IAAI,EAAE;IACFC,IAAI,EAAE,YADJ;IAEFC,IAAI,EAAE;MACFC,WAAW,EAAE,+CADX;MAEFC,iBAAiB,EAAE;QACfC,GAAG,EAAE,OADU;QAEfC,OAAO,EAAE,OAFM;QAGfC,KAAK,EAAE,OAHQ;QAIfC,GAAG,EAAE,OAJU;QAKfC,KAAK,EAAE;MALQ;IAFjB,CAFJ;IAYFC,QAAQ,EAAE;MACNC,oBAAoB,EAAE;IADhB,CAZR;IAeFC,MAAM,EAAE;EAfN,CAFoE;EAmB1EC,cAAc,EAAE,EAnB0D;;EAoB1EC,MAAM,CAACC,OAAD,EAAUC,CAAV,EAAaC,OAAb,EAAsB;IACxB,SAASC,eAAT,CAAyBC,IAAzB,EAA+B;MAC3B,IAAI,CAACA,IAAI,CAACC,MAAV,EAAkB;QACd,OAAO,KAAP;MACH;;MACD,MAAMC,kBAAkB,GAAGF,IAAI,CAACC,MAAL,CAAYA,MAAvC;MACA,MAAME,wBAAwB,GAAG,CAAC,GAAG1B,YAAY,CAAC2B,yBAAjB,EAA4CF,kBAA5C,CAAjC;MACA,OAAQ,CAAC,CAACC,wBAAF,IACJL,OAAO,CAACO,WAAR,CAAoBF,wBAApB,EAA8C,CAAC,SAAD,CAA9C,CADJ;IAEH;;IACD,SAASG,YAAT,CAAsBN,IAAtB,EAA4B;MACxB,IAAI,CAACA,IAAI,CAACC,MAAV,EAAkB;QACd,OAAO,KAAP;MACH;;MACD,MAAMC,kBAAkB,GAAGF,IAAI,CAACC,MAAL,CAAYA,MAAvC;MACA,OAAO,CAAC,GAAGxB,YAAY,CAAC8B,eAAjB,EAAkCL,kBAAkB,CAACM,MAArD,CAAP;IACH;;IACD,SAASC,6BAAT,CAAuCT,IAAvC,EAA6C;MACzC,OAAQ,CAAC,GAAGvB,YAAY,CAACiC,qBAAjB,EAAwCV,IAAxC,KACJA,IAAI,CAACW,YAAL,CAAkBC,IAAlB,CAAuBd,OAAO,CAACe,0BAA/B,CADJ;IAEH;;IACD,SAASC,6BAAT,CAAuCd,IAAvC,EAA6C;MACzC,IAAI,CAAC,CAAC,GAAGvB,YAAY,CAACsC,qBAAjB,EAAwCf,IAAxC,CAAD,IACA,CAAC,CAAC,GAAGvB,YAAY,CAACuC,sBAAjB,EAAyChB,IAAI,CAACiB,UAA9C,CADL,EACgE;QAC5D,OAAO,KAAP;MACH;;MACD,MAAMC,oBAAoB,GAAG,CAAC,GAAGzC,YAAY,CAAC2B,yBAAjB,EAA4CJ,IAAI,CAACiB,UAAL,CAAgBE,KAA5D,CAA7B;;MACA,IAAI,CAACD,oBAAL,EAA2B;QACvB,OAAO,KAAP;MACH;;MACD,OAAOpB,OAAO,CAACsB,YAAR,CAAqBF,oBAArB,CAAP;IACH;;IACD,SAASG,8BAAT,CAAwCrB,IAAxC,EAA8C;MAC1C,IAAI,CAAC,CAAC,GAAGvB,YAAY,CAACuC,sBAAjB,EAAyChB,IAAzC,CAAL,EAAqD;QACjD,OAAO,KAAP;MACH;;MACD,MAAMkB,oBAAoB,GAAG,CAAC,GAAGzC,YAAY,CAAC2B,yBAAjB,EAA4CJ,IAAI,CAACmB,KAAjD,CAA7B;;MACA,IAAI,CAACD,oBAAL,EAA2B;QACvB,OAAO,KAAP;MACH;;MACD,OAAOpB,OAAO,CAACsB,YAAR,CAAqBF,oBAArB,CAAP;IACH;;IACD,SAASI,4BAAT,CAAsCtB,IAAtC,EAA4C;MACxC,IAAI,CAAC,CAAC,GAAGvB,YAAY,CAAC8C,oBAAjB,EAAuCvB,IAAvC,CAAL,EAAmD;QAC/C,OAAO,KAAP;MACH;;MACD,OAAOA,IAAI,CAACwB,WAAL,CAAiBZ,IAAjB,CAAsBS,8BAAtB,CAAP;IACH;;IACD,SAASI,kBAAT,CAA4BC,IAA5B,EAAkC;MAC9B,OAAOA,IAAI,CAACC,MAAL,CAAa3B,IAAD,IAAU;QACzB,IAAI,CAAC,CAAC,GAAGvB,YAAY,CAACsC,qBAAjB,EAAwCf,IAAxC,CAAD,IAAkD,CAAC,CAAC,GAAGvB,YAAY,CAACiC,qBAAjB,EAAwCV,IAAxC,CAAvD,EAAsG;UAClG,OAAO,KAAP;QACH;;QACD,IAAIS,6BAA6B,CAACT,IAAD,CAA7B,IACAc,6BAA6B,CAACd,IAAD,CADjC,EACyC;UACrC,OAAO,IAAP;QACH;;QACD,MAAMkB,oBAAoB,GAAG,CAAC,GAAGzC,YAAY,CAAC2B,yBAAjB,EAA4CJ,IAA5C,CAA7B;;QACA,IAAI,CAACkB,oBAAL,EAA2B;UACvB,OAAO,KAAP;QACH;;QACD,OAAQpB,OAAO,CAAC8B,eAAR,CAAwBV,oBAAxB,KACJpB,OAAO,CAAC+B,eAAR,CAAwBX,oBAAxB,CADI,IAEJpB,OAAO,CAACsB,YAAR,CAAqBF,oBAArB,CAFJ;MAGH,CAfM,CAAP;IAgBH;;IACD,SAASY,iBAAT,CAA2B9B,IAA3B,EAAiC;MAC7B,IAAI,CAACD,eAAe,CAACC,IAAD,CAApB,EAA4B;QACxB;MACH;;MACD,IAAIM,YAAY,CAACN,IAAD,CAAhB,EAAwB;QACpB;MACH;;MACDyB,kBAAkB,CAACzB,IAAI,CAAC0B,IAAN,CAAlB,CAA8BK,OAA9B,CAAuCC,cAAD,IAAoBpC,OAAO,CAACqC,MAAR,CAAe;QACrEjC,IAAI,EAAEgC,cAD+D;QAErEE,SAAS,EAAE;MAF0D,CAAf,CAA1D;IAIH;;IACD,SAASC,8BAAT,CAAwCnC,IAAxC,EAA8C;MAC1C,IAAI,CAACD,eAAe,CAACC,IAAD,CAApB,EAA4B;QACxB;MACH;;MACD,MAAMkB,oBAAoB,GAAG,CAAC,GAAGzC,YAAY,CAAC2D,gBAAjB,EAAmCpC,IAAnC,IACvB,CAAC,GAAGvB,YAAY,CAAC2B,yBAAjB,EAA4CJ,IAAI,CAACQ,MAAjD,CADuB,GAEvB,IAFN;;MAGA,IAAI,CAACU,oBAAD,IACA,CAACG,8BAA8B,CAACrB,IAAD,CAD/B,IAEA,CAACsB,4BAA4B,CAACtB,IAAD,CAFjC,EAEyC;QACrC;MACH;;MACD,IAAIkB,oBAAoB,IACpB,CAACpB,OAAO,CAAC8B,eAAR,CAAwBV,oBAAxB,CADD,IAEA,CAACpB,OAAO,CAAC+B,eAAR,CAAwBX,oBAAxB,CAFD,IAGA,CAACpB,OAAO,CAACsB,YAAR,CAAqBF,oBAArB,CAHL,EAGiD;QAC7C;MACH;;MACDtB,OAAO,CAACqC,MAAR,CAAe;QACXjC,IADW;QAEXkC,SAAS,EAAE;MAFA,CAAf;IAIH;;IACD,OAAO;MACH,6DAA6DJ,iBAD1D;MAEH,6DAA6DK,8BAF1D;MAGH,mEAAmEA,8BAHhE;MAIH,iEAAiEA,8BAJ9D;MAKH,wDAAwDL;IALrD,CAAP;EAOH;;AAhIyE,CAA5D,CAAlB"},"metadata":{},"sourceType":"script"}