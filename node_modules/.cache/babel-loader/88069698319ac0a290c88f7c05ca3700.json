{"ast":null,"code":"'use strict';\n\nvar transport = require('../../../spdy-transport');\n\nvar constants = require('./').constants;\n\nvar base = transport.protocol.base;\nvar utils = base.utils;\n\nvar assert = require('assert');\n\nvar util = require('util');\n\nvar Buffer = require('buffer').Buffer;\n\nvar WriteBuffer = require('wbuf');\n\nvar debug = require('debug')('spdy:framer');\n\nfunction Framer(options) {\n  base.Framer.call(this, options);\n}\n\nutil.inherits(Framer, base.Framer);\nmodule.exports = Framer;\n\nFramer.create = function create(options) {\n  return new Framer(options);\n};\n\nFramer.prototype.setMaxFrameSize = function setMaxFrameSize(size) {// http2-only\n};\n\nFramer.prototype.headersToDict = function headersToDict(headers, preprocess, callback) {\n  function stringify(value) {\n    if (value !== undefined) {\n      if (Array.isArray(value)) {\n        return value.join('\\x00');\n      } else if (typeof value === 'string') {\n        return value;\n      } else {\n        return value.toString();\n      }\n    } else {\n      return '';\n    }\n  } // Lower case of all headers keys\n\n\n  var loweredHeaders = {};\n  Object.keys(headers || {}).map(function (key) {\n    loweredHeaders[key.toLowerCase()] = headers[key];\n  }); // Allow outer code to add custom headers or remove something\n\n  if (preprocess) {\n    preprocess(loweredHeaders);\n  } // Transform object into kv pairs\n\n\n  var size = this.version === 2 ? 2 : 4;\n  var len = size;\n  var pairs = Object.keys(loweredHeaders).filter(function (key) {\n    var lkey = key.toLowerCase(); // Will be in `:host`\n\n    if (lkey === 'host' && this.version >= 3) {\n      return false;\n    }\n\n    return lkey !== 'connection' && lkey !== 'keep-alive' && lkey !== 'proxy-connection' && lkey !== 'transfer-encoding';\n  }, this).map(function (key) {\n    var klen = Buffer.byteLength(key);\n    var value = stringify(loweredHeaders[key]);\n    var vlen = Buffer.byteLength(value);\n    len += size * 2 + klen + vlen;\n    return [klen, key, vlen, value];\n  });\n  var block = new WriteBuffer();\n  block.reserve(len);\n\n  if (this.version === 2) {\n    block.writeUInt16BE(pairs.length);\n  } else {\n    block.writeUInt32BE(pairs.length);\n  }\n\n  pairs.forEach(function (pair) {\n    // Write key length\n    if (this.version === 2) {\n      block.writeUInt16BE(pair[0]);\n    } else {\n      block.writeUInt32BE(pair[0]);\n    } // Write key\n\n\n    block.write(pair[1]); // Write value length\n\n    if (this.version === 2) {\n      block.writeUInt16BE(pair[2]);\n    } else {\n      block.writeUInt32BE(pair[2]);\n    } // Write value\n\n\n    block.write(pair[3]);\n  }, this);\n  assert(this.compress !== null, 'Framer version not initialized');\n  this.compress.write(block.render(), callback);\n};\n\nFramer.prototype._frame = function _frame(frame, body, callback) {\n  if (!this.version) {\n    this.on('version', function () {\n      this._frame(frame, body, callback);\n    });\n    return;\n  }\n\n  debug('id=%d type=%s', frame.id, frame.type);\n  var buffer = new WriteBuffer();\n  buffer.writeUInt16BE(0x8000 | this.version);\n  buffer.writeUInt16BE(constants.frameType[frame.type]);\n  buffer.writeUInt8(frame.flags);\n  var len = buffer.skip(3);\n  body(buffer);\n  var frameSize = buffer.size - constants.FRAME_HEADER_SIZE;\n  len.writeUInt24BE(frameSize);\n  var chunks = buffer.render();\n  var toWrite = {\n    stream: frame.id,\n    priority: false,\n    chunks: chunks,\n    callback: callback\n  };\n\n  this._resetTimeout();\n\n  this.schedule(toWrite);\n  return chunks;\n};\n\nFramer.prototype._synFrame = function _synFrame(frame, callback) {\n  var self = this;\n\n  if (!frame.path) {\n    throw new Error('`path` is required frame argument');\n  }\n\n  function preprocess(headers) {\n    var method = frame.method || base.constants.DEFAULT_METHOD;\n    var version = frame.version || 'HTTP/1.1';\n    var scheme = frame.scheme || 'https';\n    var host = frame.host || frame.headers && frame.headers.host || base.constants.DEFAULT_HOST;\n\n    if (self.version === 2) {\n      headers.method = method;\n      headers.version = version;\n      headers.url = frame.path;\n      headers.scheme = scheme;\n      headers.host = host;\n\n      if (frame.status) {\n        headers.status = frame.status;\n      }\n    } else {\n      headers[':method'] = method;\n      headers[':version'] = version;\n      headers[':path'] = frame.path;\n      headers[':scheme'] = scheme;\n      headers[':host'] = host;\n\n      if (frame.status) {\n        headers[':status'] = frame.status;\n      }\n    }\n  }\n\n  this.headersToDict(frame.headers, preprocess, function (err, chunks) {\n    if (err) {\n      if (callback) {\n        return callback(err);\n      } else {\n        return self.emit('error', err);\n      }\n    }\n\n    self._frame({\n      type: 'SYN_STREAM',\n      id: frame.id,\n      flags: frame.fin ? constants.flags.FLAG_FIN : 0\n    }, function (buf) {\n      buf.reserve(10);\n      buf.writeUInt32BE(frame.id & 0x7fffffff);\n      buf.writeUInt32BE(frame.associated & 0x7fffffff);\n      var weight = frame.priority && frame.priority.weight || constants.DEFAULT_WEIGHT; // We only have 3 bits for priority in SPDY, try to fit it into this\n\n      var priority = utils.weightToPriority(weight);\n      buf.writeUInt8(priority << 5); // CREDENTIALS slot\n\n      buf.writeUInt8(0);\n\n      for (var i = 0; i < chunks.length; i++) {\n        buf.copyFrom(chunks[i]);\n      }\n    }, callback);\n  });\n};\n\nFramer.prototype.requestFrame = function requestFrame(frame, callback) {\n  this._synFrame({\n    id: frame.id,\n    fin: frame.fin,\n    associated: 0,\n    method: frame.method,\n    version: frame.version,\n    scheme: frame.scheme,\n    host: frame.host,\n    path: frame.path,\n    priority: frame.priority,\n    headers: frame.headers\n  }, callback);\n};\n\nFramer.prototype.responseFrame = function responseFrame(frame, callback) {\n  var self = this;\n  var reason = frame.reason;\n\n  if (!reason) {\n    reason = constants.statusReason[frame.status];\n  }\n\n  function preprocess(headers) {\n    if (self.version === 2) {\n      headers.status = frame.status + ' ' + reason;\n      headers.version = 'HTTP/1.1';\n    } else {\n      headers[':status'] = frame.status + ' ' + reason;\n      headers[':version'] = 'HTTP/1.1';\n    }\n  }\n\n  this.headersToDict(frame.headers, preprocess, function (err, chunks) {\n    if (err) {\n      if (callback) {\n        return callback(err);\n      } else {\n        return self.emit('error', err);\n      }\n    }\n\n    self._frame({\n      type: 'SYN_REPLY',\n      id: frame.id,\n      flags: 0\n    }, function (buf) {\n      buf.reserve(self.version === 2 ? 6 : 4);\n      buf.writeUInt32BE(frame.id & 0x7fffffff); // Unused data\n\n      if (self.version === 2) {\n        buf.writeUInt16BE(0);\n      }\n\n      for (var i = 0; i < chunks.length; i++) {\n        buf.copyFrom(chunks[i]);\n      }\n    }, callback);\n  });\n};\n\nFramer.prototype.pushFrame = function pushFrame(frame, callback) {\n  var self = this;\n\n  this._checkPush(function (err) {\n    if (err) {\n      return callback(err);\n    }\n\n    self._synFrame({\n      id: frame.promisedId,\n      associated: frame.id,\n      method: frame.method,\n      status: frame.status || 200,\n      version: frame.version,\n      scheme: frame.scheme,\n      host: frame.host,\n      path: frame.path,\n      priority: frame.priority,\n      // Merge everything together, there is no difference in SPDY protocol\n      headers: Object.assign(Object.assign({}, frame.headers), frame.response)\n    }, callback);\n  });\n};\n\nFramer.prototype.headersFrame = function headersFrame(frame, callback) {\n  var self = this;\n  this.headersToDict(frame.headers, null, function (err, chunks) {\n    if (err) {\n      if (callback) {\n        return callback(err);\n      } else {\n        return self.emit('error', err);\n      }\n    }\n\n    self._frame({\n      type: 'HEADERS',\n      id: frame.id,\n      priority: false,\n      flags: 0\n    }, function (buf) {\n      buf.reserve(4 + (self.version === 2 ? 2 : 0));\n      buf.writeUInt32BE(frame.id & 0x7fffffff); // Unused data\n\n      if (self.version === 2) {\n        buf.writeUInt16BE(0);\n      }\n\n      for (var i = 0; i < chunks.length; i++) {\n        buf.copyFrom(chunks[i]);\n      }\n    }, callback);\n  });\n};\n\nFramer.prototype.dataFrame = function dataFrame(frame, callback) {\n  if (!this.version) {\n    return this.on('version', function () {\n      this.dataFrame(frame, callback);\n    });\n  }\n\n  debug('id=%d type=DATA', frame.id);\n  var buffer = new WriteBuffer();\n  buffer.reserve(8 + frame.data.length);\n  buffer.writeUInt32BE(frame.id & 0x7fffffff);\n  buffer.writeUInt8(frame.fin ? 0x01 : 0x0);\n  buffer.writeUInt24BE(frame.data.length);\n  buffer.copyFrom(frame.data);\n  var chunks = buffer.render();\n  var toWrite = {\n    stream: frame.id,\n    priority: frame.priority,\n    chunks: chunks,\n    callback: callback\n  };\n  var self = this;\n\n  this._resetTimeout();\n\n  var bypass = this.version < 3.1;\n  this.window.send.update(-frame.data.length, bypass ? undefined : function () {\n    self._resetTimeout();\n\n    self.schedule(toWrite);\n  });\n\n  if (bypass) {\n    this._resetTimeout();\n\n    this.schedule(toWrite);\n  }\n};\n\nFramer.prototype.pingFrame = function pingFrame(frame, callback) {\n  this._frame({\n    type: 'PING',\n    id: 0,\n    flags: 0\n  }, function (buf, callback) {\n    buf.reserve(4);\n    var opaque = frame.opaque;\n    buf.writeUInt32BE(opaque.readUInt32BE(opaque.length - 4, true));\n  }, callback);\n};\n\nFramer.prototype.rstFrame = function rstFrame(frame, callback) {\n  this._frame({\n    type: 'RST_STREAM',\n    id: frame.id,\n    flags: 0\n  }, function (buf) {\n    buf.reserve(8); // Stream ID\n\n    buf.writeUInt32BE(frame.id & 0x7fffffff); // Status Code\n\n    buf.writeUInt32BE(constants.error[frame.code]); // Extra debugging information\n\n    if (frame.extra) {\n      buf.write(frame.extra);\n    }\n  }, callback);\n};\n\nFramer.prototype.prefaceFrame = function prefaceFrame() {};\n\nFramer.prototype.settingsFrame = function settingsFrame(options, callback) {\n  var self = this;\n  var key = this.version + '/' + JSON.stringify(options);\n  var settings = Framer.settingsCache[key];\n\n  if (settings) {\n    debug('cached settings');\n\n    this._resetTimeout();\n\n    this.schedule({\n      stream: 0,\n      priority: false,\n      chunks: settings,\n      callback: callback\n    });\n    return;\n  }\n\n  var params = [];\n\n  for (var i = 0; i < constants.settingsIndex.length; i++) {\n    var name = constants.settingsIndex[i];\n\n    if (!name) {\n      continue;\n    } // value: Infinity\n\n\n    if (!isFinite(options[name])) {\n      continue;\n    }\n\n    if (options[name] !== undefined) {\n      params.push({\n        key: i,\n        value: options[name]\n      });\n    }\n  }\n\n  var frame = this._frame({\n    type: 'SETTINGS',\n    id: 0,\n    flags: 0\n  }, function (buf) {\n    buf.reserve(4 + 8 * params.length); // Count of entries\n\n    buf.writeUInt32BE(params.length);\n    params.forEach(function (param) {\n      var flag = constants.settings.FLAG_SETTINGS_PERSIST_VALUE << 24;\n\n      if (self.version === 2) {\n        buf.writeUInt32LE(flag | param.key);\n      } else {\n        buf.writeUInt32BE(flag | param.key);\n      }\n\n      buf.writeUInt32BE(param.value & 0x7fffffff);\n    });\n  }, callback);\n\n  Framer.settingsCache[key] = frame;\n};\n\nFramer.settingsCache = {};\n\nFramer.prototype.ackSettingsFrame = function ackSettingsFrame(callback) {\n  if (callback) {\n    process.nextTick(callback);\n  }\n};\n\nFramer.prototype.windowUpdateFrame = function windowUpdateFrame(frame, callback) {\n  this._frame({\n    type: 'WINDOW_UPDATE',\n    id: frame.id,\n    flags: 0\n  }, function (buf) {\n    buf.reserve(8); // ID\n\n    buf.writeUInt32BE(frame.id & 0x7fffffff); // Delta\n\n    buf.writeInt32BE(frame.delta);\n  }, callback);\n};\n\nFramer.prototype.goawayFrame = function goawayFrame(frame, callback) {\n  this._frame({\n    type: 'GOAWAY',\n    id: 0,\n    flags: 0\n  }, function (buf) {\n    buf.reserve(8); // Last-good-stream-ID\n\n    buf.writeUInt32BE(frame.lastId & 0x7fffffff); // Status\n\n    buf.writeUInt32BE(constants.goaway[frame.code]);\n  }, callback);\n};\n\nFramer.prototype.priorityFrame = function priorityFrame(frame, callback) {\n  // No such thing in SPDY\n  if (callback) {\n    process.nextTick(callback);\n  }\n};\n\nFramer.prototype.xForwardedFor = function xForwardedFor(frame, callback) {\n  this._frame({\n    type: 'X_FORWARDED_FOR',\n    id: 0,\n    flags: 0\n  }, function (buf) {\n    buf.writeUInt32BE(Buffer.byteLength(frame.host));\n    buf.write(frame.host);\n  }, callback);\n};","map":{"version":3,"names":["transport","require","constants","base","protocol","utils","assert","util","Buffer","WriteBuffer","debug","Framer","options","call","inherits","module","exports","create","prototype","setMaxFrameSize","size","headersToDict","headers","preprocess","callback","stringify","value","undefined","Array","isArray","join","toString","loweredHeaders","Object","keys","map","key","toLowerCase","version","len","pairs","filter","lkey","klen","byteLength","vlen","block","reserve","writeUInt16BE","length","writeUInt32BE","forEach","pair","write","compress","render","_frame","frame","body","on","id","type","buffer","frameType","writeUInt8","flags","skip","frameSize","FRAME_HEADER_SIZE","writeUInt24BE","chunks","toWrite","stream","priority","_resetTimeout","schedule","_synFrame","self","path","Error","method","DEFAULT_METHOD","scheme","host","DEFAULT_HOST","url","status","err","emit","fin","FLAG_FIN","buf","associated","weight","DEFAULT_WEIGHT","weightToPriority","i","copyFrom","requestFrame","responseFrame","reason","statusReason","pushFrame","_checkPush","promisedId","assign","response","headersFrame","dataFrame","data","bypass","window","send","update","pingFrame","opaque","readUInt32BE","rstFrame","error","code","extra","prefaceFrame","settingsFrame","JSON","settings","settingsCache","params","settingsIndex","name","isFinite","push","param","flag","FLAG_SETTINGS_PERSIST_VALUE","writeUInt32LE","ackSettingsFrame","process","nextTick","windowUpdateFrame","writeInt32BE","delta","goawayFrame","lastId","goaway","priorityFrame","xForwardedFor"],"sources":["C:/Users/Rohith/mern/frontend/node_modules/spdy-transport/lib/spdy-transport/protocol/spdy/framer.js"],"sourcesContent":["'use strict'\n\nvar transport = require('../../../spdy-transport')\nvar constants = require('./').constants\nvar base = transport.protocol.base\nvar utils = base.utils\n\nvar assert = require('assert')\nvar util = require('util')\nvar Buffer = require('buffer').Buffer\nvar WriteBuffer = require('wbuf')\n\nvar debug = require('debug')('spdy:framer')\n\nfunction Framer (options) {\n  base.Framer.call(this, options)\n}\nutil.inherits(Framer, base.Framer)\nmodule.exports = Framer\n\nFramer.create = function create (options) {\n  return new Framer(options)\n}\n\nFramer.prototype.setMaxFrameSize = function setMaxFrameSize (size) {\n  // http2-only\n}\n\nFramer.prototype.headersToDict = function headersToDict (headers,\n  preprocess,\n  callback) {\n  function stringify (value) {\n    if (value !== undefined) {\n      if (Array.isArray(value)) {\n        return value.join('\\x00')\n      } else if (typeof value === 'string') {\n        return value\n      } else {\n        return value.toString()\n      }\n    } else {\n      return ''\n    }\n  }\n\n  // Lower case of all headers keys\n  var loweredHeaders = {}\n  Object.keys(headers || {}).map(function (key) {\n    loweredHeaders[key.toLowerCase()] = headers[key]\n  })\n\n  // Allow outer code to add custom headers or remove something\n  if (preprocess) { preprocess(loweredHeaders) }\n\n  // Transform object into kv pairs\n  var size = this.version === 2 ? 2 : 4\n  var len = size\n  var pairs = Object.keys(loweredHeaders).filter(function (key) {\n    var lkey = key.toLowerCase()\n\n    // Will be in `:host`\n    if (lkey === 'host' && this.version >= 3) {\n      return false\n    }\n\n    return lkey !== 'connection' && lkey !== 'keep-alive' &&\n           lkey !== 'proxy-connection' && lkey !== 'transfer-encoding'\n  }, this).map(function (key) {\n    var klen = Buffer.byteLength(key)\n    var value = stringify(loweredHeaders[key])\n    var vlen = Buffer.byteLength(value)\n\n    len += size * 2 + klen + vlen\n    return [klen, key, vlen, value]\n  })\n\n  var block = new WriteBuffer()\n  block.reserve(len)\n\n  if (this.version === 2) {\n    block.writeUInt16BE(pairs.length)\n  } else {\n    block.writeUInt32BE(pairs.length)\n  }\n\n  pairs.forEach(function (pair) {\n    // Write key length\n    if (this.version === 2) {\n      block.writeUInt16BE(pair[0])\n    } else {\n      block.writeUInt32BE(pair[0])\n    }\n\n    // Write key\n    block.write(pair[1])\n\n    // Write value length\n    if (this.version === 2) {\n      block.writeUInt16BE(pair[2])\n    } else {\n      block.writeUInt32BE(pair[2])\n    }\n    // Write value\n    block.write(pair[3])\n  }, this)\n\n  assert(this.compress !== null, 'Framer version not initialized')\n  this.compress.write(block.render(), callback)\n}\n\nFramer.prototype._frame = function _frame (frame, body, callback) {\n  if (!this.version) {\n    this.on('version', function () {\n      this._frame(frame, body, callback)\n    })\n    return\n  }\n\n  debug('id=%d type=%s', frame.id, frame.type)\n\n  var buffer = new WriteBuffer()\n\n  buffer.writeUInt16BE(0x8000 | this.version)\n  buffer.writeUInt16BE(constants.frameType[frame.type])\n  buffer.writeUInt8(frame.flags)\n  var len = buffer.skip(3)\n\n  body(buffer)\n\n  var frameSize = buffer.size - constants.FRAME_HEADER_SIZE\n  len.writeUInt24BE(frameSize)\n\n  var chunks = buffer.render()\n  var toWrite = {\n    stream: frame.id,\n    priority: false,\n    chunks: chunks,\n    callback: callback\n  }\n\n  this._resetTimeout()\n  this.schedule(toWrite)\n\n  return chunks\n}\n\nFramer.prototype._synFrame = function _synFrame (frame, callback) {\n  var self = this\n\n  if (!frame.path) {\n    throw new Error('`path` is required frame argument')\n  }\n\n  function preprocess (headers) {\n    var method = frame.method || base.constants.DEFAULT_METHOD\n    var version = frame.version || 'HTTP/1.1'\n    var scheme = frame.scheme || 'https'\n    var host = frame.host ||\n               (frame.headers && frame.headers.host) ||\n               base.constants.DEFAULT_HOST\n\n    if (self.version === 2) {\n      headers.method = method\n      headers.version = version\n      headers.url = frame.path\n      headers.scheme = scheme\n      headers.host = host\n      if (frame.status) {\n        headers.status = frame.status\n      }\n    } else {\n      headers[':method'] = method\n      headers[':version'] = version\n      headers[':path'] = frame.path\n      headers[':scheme'] = scheme\n      headers[':host'] = host\n      if (frame.status) { headers[':status'] = frame.status }\n    }\n  }\n\n  this.headersToDict(frame.headers, preprocess, function (err, chunks) {\n    if (err) {\n      if (callback) {\n        return callback(err)\n      } else {\n        return self.emit('error', err)\n      }\n    }\n\n    self._frame({\n      type: 'SYN_STREAM',\n      id: frame.id,\n      flags: frame.fin ? constants.flags.FLAG_FIN : 0\n    }, function (buf) {\n      buf.reserve(10)\n\n      buf.writeUInt32BE(frame.id & 0x7fffffff)\n      buf.writeUInt32BE(frame.associated & 0x7fffffff)\n\n      var weight = (frame.priority && frame.priority.weight) ||\n                   constants.DEFAULT_WEIGHT\n\n      // We only have 3 bits for priority in SPDY, try to fit it into this\n      var priority = utils.weightToPriority(weight)\n      buf.writeUInt8(priority << 5)\n\n      // CREDENTIALS slot\n      buf.writeUInt8(0)\n\n      for (var i = 0; i < chunks.length; i++) {\n        buf.copyFrom(chunks[i])\n      }\n    }, callback)\n  })\n}\n\nFramer.prototype.requestFrame = function requestFrame (frame, callback) {\n  this._synFrame({\n    id: frame.id,\n    fin: frame.fin,\n    associated: 0,\n    method: frame.method,\n    version: frame.version,\n    scheme: frame.scheme,\n    host: frame.host,\n    path: frame.path,\n    priority: frame.priority,\n    headers: frame.headers\n  }, callback)\n}\n\nFramer.prototype.responseFrame = function responseFrame (frame, callback) {\n  var self = this\n\n  var reason = frame.reason\n  if (!reason) {\n    reason = constants.statusReason[frame.status]\n  }\n\n  function preprocess (headers) {\n    if (self.version === 2) {\n      headers.status = frame.status + ' ' + reason\n      headers.version = 'HTTP/1.1'\n    } else {\n      headers[':status'] = frame.status + ' ' + reason\n      headers[':version'] = 'HTTP/1.1'\n    }\n  }\n\n  this.headersToDict(frame.headers, preprocess, function (err, chunks) {\n    if (err) {\n      if (callback) {\n        return callback(err)\n      } else {\n        return self.emit('error', err)\n      }\n    }\n\n    self._frame({\n      type: 'SYN_REPLY',\n      id: frame.id,\n      flags: 0\n    }, function (buf) {\n      buf.reserve(self.version === 2 ? 6 : 4)\n\n      buf.writeUInt32BE(frame.id & 0x7fffffff)\n\n      // Unused data\n      if (self.version === 2) {\n        buf.writeUInt16BE(0)\n      }\n\n      for (var i = 0; i < chunks.length; i++) {\n        buf.copyFrom(chunks[i])\n      }\n    }, callback)\n  })\n}\n\nFramer.prototype.pushFrame = function pushFrame (frame, callback) {\n  var self = this\n\n  this._checkPush(function (err) {\n    if (err) { return callback(err) }\n\n    self._synFrame({\n      id: frame.promisedId,\n      associated: frame.id,\n      method: frame.method,\n      status: frame.status || 200,\n      version: frame.version,\n      scheme: frame.scheme,\n      host: frame.host,\n      path: frame.path,\n      priority: frame.priority,\n\n      // Merge everything together, there is no difference in SPDY protocol\n      headers: Object.assign(Object.assign({}, frame.headers), frame.response)\n    }, callback)\n  })\n}\n\nFramer.prototype.headersFrame = function headersFrame (frame, callback) {\n  var self = this\n\n  this.headersToDict(frame.headers, null, function (err, chunks) {\n    if (err) {\n      if (callback) { return callback(err) } else {\n        return self.emit('error', err)\n      }\n    }\n\n    self._frame({\n      type: 'HEADERS',\n      id: frame.id,\n      priority: false,\n      flags: 0\n    }, function (buf) {\n      buf.reserve(4 + (self.version === 2 ? 2 : 0))\n      buf.writeUInt32BE(frame.id & 0x7fffffff)\n\n      // Unused data\n      if (self.version === 2) { buf.writeUInt16BE(0) }\n\n      for (var i = 0; i < chunks.length; i++) {\n        buf.copyFrom(chunks[i])\n      }\n    }, callback)\n  })\n}\n\nFramer.prototype.dataFrame = function dataFrame (frame, callback) {\n  if (!this.version) {\n    return this.on('version', function () {\n      this.dataFrame(frame, callback)\n    })\n  }\n\n  debug('id=%d type=DATA', frame.id)\n\n  var buffer = new WriteBuffer()\n  buffer.reserve(8 + frame.data.length)\n\n  buffer.writeUInt32BE(frame.id & 0x7fffffff)\n  buffer.writeUInt8(frame.fin ? 0x01 : 0x0)\n  buffer.writeUInt24BE(frame.data.length)\n  buffer.copyFrom(frame.data)\n\n  var chunks = buffer.render()\n  var toWrite = {\n    stream: frame.id,\n    priority: frame.priority,\n    chunks: chunks,\n    callback: callback\n  }\n\n  var self = this\n  this._resetTimeout()\n\n  var bypass = this.version < 3.1\n  this.window.send.update(-frame.data.length, bypass ? undefined : function () {\n    self._resetTimeout()\n    self.schedule(toWrite)\n  })\n\n  if (bypass) {\n    this._resetTimeout()\n    this.schedule(toWrite)\n  }\n}\n\nFramer.prototype.pingFrame = function pingFrame (frame, callback) {\n  this._frame({\n    type: 'PING',\n    id: 0,\n    flags: 0\n  }, function (buf, callback) {\n    buf.reserve(4)\n\n    var opaque = frame.opaque\n    buf.writeUInt32BE(opaque.readUInt32BE(opaque.length - 4, true))\n  }, callback)\n}\n\nFramer.prototype.rstFrame = function rstFrame (frame, callback) {\n  this._frame({\n    type: 'RST_STREAM',\n    id: frame.id,\n    flags: 0\n  }, function (buf) {\n    buf.reserve(8)\n\n    // Stream ID\n    buf.writeUInt32BE(frame.id & 0x7fffffff)\n    // Status Code\n    buf.writeUInt32BE(constants.error[frame.code])\n\n    // Extra debugging information\n    if (frame.extra) {\n      buf.write(frame.extra)\n    }\n  }, callback)\n}\n\nFramer.prototype.prefaceFrame = function prefaceFrame () {\n}\n\nFramer.prototype.settingsFrame = function settingsFrame (options, callback) {\n  var self = this\n\n  var key = this.version + '/' + JSON.stringify(options)\n\n  var settings = Framer.settingsCache[key]\n  if (settings) {\n    debug('cached settings')\n    this._resetTimeout()\n    this.schedule({\n      stream: 0,\n      priority: false,\n      chunks: settings,\n      callback: callback\n    })\n    return\n  }\n\n  var params = []\n  for (var i = 0; i < constants.settingsIndex.length; i++) {\n    var name = constants.settingsIndex[i]\n    if (!name) { continue }\n\n    // value: Infinity\n    if (!isFinite(options[name])) {\n      continue\n    }\n\n    if (options[name] !== undefined) {\n      params.push({ key: i, value: options[name] })\n    }\n  }\n\n  var frame = this._frame({\n    type: 'SETTINGS',\n    id: 0,\n    flags: 0\n  }, function (buf) {\n    buf.reserve(4 + 8 * params.length)\n\n    // Count of entries\n    buf.writeUInt32BE(params.length)\n\n    params.forEach(function (param) {\n      var flag = constants.settings.FLAG_SETTINGS_PERSIST_VALUE << 24\n\n      if (self.version === 2) {\n        buf.writeUInt32LE(flag | param.key)\n      } else { buf.writeUInt32BE(flag | param.key) }\n      buf.writeUInt32BE(param.value & 0x7fffffff)\n    })\n  }, callback)\n\n  Framer.settingsCache[key] = frame\n}\nFramer.settingsCache = {}\n\nFramer.prototype.ackSettingsFrame = function ackSettingsFrame (callback) {\n  if (callback) {\n    process.nextTick(callback)\n  }\n}\n\nFramer.prototype.windowUpdateFrame = function windowUpdateFrame (frame,\n  callback) {\n  this._frame({\n    type: 'WINDOW_UPDATE',\n    id: frame.id,\n    flags: 0\n  }, function (buf) {\n    buf.reserve(8)\n\n    // ID\n    buf.writeUInt32BE(frame.id & 0x7fffffff)\n\n    // Delta\n    buf.writeInt32BE(frame.delta)\n  }, callback)\n}\n\nFramer.prototype.goawayFrame = function goawayFrame (frame, callback) {\n  this._frame({\n    type: 'GOAWAY',\n    id: 0,\n    flags: 0\n  }, function (buf) {\n    buf.reserve(8)\n\n    // Last-good-stream-ID\n    buf.writeUInt32BE(frame.lastId & 0x7fffffff)\n    // Status\n    buf.writeUInt32BE(constants.goaway[frame.code])\n  }, callback)\n}\n\nFramer.prototype.priorityFrame = function priorityFrame (frame, callback) {\n  // No such thing in SPDY\n  if (callback) {\n    process.nextTick(callback)\n  }\n}\n\nFramer.prototype.xForwardedFor = function xForwardedFor (frame, callback) {\n  this._frame({\n    type: 'X_FORWARDED_FOR',\n    id: 0,\n    flags: 0\n  }, function (buf) {\n    buf.writeUInt32BE(Buffer.byteLength(frame.host))\n    buf.write(frame.host)\n  }, callback)\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}