{"ast":null,"code":"\"use strict\";\n\nvar _a;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst utils_1 = require(\"@typescript-eslint/utils\");\n\nconst util_1 = require(\"../util\");\n\nconst getESLintCoreRule_1 = require(\"../util/getESLintCoreRule\");\n\nconst baseRule = (0, getESLintCoreRule_1.getESLintCoreRule)('no-invalid-this');\nexports.default = (0, util_1.createRule)({\n  name: 'no-invalid-this',\n  meta: {\n    type: 'suggestion',\n    docs: {\n      description: 'Disallow `this` keywords outside of classes or class-like objects',\n      recommended: false,\n      extendsBaseRule: true\n    },\n    // TODO: this rule has only had messages since v7.0 - remove this when we remove support for v6\n    messages: (_a = baseRule.meta.messages) !== null && _a !== void 0 ? _a : {\n      unexpectedThis: \"Unexpected 'this'.\"\n    },\n    hasSuggestions: baseRule.meta.hasSuggestions,\n    schema: baseRule.meta.schema\n  },\n  defaultOptions: [{\n    capIsConstructor: true\n  }],\n\n  create(context) {\n    const rules = baseRule.create(context);\n    /**\n     * Since function definitions can be nested we use a stack storing if \"this\" is valid in the current context.\n     *\n     * Example:\n     *\n     * function a(this: number) { // valid \"this\"\n     *     function b() {\n     *         console.log(this); // invalid \"this\"\n     *     }\n     * }\n     *\n     * When parsing the function declaration of \"a\" the stack will be: [true]\n     * When parsing the function declaration of \"b\" the stack will be: [true, false]\n     */\n\n    const thisIsValidStack = [];\n    return Object.assign(Object.assign({}, rules), {\n      PropertyDefinition() {\n        thisIsValidStack.push(true);\n      },\n\n      'PropertyDefinition:exit'() {\n        thisIsValidStack.pop();\n      },\n\n      FunctionDeclaration(node) {\n        var _a;\n\n        thisIsValidStack.push(node.params.some(param => param.type === utils_1.AST_NODE_TYPES.Identifier && param.name === 'this')); // baseRule's work\n\n        (_a = rules.FunctionDeclaration) === null || _a === void 0 ? void 0 : _a.call(rules, node);\n      },\n\n      'FunctionDeclaration:exit'(node) {\n        var _a;\n\n        thisIsValidStack.pop(); // baseRule's work\n\n        (_a = rules['FunctionDeclaration:exit']) === null || _a === void 0 ? void 0 : _a.call(rules, node);\n      },\n\n      FunctionExpression(node) {\n        var _a;\n\n        thisIsValidStack.push(node.params.some(param => param.type === utils_1.AST_NODE_TYPES.Identifier && param.name === 'this')); // baseRule's work\n\n        (_a = rules.FunctionExpression) === null || _a === void 0 ? void 0 : _a.call(rules, node);\n      },\n\n      'FunctionExpression:exit'(node) {\n        var _a;\n\n        thisIsValidStack.pop(); // baseRule's work\n\n        (_a = rules['FunctionExpression:exit']) === null || _a === void 0 ? void 0 : _a.call(rules, node);\n      },\n\n      ThisExpression(node) {\n        const thisIsValidHere = thisIsValidStack[thisIsValidStack.length - 1];\n\n        if (thisIsValidHere) {\n          return;\n        } // baseRule's work\n\n\n        rules.ThisExpression(node);\n      }\n\n    });\n  }\n\n});","map":{"version":3,"mappings":";;;;;;;;AACA;;AAMA;;AACA;;AAEA,MAAMA,QAAQ,GAAG,2CAAkB,iBAAlB,CAAjB;AAKAC,kBAAe,uBAAgC;EAC7CC,IAAI,EAAE,iBADuC;EAE7CC,IAAI,EAAE;IACJC,IAAI,EAAE,YADF;IAEJC,IAAI,EAAE;MACJC,WAAW,EACT,mEAFE;MAGJC,WAAW,EAAE,KAHT;MAIJC,eAAe,EAAE;IAJb,CAFF;IAQJ;IACAC,QAAQ,EAAE,cAAQ,CAACN,IAAT,CAAcM,QAAd,MAAsB,IAAtB,IAAsBC,aAAtB,GAAsBA,EAAtB,GAA0B;MAClCC,cAAc,EAAE;IADkB,CAThC;IAYJC,cAAc,EAAEZ,QAAQ,CAACG,IAAT,CAAcS,cAZ1B;IAaJC,MAAM,EAAEb,QAAQ,CAACG,IAAT,CAAcU;EAblB,CAFuC;EAiB7CC,cAAc,EAAE,CAAC;IAAEC,gBAAgB,EAAE;EAApB,CAAD,CAjB6B;;EAkB7CC,MAAM,CAACC,OAAD,EAAQ;IACZ,MAAMC,KAAK,GAAGlB,QAAQ,CAACgB,MAAT,CAAgBC,OAAhB,CAAd;IAEA;;;;;;;;;;;;;;;IAcA,MAAME,gBAAgB,GAAc,EAApC;IAEA,uCACKD,KADL,GACU;MACRE,kBAAkB;QAChBD,gBAAgB,CAACE,IAAjB,CAAsB,IAAtB;MACD,CAHO;;MAIR,4BAAyB;QACvBF,gBAAgB,CAACG,GAAjB;MACD,CANO;;MAORC,mBAAmB,CAACC,IAAD,EAAmC;;;QACpDL,gBAAgB,CAACE,IAAjB,CACEG,IAAI,CAACC,MAAL,CAAYC,IAAZ,CACEC,KAAK,IACHA,KAAK,CAACvB,IAAN,KAAewB,uBAAeC,UAA9B,IAA4CF,KAAK,CAACzB,IAAN,KAAe,MAF/D,CADF,EADoD,CAOpD;;QACA,WAAK,CAACqB,mBAAN,MAAyB,IAAzB,IAAyBb,aAAzB,GAAyB,MAAzB,GAAyBA,eAAGc,IAAH,CAAzB;MACD,CAhBO;;MAiBR,2BAA2BA,IAA3B,EAA6D;;;QAC3DL,gBAAgB,CAACG,GAAjB,GAD2D,CAE3D;;QACA,WAAK,CAAC,0BAAD,CAAL,MAAiC,IAAjC,IAAiCZ,aAAjC,GAAiC,MAAjC,GAAiCA,eAAGc,IAAH,CAAjC;MACD,CArBO;;MAsBRM,kBAAkB,CAACN,IAAD,EAAkC;;;QAClDL,gBAAgB,CAACE,IAAjB,CACEG,IAAI,CAACC,MAAL,CAAYC,IAAZ,CACEC,KAAK,IACHA,KAAK,CAACvB,IAAN,KAAewB,uBAAeC,UAA9B,IAA4CF,KAAK,CAACzB,IAAN,KAAe,MAF/D,CADF,EADkD,CAOlD;;QACA,WAAK,CAAC4B,kBAAN,MAAwB,IAAxB,IAAwBpB,aAAxB,GAAwB,MAAxB,GAAwBA,eAAGc,IAAH,CAAxB;MACD,CA/BO;;MAgCR,0BAA0BA,IAA1B,EAA2D;;;QACzDL,gBAAgB,CAACG,GAAjB,GADyD,CAEzD;;QACA,WAAK,CAAC,yBAAD,CAAL,MAAgC,IAAhC,IAAgCZ,aAAhC,GAAgC,MAAhC,GAAgCA,eAAGc,IAAH,CAAhC;MACD,CApCO;;MAqCRO,cAAc,CAACP,IAAD,EAA8B;QAC1C,MAAMQ,eAAe,GAAGb,gBAAgB,CAACA,gBAAgB,CAACc,MAAjB,GAA0B,CAA3B,CAAxC;;QAEA,IAAID,eAAJ,EAAqB;UACnB;QACD,CALyC,CAO1C;;;QACAd,KAAK,CAACa,cAAN,CAAqBP,IAArB;MACD;;IA9CO,CADV;EAiDD;;AAtF4C,CAAhC,CAAf","names":["baseRule","exports","name","meta","type","docs","description","recommended","extendsBaseRule","messages","_a","unexpectedThis","hasSuggestions","schema","defaultOptions","capIsConstructor","create","context","rules","thisIsValidStack","PropertyDefinition","push","pop","FunctionDeclaration","node","params","some","param","utils_1","Identifier","FunctionExpression","ThisExpression","thisIsValidHere","length"],"sources":["../../src/rules/no-invalid-this.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}