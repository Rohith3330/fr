{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.parseForESLint = exports.parse = void 0;\n\nconst scope_manager_1 = require(\"@typescript-eslint/scope-manager\");\n\nconst typescript_estree_1 = require(\"@typescript-eslint/typescript-estree\");\n\nconst debug_1 = __importDefault(require(\"debug\"));\n\nconst typescript_1 = require(\"typescript\");\n\nconst log = (0, debug_1.default)('typescript-eslint:parser:parser');\n\nfunction validateBoolean(value) {\n  let fallback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n  if (typeof value !== 'boolean') {\n    return fallback;\n  }\n\n  return value;\n}\n\nconst LIB_FILENAME_REGEX = /lib\\.(.+)\\.d\\.[cm]?ts$/;\n\nfunction getLib(compilerOptions) {\n  var _a;\n\n  if (compilerOptions.lib) {\n    return compilerOptions.lib.reduce((acc, lib) => {\n      const match = LIB_FILENAME_REGEX.exec(lib.toLowerCase());\n\n      if (match) {\n        acc.push(match[1]);\n      }\n\n      return acc;\n    }, []);\n  }\n\n  const target = (_a = compilerOptions.target) !== null && _a !== void 0 ? _a : typescript_1.ScriptTarget.ES5; // https://github.com/Microsoft/TypeScript/blob/59ad375234dc2efe38d8ee0ba58414474c1d5169/src/compiler/utilitiesPublic.ts#L13-L32\n\n  switch (target) {\n    case typescript_1.ScriptTarget.ESNext:\n      return ['esnext.full'];\n\n    case typescript_1.ScriptTarget.ES2020:\n      return ['es2020.full'];\n\n    case typescript_1.ScriptTarget.ES2019:\n      return ['es2019.full'];\n\n    case typescript_1.ScriptTarget.ES2018:\n      return ['es2018.full'];\n\n    case typescript_1.ScriptTarget.ES2017:\n      return ['es2017.full'];\n\n    case typescript_1.ScriptTarget.ES2016:\n      return ['es2016.full'];\n\n    case typescript_1.ScriptTarget.ES2015:\n      return ['es6'];\n\n    default:\n      return ['lib'];\n  }\n}\n\nfunction parse(code, options) {\n  return parseForESLint(code, options).ast;\n}\n\nexports.parse = parse;\n\nfunction parseForESLint(code, options) {\n  if (!options || typeof options !== 'object') {\n    options = {};\n  } else {\n    options = Object.assign({}, options);\n  } // https://eslint.org/docs/user-guide/configuring#specifying-parser-options\n  // if sourceType is not provided by default eslint expect that it will be set to \"script\"\n\n\n  if (options.sourceType !== 'module' && options.sourceType !== 'script') {\n    options.sourceType = 'script';\n  }\n\n  if (typeof options.ecmaFeatures !== 'object') {\n    options.ecmaFeatures = {};\n  }\n\n  const parserOptions = {};\n  Object.assign(parserOptions, options, {\n    jsx: validateBoolean(options.ecmaFeatures.jsx)\n  });\n  const analyzeOptions = {\n    ecmaVersion: options.ecmaVersion === 'latest' ? 1e8 : options.ecmaVersion,\n    globalReturn: options.ecmaFeatures.globalReturn,\n    jsxPragma: options.jsxPragma,\n    jsxFragmentName: options.jsxFragmentName,\n    lib: options.lib,\n    sourceType: options.sourceType\n  };\n  /**\n   * Allow the user to suppress the warning from typescript-estree if they are using an unsupported\n   * version of TypeScript\n   */\n\n  const warnOnUnsupportedTypeScriptVersion = validateBoolean(options.warnOnUnsupportedTypeScriptVersion, true);\n\n  if (!warnOnUnsupportedTypeScriptVersion) {\n    parserOptions.loggerFn = false;\n  }\n\n  const {\n    ast,\n    services\n  } = (0, typescript_estree_1.parseAndGenerateServices)(code, parserOptions);\n  ast.sourceType = options.sourceType;\n  let emitDecoratorMetadata = options.emitDecoratorMetadata === true;\n\n  if (services.hasFullTypeInformation) {\n    // automatically apply the options configured for the program\n    const compilerOptions = services.program.getCompilerOptions();\n\n    if (analyzeOptions.lib == null) {\n      analyzeOptions.lib = getLib(compilerOptions);\n      log('Resolved libs from program: %o', analyzeOptions.lib);\n    }\n\n    if (parserOptions.jsx === true) {\n      if (analyzeOptions.jsxPragma === undefined && compilerOptions.jsxFactory != null) {\n        // in case the user has specified something like \"preact.h\"\n        const factory = compilerOptions.jsxFactory.split('.')[0].trim();\n        analyzeOptions.jsxPragma = factory;\n        log('Resolved jsxPragma from program: %s', analyzeOptions.jsxPragma);\n      }\n\n      if (analyzeOptions.jsxFragmentName === undefined && compilerOptions.jsxFragmentFactory != null) {\n        // in case the user has specified something like \"preact.Fragment\"\n        const fragFactory = compilerOptions.jsxFragmentFactory.split('.')[0].trim();\n        analyzeOptions.jsxFragmentName = fragFactory;\n        log('Resolved jsxFragmentName from program: %s', analyzeOptions.jsxFragmentName);\n      }\n    }\n\n    if (compilerOptions.emitDecoratorMetadata === true) {\n      emitDecoratorMetadata = true;\n    }\n  }\n\n  if (emitDecoratorMetadata) {\n    analyzeOptions.emitDecoratorMetadata = true;\n  }\n\n  const scopeManager = (0, scope_manager_1.analyze)(ast, analyzeOptions);\n  return {\n    ast,\n    services,\n    scopeManager,\n    visitorKeys: typescript_estree_1.visitorKeys\n  };\n}\n\nexports.parseForESLint = parseForESLint;","map":{"version":3,"mappings":"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","names":["log","validateBoolean","value","fallback","LIB_FILENAME_REGEX","getLib","compilerOptions","lib","reduce","acc","match","exec","toLowerCase","push","target","_a","typescript_1","ES5","ESNext","ES2020","ES2019","ES2018","ES2017","ES2016","ES2015","parse","code","options","parseForESLint","ast","exports","sourceType","ecmaFeatures","parserOptions","Object","assign","jsx","analyzeOptions","ecmaVersion","globalReturn","jsxPragma","jsxFragmentName","warnOnUnsupportedTypeScriptVersion","loggerFn","services","emitDecoratorMetadata","hasFullTypeInformation","program","getCompilerOptions","undefined","jsxFactory","factory","split","trim","jsxFragmentFactory","fragFactory","scopeManager","visitorKeys","typescript_estree_1"],"sources":["../src/parser.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}