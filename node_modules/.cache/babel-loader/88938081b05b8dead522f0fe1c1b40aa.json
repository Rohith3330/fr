{"ast":null,"code":"'use strict';\n\nvar parser = exports;\n\nvar transport = require('../../../spdy-transport');\n\nvar base = transport.protocol.base;\nvar utils = base.utils;\n\nvar constants = require('./').constants;\n\nvar assert = require('assert');\n\nvar util = require('util');\n\nfunction Parser(options) {\n  base.Parser.call(this, options);\n  this.isServer = options.isServer;\n  this.waiting = constants.PREFACE_SIZE;\n  this.state = 'preface';\n  this.pendingHeader = null; // Header Block queue\n\n  this._lastHeaderBlock = null;\n  this.maxFrameSize = constants.INITIAL_MAX_FRAME_SIZE;\n  this.maxHeaderListSize = constants.DEFAULT_MAX_HEADER_LIST_SIZE;\n}\n\nutil.inherits(Parser, base.Parser);\n\nparser.create = function create(options) {\n  return new Parser(options);\n};\n\nParser.prototype.setMaxFrameSize = function setMaxFrameSize(size) {\n  this.maxFrameSize = size;\n};\n\nParser.prototype.setMaxHeaderListSize = function setMaxHeaderListSize(size) {\n  this.maxHeaderListSize = size;\n}; // Only for testing\n\n\nParser.prototype.skipPreface = function skipPreface() {\n  // Just some number bigger than 3.1, doesn't really matter for HTTP2\n  this.setVersion(4); // Parse frame header!\n\n  this.state = 'frame-head';\n  this.waiting = constants.FRAME_HEADER_SIZE;\n};\n\nParser.prototype.execute = function execute(buffer, callback) {\n  if (this.state === 'preface') {\n    return this.onPreface(buffer, callback);\n  }\n\n  if (this.state === 'frame-head') {\n    return this.onFrameHead(buffer, callback);\n  }\n\n  assert(this.state === 'frame-body' && this.pendingHeader !== null);\n  var self = this;\n  var header = this.pendingHeader;\n  this.pendingHeader = null;\n  this.onFrameBody(header, buffer, function (err, frame) {\n    if (err) {\n      return callback(err);\n    }\n\n    self.state = 'frame-head';\n    self.partial = false;\n    self.waiting = constants.FRAME_HEADER_SIZE;\n    callback(null, frame);\n  });\n};\n\nParser.prototype.executePartial = function executePartial(buffer, callback) {\n  var header = this.pendingHeader;\n  assert.strictEqual(header.flags & constants.flags.PADDED, 0);\n\n  if (this.window) {\n    this.window.recv.update(-buffer.size);\n  }\n\n  callback(null, {\n    type: 'DATA',\n    id: header.id,\n    // Partial DATA can't be FIN\n    fin: false,\n    data: buffer.take(buffer.size)\n  });\n};\n\nParser.prototype.onPreface = function onPreface(buffer, callback) {\n  if (buffer.take(buffer.size).toString() !== constants.PREFACE) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid preface'));\n  }\n\n  this.skipPreface();\n  callback(null, null);\n};\n\nParser.prototype.onFrameHead = function onFrameHead(buffer, callback) {\n  var header = {\n    length: buffer.readUInt24BE(),\n    control: true,\n    type: buffer.readUInt8(),\n    flags: buffer.readUInt8(),\n    id: buffer.readUInt32BE() & 0x7fffffff\n  };\n\n  if (header.length > this.maxFrameSize) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'Frame length OOB'));\n  }\n\n  header.control = header.type !== constants.frameType.DATA;\n  this.state = 'frame-body';\n  this.pendingHeader = header;\n  this.waiting = header.length;\n  this.partial = !header.control; // TODO(indutny): eventually support partial padded DATA\n\n  if (this.partial) {\n    this.partial = (header.flags & constants.flags.PADDED) === 0;\n  }\n\n  callback(null, null);\n};\n\nParser.prototype.onFrameBody = function onFrameBody(header, buffer, callback) {\n  var frameType = constants.frameType;\n\n  if (header.type === frameType.DATA) {\n    this.onDataFrame(header, buffer, callback);\n  } else if (header.type === frameType.HEADERS) {\n    this.onHeadersFrame(header, buffer, callback);\n  } else if (header.type === frameType.CONTINUATION) {\n    this.onContinuationFrame(header, buffer, callback);\n  } else if (header.type === frameType.WINDOW_UPDATE) {\n    this.onWindowUpdateFrame(header, buffer, callback);\n  } else if (header.type === frameType.RST_STREAM) {\n    this.onRSTFrame(header, buffer, callback);\n  } else if (header.type === frameType.SETTINGS) {\n    this.onSettingsFrame(header, buffer, callback);\n  } else if (header.type === frameType.PUSH_PROMISE) {\n    this.onPushPromiseFrame(header, buffer, callback);\n  } else if (header.type === frameType.PING) {\n    this.onPingFrame(header, buffer, callback);\n  } else if (header.type === frameType.GOAWAY) {\n    this.onGoawayFrame(header, buffer, callback);\n  } else if (header.type === frameType.PRIORITY) {\n    this.onPriorityFrame(header, buffer, callback);\n  } else if (header.type === frameType.X_FORWARDED_FOR) {\n    this.onXForwardedFrame(header, buffer, callback);\n  } else {\n    this.onUnknownFrame(header, buffer, callback);\n  }\n};\n\nParser.prototype.onUnknownFrame = function onUnknownFrame(header, buffer, callback) {\n  if (this._lastHeaderBlock !== null) {\n    callback(this.error(constants.error.PROTOCOL_ERROR, 'Received unknown frame in the middle of a header block'));\n    return;\n  }\n\n  callback(null, {\n    type: 'unknown: ' + header.type\n  });\n};\n\nParser.prototype.unpadData = function unpadData(header, body, callback) {\n  var isPadded = (header.flags & constants.flags.PADDED) !== 0;\n\n  if (!isPadded) {\n    return callback(null, body);\n  }\n\n  if (!body.has(1)) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'Not enough space for padding'));\n  }\n\n  var pad = body.readUInt8();\n\n  if (!body.has(pad)) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid padding size'));\n  }\n\n  var contents = body.clone(body.size - pad);\n  body.skip(body.size);\n  callback(null, contents);\n};\n\nParser.prototype.onDataFrame = function onDataFrame(header, body, callback) {\n  var isEndStream = (header.flags & constants.flags.END_STREAM) !== 0;\n\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Received DATA frame with stream=0'));\n  } // Count received bytes\n\n\n  if (this.window) {\n    this.window.recv.update(-body.size);\n  }\n\n  this.unpadData(header, body, function (err, data) {\n    if (err) {\n      return callback(err);\n    }\n\n    callback(null, {\n      type: 'DATA',\n      id: header.id,\n      fin: isEndStream,\n      data: data.take(data.size)\n    });\n  });\n};\n\nParser.prototype.initHeaderBlock = function initHeaderBlock(header, frame, block, callback) {\n  if (this._lastHeaderBlock) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Duplicate Stream ID'));\n  }\n\n  this._lastHeaderBlock = {\n    id: header.id,\n    frame: frame,\n    queue: [],\n    size: 0\n  };\n  this.queueHeaderBlock(header, block, callback);\n};\n\nParser.prototype.queueHeaderBlock = function queueHeaderBlock(header, block, callback) {\n  var self = this;\n  var item = this._lastHeaderBlock;\n\n  if (!this._lastHeaderBlock || item.id !== header.id) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'No matching stream for continuation'));\n  }\n\n  var fin = (header.flags & constants.flags.END_HEADERS) !== 0;\n  var chunks = block.toChunks();\n\n  for (var i = 0; i < chunks.length; i++) {\n    var chunk = chunks[i];\n    item.queue.push(chunk);\n    item.size += chunk.length;\n  }\n\n  if (item.size >= self.maxHeaderListSize) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Compressed header list is too large'));\n  }\n\n  if (!fin) {\n    return callback(null, null);\n  }\n\n  this._lastHeaderBlock = null;\n  this.decompress.write(item.queue, function (err, chunks) {\n    if (err) {\n      return callback(self.error(constants.error.COMPRESSION_ERROR, err.message));\n    }\n\n    var headers = {};\n    var size = 0;\n\n    for (var i = 0; i < chunks.length; i++) {\n      var header = chunks[i];\n      size += header.name.length + header.value.length + 32;\n\n      if (size >= self.maxHeaderListSize) {\n        return callback(self.error(constants.error.PROTOCOL_ERROR, 'Header list is too large'));\n      }\n\n      if (/[A-Z]/.test(header.name)) {\n        return callback(self.error(constants.error.PROTOCOL_ERROR, 'Header name must be lowercase'));\n      }\n\n      utils.addHeaderLine(header.name, header.value, headers);\n    }\n\n    item.frame.headers = headers;\n    item.frame.path = headers[':path'];\n    callback(null, item.frame);\n  });\n};\n\nParser.prototype.onHeadersFrame = function onHeadersFrame(header, body, callback) {\n  var self = this;\n\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for HEADERS'));\n  }\n\n  this.unpadData(header, body, function (err, data) {\n    if (err) {\n      return callback(err);\n    }\n\n    var isPriority = (header.flags & constants.flags.PRIORITY) !== 0;\n\n    if (!data.has(isPriority ? 5 : 0)) {\n      return callback(self.error(constants.error.FRAME_SIZE_ERROR, 'Not enough data for HEADERS'));\n    }\n\n    var exclusive = false;\n    var dependency = 0;\n    var weight = constants.DEFAULT_WEIGHT;\n\n    if (isPriority) {\n      dependency = data.readUInt32BE();\n      exclusive = (dependency & 0x80000000) !== 0;\n      dependency &= 0x7fffffff; // Weight's range is [1, 256]\n\n      weight = data.readUInt8() + 1;\n    }\n\n    if (dependency === header.id) {\n      return callback(self.error(constants.error.PROTOCOL_ERROR, 'Stream can\\'t dependend on itself'));\n    }\n\n    var streamInfo = {\n      type: 'HEADERS',\n      id: header.id,\n      priority: {\n        parent: dependency,\n        exclusive: exclusive,\n        weight: weight\n      },\n      fin: (header.flags & constants.flags.END_STREAM) !== 0,\n      writable: true,\n      headers: null,\n      path: null\n    };\n    self.initHeaderBlock(header, streamInfo, data, callback);\n  });\n};\n\nParser.prototype.onContinuationFrame = function onContinuationFrame(header, body, callback) {\n  this.queueHeaderBlock(header, body, callback);\n};\n\nParser.prototype.onRSTFrame = function onRSTFrame(header, body, callback) {\n  if (body.size !== 4) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'RST_STREAM length not 4'));\n  }\n\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for RST_STREAM'));\n  }\n\n  callback(null, {\n    type: 'RST',\n    id: header.id,\n    code: constants.errorByCode[body.readUInt32BE()]\n  });\n};\n\nParser.prototype._validateSettings = function _validateSettings(settings) {\n  if (settings['enable_push'] !== undefined && settings['enable_push'] !== 0 && settings['enable_push'] !== 1) {\n    return this.error(constants.error.PROTOCOL_ERROR, 'SETTINGS_ENABLE_PUSH must be 0 or 1');\n  }\n\n  if (settings['initial_window_size'] !== undefined && (settings['initial_window_size'] > constants.MAX_INITIAL_WINDOW_SIZE || settings['initial_window_size'] < 0)) {\n    return this.error(constants.error.FLOW_CONTROL_ERROR, 'SETTINGS_INITIAL_WINDOW_SIZE is OOB');\n  }\n\n  if (settings['max_frame_size'] !== undefined && (settings['max_frame_size'] > constants.ABSOLUTE_MAX_FRAME_SIZE || settings['max_frame_size'] < constants.INITIAL_MAX_FRAME_SIZE)) {\n    return this.error(constants.error.PROTOCOL_ERROR, 'SETTINGS_MAX_FRAME_SIZE is OOB');\n  }\n\n  return undefined;\n};\n\nParser.prototype.onSettingsFrame = function onSettingsFrame(header, body, callback) {\n  if (header.id !== 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for SETTINGS'));\n  }\n\n  var isAck = (header.flags & constants.flags.ACK) !== 0;\n\n  if (isAck && body.size !== 0) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'SETTINGS with ACK and non-zero length'));\n  }\n\n  if (isAck) {\n    return callback(null, {\n      type: 'ACK_SETTINGS'\n    });\n  }\n\n  if (body.size % 6 !== 0) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'SETTINGS length not multiple of 6'));\n  }\n\n  var settings = {};\n\n  while (!body.isEmpty()) {\n    var id = body.readUInt16BE();\n    var value = body.readUInt32BE();\n    var name = constants.settingsIndex[id];\n\n    if (name) {\n      settings[name] = value;\n    }\n  }\n\n  var err = this._validateSettings(settings);\n\n  if (err !== undefined) {\n    return callback(err);\n  }\n\n  callback(null, {\n    type: 'SETTINGS',\n    settings: settings\n  });\n};\n\nParser.prototype.onPushPromiseFrame = function onPushPromiseFrame(header, body, callback) {\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for PUSH_PROMISE'));\n  }\n\n  var self = this;\n  this.unpadData(header, body, function (err, data) {\n    if (err) {\n      return callback(err);\n    }\n\n    if (!data.has(4)) {\n      return callback(self.error(constants.error.FRAME_SIZE_ERROR, 'PUSH_PROMISE length less than 4'));\n    }\n\n    var streamInfo = {\n      type: 'PUSH_PROMISE',\n      id: header.id,\n      fin: false,\n      promisedId: data.readUInt32BE() & 0x7fffffff,\n      headers: null,\n      path: null\n    };\n    self.initHeaderBlock(header, streamInfo, data, callback);\n  });\n};\n\nParser.prototype.onPingFrame = function onPingFrame(header, body, callback) {\n  if (body.size !== 8) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'PING length != 8'));\n  }\n\n  if (header.id !== 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for PING'));\n  }\n\n  var ack = (header.flags & constants.flags.ACK) !== 0;\n  callback(null, {\n    type: 'PING',\n    opaque: body.take(body.size),\n    ack: ack\n  });\n};\n\nParser.prototype.onGoawayFrame = function onGoawayFrame(header, body, callback) {\n  if (!body.has(8)) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'GOAWAY length < 8'));\n  }\n\n  if (header.id !== 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for GOAWAY'));\n  }\n\n  var frame = {\n    type: 'GOAWAY',\n    lastId: body.readUInt32BE(),\n    code: constants.goawayByCode[body.readUInt32BE()]\n  };\n\n  if (body.size !== 0) {\n    frame.debug = body.take(body.size);\n  }\n\n  callback(null, frame);\n};\n\nParser.prototype.onPriorityFrame = function onPriorityFrame(header, body, callback) {\n  if (body.size !== 5) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'PRIORITY length != 5'));\n  }\n\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for PRIORITY'));\n  }\n\n  var dependency = body.readUInt32BE(); // Again the range is from 1 to 256\n\n  var weight = body.readUInt8() + 1;\n\n  if (dependency === header.id) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Stream can\\'t dependend on itself'));\n  }\n\n  callback(null, {\n    type: 'PRIORITY',\n    id: header.id,\n    priority: {\n      exclusive: (dependency & 0x80000000) !== 0,\n      parent: dependency & 0x7fffffff,\n      weight: weight\n    }\n  });\n};\n\nParser.prototype.onWindowUpdateFrame = function onWindowUpdateFrame(header, body, callback) {\n  if (body.size !== 4) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'WINDOW_UPDATE length != 4'));\n  }\n\n  var delta = body.readInt32BE();\n\n  if (delta === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'WINDOW_UPDATE delta == 0'));\n  }\n\n  callback(null, {\n    type: 'WINDOW_UPDATE',\n    id: header.id,\n    delta: delta\n  });\n};\n\nParser.prototype.onXForwardedFrame = function onXForwardedFrame(header, body, callback) {\n  callback(null, {\n    type: 'X_FORWARDED_FOR',\n    host: body.take(body.size).toString()\n  });\n};","map":{"version":3,"names":["parser","exports","transport","require","base","protocol","utils","constants","assert","util","Parser","options","call","isServer","waiting","PREFACE_SIZE","state","pendingHeader","_lastHeaderBlock","maxFrameSize","INITIAL_MAX_FRAME_SIZE","maxHeaderListSize","DEFAULT_MAX_HEADER_LIST_SIZE","inherits","create","prototype","setMaxFrameSize","size","setMaxHeaderListSize","skipPreface","setVersion","FRAME_HEADER_SIZE","execute","buffer","callback","onPreface","onFrameHead","self","header","onFrameBody","err","frame","partial","executePartial","strictEqual","flags","PADDED","window","recv","update","type","id","fin","data","take","toString","PREFACE","error","PROTOCOL_ERROR","length","readUInt24BE","control","readUInt8","readUInt32BE","FRAME_SIZE_ERROR","frameType","DATA","onDataFrame","HEADERS","onHeadersFrame","CONTINUATION","onContinuationFrame","WINDOW_UPDATE","onWindowUpdateFrame","RST_STREAM","onRSTFrame","SETTINGS","onSettingsFrame","PUSH_PROMISE","onPushPromiseFrame","PING","onPingFrame","GOAWAY","onGoawayFrame","PRIORITY","onPriorityFrame","X_FORWARDED_FOR","onXForwardedFrame","onUnknownFrame","unpadData","body","isPadded","has","pad","contents","clone","skip","isEndStream","END_STREAM","initHeaderBlock","block","queue","queueHeaderBlock","item","END_HEADERS","chunks","toChunks","i","chunk","push","decompress","write","COMPRESSION_ERROR","message","headers","name","value","test","addHeaderLine","path","isPriority","exclusive","dependency","weight","DEFAULT_WEIGHT","streamInfo","priority","parent","writable","code","errorByCode","_validateSettings","settings","undefined","MAX_INITIAL_WINDOW_SIZE","FLOW_CONTROL_ERROR","ABSOLUTE_MAX_FRAME_SIZE","isAck","ACK","isEmpty","readUInt16BE","settingsIndex","promisedId","ack","opaque","lastId","goawayByCode","debug","delta","readInt32BE","host"],"sources":["C:/Users/Rohith/mern/frontend/node_modules/spdy-transport/lib/spdy-transport/protocol/http2/parser.js"],"sourcesContent":["'use strict'\n\nvar parser = exports\n\nvar transport = require('../../../spdy-transport')\nvar base = transport.protocol.base\nvar utils = base.utils\nvar constants = require('./').constants\n\nvar assert = require('assert')\nvar util = require('util')\n\nfunction Parser (options) {\n  base.Parser.call(this, options)\n\n  this.isServer = options.isServer\n\n  this.waiting = constants.PREFACE_SIZE\n  this.state = 'preface'\n  this.pendingHeader = null\n\n  // Header Block queue\n  this._lastHeaderBlock = null\n  this.maxFrameSize = constants.INITIAL_MAX_FRAME_SIZE\n  this.maxHeaderListSize = constants.DEFAULT_MAX_HEADER_LIST_SIZE\n}\nutil.inherits(Parser, base.Parser)\n\nparser.create = function create (options) {\n  return new Parser(options)\n}\n\nParser.prototype.setMaxFrameSize = function setMaxFrameSize (size) {\n  this.maxFrameSize = size\n}\n\nParser.prototype.setMaxHeaderListSize = function setMaxHeaderListSize (size) {\n  this.maxHeaderListSize = size\n}\n\n// Only for testing\nParser.prototype.skipPreface = function skipPreface () {\n  // Just some number bigger than 3.1, doesn't really matter for HTTP2\n  this.setVersion(4)\n\n  // Parse frame header!\n  this.state = 'frame-head'\n  this.waiting = constants.FRAME_HEADER_SIZE\n}\n\nParser.prototype.execute = function execute (buffer, callback) {\n  if (this.state === 'preface') { return this.onPreface(buffer, callback) }\n\n  if (this.state === 'frame-head') {\n    return this.onFrameHead(buffer, callback)\n  }\n\n  assert(this.state === 'frame-body' && this.pendingHeader !== null)\n\n  var self = this\n  var header = this.pendingHeader\n  this.pendingHeader = null\n\n  this.onFrameBody(header, buffer, function (err, frame) {\n    if (err) {\n      return callback(err)\n    }\n\n    self.state = 'frame-head'\n    self.partial = false\n    self.waiting = constants.FRAME_HEADER_SIZE\n    callback(null, frame)\n  })\n}\n\nParser.prototype.executePartial = function executePartial (buffer, callback) {\n  var header = this.pendingHeader\n\n  assert.strictEqual(header.flags & constants.flags.PADDED, 0)\n\n  if (this.window) { this.window.recv.update(-buffer.size) }\n\n  callback(null, {\n    type: 'DATA',\n    id: header.id,\n\n    // Partial DATA can't be FIN\n    fin: false,\n    data: buffer.take(buffer.size)\n  })\n}\n\nParser.prototype.onPreface = function onPreface (buffer, callback) {\n  if (buffer.take(buffer.size).toString() !== constants.PREFACE) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid preface'))\n  }\n\n  this.skipPreface()\n  callback(null, null)\n}\n\nParser.prototype.onFrameHead = function onFrameHead (buffer, callback) {\n  var header = {\n    length: buffer.readUInt24BE(),\n    control: true,\n    type: buffer.readUInt8(),\n    flags: buffer.readUInt8(),\n    id: buffer.readUInt32BE() & 0x7fffffff\n  }\n\n  if (header.length > this.maxFrameSize) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'Frame length OOB'))\n  }\n\n  header.control = header.type !== constants.frameType.DATA\n\n  this.state = 'frame-body'\n  this.pendingHeader = header\n  this.waiting = header.length\n  this.partial = !header.control\n\n  // TODO(indutny): eventually support partial padded DATA\n  if (this.partial) {\n    this.partial = (header.flags & constants.flags.PADDED) === 0\n  }\n\n  callback(null, null)\n}\n\nParser.prototype.onFrameBody = function onFrameBody (header, buffer, callback) {\n  var frameType = constants.frameType\n\n  if (header.type === frameType.DATA) {\n    this.onDataFrame(header, buffer, callback)\n  } else if (header.type === frameType.HEADERS) {\n    this.onHeadersFrame(header, buffer, callback)\n  } else if (header.type === frameType.CONTINUATION) {\n    this.onContinuationFrame(header, buffer, callback)\n  } else if (header.type === frameType.WINDOW_UPDATE) {\n    this.onWindowUpdateFrame(header, buffer, callback)\n  } else if (header.type === frameType.RST_STREAM) {\n    this.onRSTFrame(header, buffer, callback)\n  } else if (header.type === frameType.SETTINGS) {\n    this.onSettingsFrame(header, buffer, callback)\n  } else if (header.type === frameType.PUSH_PROMISE) {\n    this.onPushPromiseFrame(header, buffer, callback)\n  } else if (header.type === frameType.PING) {\n    this.onPingFrame(header, buffer, callback)\n  } else if (header.type === frameType.GOAWAY) {\n    this.onGoawayFrame(header, buffer, callback)\n  } else if (header.type === frameType.PRIORITY) {\n    this.onPriorityFrame(header, buffer, callback)\n  } else if (header.type === frameType.X_FORWARDED_FOR) {\n    this.onXForwardedFrame(header, buffer, callback)\n  } else {\n    this.onUnknownFrame(header, buffer, callback)\n  }\n}\n\nParser.prototype.onUnknownFrame = function onUnknownFrame (header, buffer, callback) {\n  if (this._lastHeaderBlock !== null) {\n    callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Received unknown frame in the middle of a header block'))\n    return\n  }\n  callback(null, { type: 'unknown: ' + header.type })\n}\n\nParser.prototype.unpadData = function unpadData (header, body, callback) {\n  var isPadded = (header.flags & constants.flags.PADDED) !== 0\n\n  if (!isPadded) { return callback(null, body) }\n\n  if (!body.has(1)) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'Not enough space for padding'))\n  }\n\n  var pad = body.readUInt8()\n  if (!body.has(pad)) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid padding size'))\n  }\n\n  var contents = body.clone(body.size - pad)\n  body.skip(body.size)\n  callback(null, contents)\n}\n\nParser.prototype.onDataFrame = function onDataFrame (header, body, callback) {\n  var isEndStream = (header.flags & constants.flags.END_STREAM) !== 0\n\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Received DATA frame with stream=0'))\n  }\n\n  // Count received bytes\n  if (this.window) {\n    this.window.recv.update(-body.size)\n  }\n\n  this.unpadData(header, body, function (err, data) {\n    if (err) {\n      return callback(err)\n    }\n\n    callback(null, {\n      type: 'DATA',\n      id: header.id,\n      fin: isEndStream,\n      data: data.take(data.size)\n    })\n  })\n}\n\nParser.prototype.initHeaderBlock = function initHeaderBlock (header,\n  frame,\n  block,\n  callback) {\n  if (this._lastHeaderBlock) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Duplicate Stream ID'))\n  }\n\n  this._lastHeaderBlock = {\n    id: header.id,\n    frame: frame,\n    queue: [],\n    size: 0\n  }\n\n  this.queueHeaderBlock(header, block, callback)\n}\n\nParser.prototype.queueHeaderBlock = function queueHeaderBlock (header,\n  block,\n  callback) {\n  var self = this\n  var item = this._lastHeaderBlock\n  if (!this._lastHeaderBlock || item.id !== header.id) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'No matching stream for continuation'))\n  }\n\n  var fin = (header.flags & constants.flags.END_HEADERS) !== 0\n\n  var chunks = block.toChunks()\n  for (var i = 0; i < chunks.length; i++) {\n    var chunk = chunks[i]\n    item.queue.push(chunk)\n    item.size += chunk.length\n  }\n\n  if (item.size >= self.maxHeaderListSize) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Compressed header list is too large'))\n  }\n\n  if (!fin) { return callback(null, null) }\n  this._lastHeaderBlock = null\n\n  this.decompress.write(item.queue, function (err, chunks) {\n    if (err) {\n      return callback(self.error(constants.error.COMPRESSION_ERROR,\n        err.message))\n    }\n\n    var headers = {}\n    var size = 0\n    for (var i = 0; i < chunks.length; i++) {\n      var header = chunks[i]\n\n      size += header.name.length + header.value.length + 32\n      if (size >= self.maxHeaderListSize) {\n        return callback(self.error(constants.error.PROTOCOL_ERROR,\n          'Header list is too large'))\n      }\n\n      if (/[A-Z]/.test(header.name)) {\n        return callback(self.error(constants.error.PROTOCOL_ERROR,\n          'Header name must be lowercase'))\n      }\n\n      utils.addHeaderLine(header.name, header.value, headers)\n    }\n\n    item.frame.headers = headers\n    item.frame.path = headers[':path']\n\n    callback(null, item.frame)\n  })\n}\n\nParser.prototype.onHeadersFrame = function onHeadersFrame (header,\n  body,\n  callback) {\n  var self = this\n\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for HEADERS'))\n  }\n\n  this.unpadData(header, body, function (err, data) {\n    if (err) { return callback(err) }\n\n    var isPriority = (header.flags & constants.flags.PRIORITY) !== 0\n    if (!data.has(isPriority ? 5 : 0)) {\n      return callback(self.error(constants.error.FRAME_SIZE_ERROR,\n        'Not enough data for HEADERS'))\n    }\n\n    var exclusive = false\n    var dependency = 0\n    var weight = constants.DEFAULT_WEIGHT\n    if (isPriority) {\n      dependency = data.readUInt32BE()\n      exclusive = (dependency & 0x80000000) !== 0\n      dependency &= 0x7fffffff\n\n      // Weight's range is [1, 256]\n      weight = data.readUInt8() + 1\n    }\n\n    if (dependency === header.id) {\n      return callback(self.error(constants.error.PROTOCOL_ERROR,\n        'Stream can\\'t dependend on itself'))\n    }\n\n    var streamInfo = {\n      type: 'HEADERS',\n      id: header.id,\n      priority: {\n        parent: dependency,\n        exclusive: exclusive,\n        weight: weight\n      },\n      fin: (header.flags & constants.flags.END_STREAM) !== 0,\n      writable: true,\n      headers: null,\n      path: null\n    }\n\n    self.initHeaderBlock(header, streamInfo, data, callback)\n  })\n}\n\nParser.prototype.onContinuationFrame = function onContinuationFrame (header,\n  body,\n  callback) {\n  this.queueHeaderBlock(header, body, callback)\n}\n\nParser.prototype.onRSTFrame = function onRSTFrame (header, body, callback) {\n  if (body.size !== 4) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'RST_STREAM length not 4'))\n  }\n\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for RST_STREAM'))\n  }\n\n  callback(null, {\n    type: 'RST',\n    id: header.id,\n    code: constants.errorByCode[body.readUInt32BE()]\n  })\n}\n\nParser.prototype._validateSettings = function _validateSettings (settings) {\n  if (settings['enable_push'] !== undefined &&\n      settings['enable_push'] !== 0 &&\n      settings['enable_push'] !== 1) {\n    return this.error(constants.error.PROTOCOL_ERROR,\n      'SETTINGS_ENABLE_PUSH must be 0 or 1')\n  }\n\n  if (settings['initial_window_size'] !== undefined &&\n      (settings['initial_window_size'] > constants.MAX_INITIAL_WINDOW_SIZE ||\n       settings['initial_window_size'] < 0)) {\n    return this.error(constants.error.FLOW_CONTROL_ERROR,\n      'SETTINGS_INITIAL_WINDOW_SIZE is OOB')\n  }\n\n  if (settings['max_frame_size'] !== undefined &&\n      (settings['max_frame_size'] > constants.ABSOLUTE_MAX_FRAME_SIZE ||\n       settings['max_frame_size'] < constants.INITIAL_MAX_FRAME_SIZE)) {\n    return this.error(constants.error.PROTOCOL_ERROR,\n      'SETTINGS_MAX_FRAME_SIZE is OOB')\n  }\n\n  return undefined\n}\n\nParser.prototype.onSettingsFrame = function onSettingsFrame (header,\n  body,\n  callback) {\n  if (header.id !== 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for SETTINGS'))\n  }\n\n  var isAck = (header.flags & constants.flags.ACK) !== 0\n  if (isAck && body.size !== 0) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'SETTINGS with ACK and non-zero length'))\n  }\n\n  if (isAck) {\n    return callback(null, { type: 'ACK_SETTINGS' })\n  }\n\n  if (body.size % 6 !== 0) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'SETTINGS length not multiple of 6'))\n  }\n\n  var settings = {}\n  while (!body.isEmpty()) {\n    var id = body.readUInt16BE()\n    var value = body.readUInt32BE()\n    var name = constants.settingsIndex[id]\n\n    if (name) {\n      settings[name] = value\n    }\n  }\n\n  var err = this._validateSettings(settings)\n  if (err !== undefined) {\n    return callback(err)\n  }\n\n  callback(null, {\n    type: 'SETTINGS',\n    settings: settings\n  })\n}\n\nParser.prototype.onPushPromiseFrame = function onPushPromiseFrame (header,\n  body,\n  callback) {\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for PUSH_PROMISE'))\n  }\n\n  var self = this\n  this.unpadData(header, body, function (err, data) {\n    if (err) {\n      return callback(err)\n    }\n\n    if (!data.has(4)) {\n      return callback(self.error(constants.error.FRAME_SIZE_ERROR,\n        'PUSH_PROMISE length less than 4'))\n    }\n\n    var streamInfo = {\n      type: 'PUSH_PROMISE',\n      id: header.id,\n      fin: false,\n      promisedId: data.readUInt32BE() & 0x7fffffff,\n      headers: null,\n      path: null\n    }\n\n    self.initHeaderBlock(header, streamInfo, data, callback)\n  })\n}\n\nParser.prototype.onPingFrame = function onPingFrame (header, body, callback) {\n  if (body.size !== 8) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'PING length != 8'))\n  }\n\n  if (header.id !== 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for PING'))\n  }\n\n  var ack = (header.flags & constants.flags.ACK) !== 0\n  callback(null, { type: 'PING', opaque: body.take(body.size), ack: ack })\n}\n\nParser.prototype.onGoawayFrame = function onGoawayFrame (header,\n  body,\n  callback) {\n  if (!body.has(8)) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'GOAWAY length < 8'))\n  }\n\n  if (header.id !== 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for GOAWAY'))\n  }\n\n  var frame = {\n    type: 'GOAWAY',\n    lastId: body.readUInt32BE(),\n    code: constants.goawayByCode[body.readUInt32BE()]\n  }\n\n  if (body.size !== 0) { frame.debug = body.take(body.size) }\n\n  callback(null, frame)\n}\n\nParser.prototype.onPriorityFrame = function onPriorityFrame (header,\n  body,\n  callback) {\n  if (body.size !== 5) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'PRIORITY length != 5'))\n  }\n\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for PRIORITY'))\n  }\n\n  var dependency = body.readUInt32BE()\n\n  // Again the range is from 1 to 256\n  var weight = body.readUInt8() + 1\n\n  if (dependency === header.id) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Stream can\\'t dependend on itself'))\n  }\n\n  callback(null, {\n    type: 'PRIORITY',\n    id: header.id,\n    priority: {\n      exclusive: (dependency & 0x80000000) !== 0,\n      parent: dependency & 0x7fffffff,\n      weight: weight\n    }\n  })\n}\n\nParser.prototype.onWindowUpdateFrame = function onWindowUpdateFrame (header,\n  body,\n  callback) {\n  if (body.size !== 4) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'WINDOW_UPDATE length != 4'))\n  }\n\n  var delta = body.readInt32BE()\n  if (delta === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'WINDOW_UPDATE delta == 0'))\n  }\n\n  callback(null, {\n    type: 'WINDOW_UPDATE',\n    id: header.id,\n    delta: delta\n  })\n}\n\nParser.prototype.onXForwardedFrame = function onXForwardedFrame (header,\n  body,\n  callback) {\n  callback(null, {\n    type: 'X_FORWARDED_FOR',\n    host: body.take(body.size).toString()\n  })\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}