{"ast":null,"code":"var _regeneratorRuntime = require(\"C:/Users/Rohith/mern/frontend/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\n\nvar _asyncToGenerator = require(\"C:/Users/Rohith/mern/frontend/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\n\nvar user = require('../models/usermodel');\n\nvar asyncHandler = require('express-async-handler');\n\nvar generateToken = require('../util/generateToken');\n\nvar retriveUser = asyncHandler( /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(req, res) {\n    var students;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return user.find();\n\n          case 3:\n            students = _context.sent;\n            console.log(\"here1\"); // console.log(students);  \n\n            res.send(students);\n            _context.next = 11;\n            break;\n\n          case 8:\n            _context.prev = 8;\n            _context.t0 = _context[\"catch\"](0);\n            res.status(400).send({\n              error: _context.t0\n            });\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[0, 8]]);\n  }));\n\n  return function (_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}());\nvar registerUser = asyncHandler( /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(req, res) {\n    var _req$body, name, email, password, pic, roll, branch, userExists, User;\n\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            console.log(\"Here\");\n            _req$body = req.body, name = _req$body.name, email = _req$body.email, password = _req$body.password, pic = _req$body.pic, roll = _req$body.roll, branch = _req$body.branch;\n            _context2.next = 4;\n            return user.findOne({\n              email: email\n            });\n\n          case 4:\n            userExists = _context2.sent;\n\n            if (!userExists) {\n              _context2.next = 8;\n              break;\n            }\n\n            res.status(400);\n            throw new Error(\"user already exists\");\n\n          case 8:\n            _context2.next = 10;\n            return user.create({\n              name: name,\n              email: email,\n              password: password,\n              pic: pic,\n              roll: roll,\n              branch: branch\n            });\n\n          case 10:\n            User = _context2.sent;\n\n            if (!User) {\n              _context2.next = 15;\n              break;\n            }\n\n            res.status(201).json({\n              _id: User._id,\n              name: User.name,\n              email: User.email,\n              isAdmin: User.isAdmin,\n              token: generateToken(User._id),\n              pic: User.pic,\n              roll: User.roll,\n              branch: User.branch\n            });\n            _context2.next = 17;\n            break;\n\n          case 15:\n            res.status(400);\n            throw new Error(\"error occured\");\n\n          case 17:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x3, _x4) {\n    return _ref2.apply(this, arguments);\n  };\n}());\nvar authUser = asyncHandler( /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(req, res) {\n    var _req$body2, email, password, User;\n\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            console.log(\"Here\");\n            console.log(req.body);\n            _req$body2 = req.body, email = _req$body2.email, password = _req$body2.password;\n            _context3.next = 5;\n            return user.findOne({\n              email: email\n            });\n\n          case 5:\n            User = _context3.sent;\n            _context3.t0 = User;\n\n            if (!_context3.t0) {\n              _context3.next = 11;\n              break;\n            }\n\n            _context3.next = 10;\n            return User.matchPassword(password);\n\n          case 10:\n            _context3.t0 = _context3.sent;\n\n          case 11:\n            if (!_context3.t0) {\n              _context3.next = 15;\n              break;\n            }\n\n            res.json({\n              _id: User._id,\n              name: User.name,\n              email: User.email,\n              isAdmin: User.isAdmin,\n              token: generateToken(User._id),\n              pic: User.pic\n            });\n            _context3.next = 17;\n            break;\n\n          case 15:\n            res.status(401);\n            throw new Error(\"Invalid email or password!\");\n\n          case 17:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function (_x5, _x6) {\n    return _ref3.apply(this, arguments);\n  };\n}());\nvar getuserbyid = asyncHandler( /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(req, res) {\n    var id, ind;\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.prev = 0;\n            console.log(req.params);\n            id = req.params.id;\n            _context4.next = 5;\n            return user.findById({\n              _id: id\n            });\n\n          case 5:\n            ind = _context4.sent;\n            console.log(ind);\n            res.json(ind);\n            _context4.next = 13;\n            break;\n\n          case 10:\n            _context4.prev = 10;\n            _context4.t0 = _context4[\"catch\"](0);\n            throw new Error(\"No user found\");\n\n          case 13:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, null, [[0, 10]]);\n  }));\n\n  return function (_x7, _x8) {\n    return _ref4.apply(this, arguments);\n  };\n}());\nmodule.exports = {\n  registerUser: registerUser,\n  authUser: authUser,\n  retriveUser: retriveUser,\n  getuserbyid: getuserbyid\n};","map":{"version":3,"names":["user","require","asyncHandler","generateToken","retriveUser","req","res","find","students","console","log","send","status","error","registerUser","body","name","email","password","pic","roll","branch","findOne","userExists","Error","create","User","json","_id","isAdmin","token","authUser","matchPassword","getuserbyid","params","id","findById","ind","module","exports"],"sources":["C:/Users/Rohith/mern/backend/controllers/userController.js"],"sourcesContent":["const user=require('../models/usermodel');\r\nconst asyncHandler=require('express-async-handler');\r\nconst generateToken = require('../util/generateToken');\r\nconst retriveUser=asyncHandler(async(req,res)=>{\r\n    try {\r\n        const students = await user.find();\r\n        console.log(\"here1\");\r\n        // console.log(students);  \r\n        res.send(students);\r\n      } catch(err) {\r\n        res.status(400).send({ error: err });\r\n      }\r\n}\r\n    )\r\nconst registerUser=asyncHandler(async(req,res)=>{\r\n    console.log(\"Here\");\r\n    const {name,email,password,pic,roll,branch} = req.body;\r\n    const userExists= await user.findOne({email});\r\n    if(userExists){\r\n        res.status(400)\r\n        throw new Error(\"user already exists\");\r\n    }\r\n    const User =await user.create({name,email,password,pic,roll,branch});\r\n    if(User){\r\n        res.status(201).json({\r\n            _id:User._id,\r\n            name:User.name,\r\n            email:User.email,\r\n            isAdmin:User.isAdmin,\r\n            token:generateToken(User._id),\r\n            pic:User.pic,\r\n            roll:User.roll,\r\n            branch:User.branch\r\n        });\r\n    }else{\r\n        res.status(400);\r\n        throw new Error(\"error occured\");\r\n    }\r\n});\r\n\r\nconst authUser=asyncHandler(async(req,res)=>{\r\n    console.log(\"Here\");\r\n    console.log(req.body);\r\n    const {email,password}=req.body;\r\n\r\n    const User=await user.findOne({email});\r\n    \r\n    if(User && (await User.matchPassword(password))){\r\n        res.json({\r\n            _id:User._id,\r\n            name:User.name,\r\n            email:User.email,\r\n            isAdmin:User.isAdmin,\r\n            token:generateToken(User._id),\r\n            pic:User.pic,\r\n        });\r\n    }\r\n    else{\r\n        res.status(401);\r\n        throw new Error(\"Invalid email or password!\");\r\n    }\r\n});\r\nconst getuserbyid=asyncHandler(async(req,res)=>{\r\n    try{\r\n        console.log(req.params);\r\n        const {id}=req.params;\r\n        const ind=await user.findById({_id:id});\r\n        console.log(ind);\r\n        res.json(ind);\r\n    }\r\n    catch(error){\r\n        throw new Error(\"No user found\");\r\n    }\r\n});\r\nmodule.exports= {registerUser,authUser,retriveUser,getuserbyid};"],"mappings":"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"},"metadata":{},"sourceType":"script"}