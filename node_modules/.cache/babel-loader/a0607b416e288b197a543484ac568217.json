{"ast":null,"code":"function isSecure(wsComponents) {\n  return typeof wsComponents.secure === 'boolean' ? wsComponents.secure : String(wsComponents.scheme).toLowerCase() === \"wss\";\n} //RFC 6455\n\n\nconst handler = {\n  scheme: \"ws\",\n  domainHost: true,\n  parse: function (components, options) {\n    const wsComponents = components; //indicate if the secure flag is set\n\n    wsComponents.secure = isSecure(wsComponents); //construct resouce name\n\n    wsComponents.resourceName = (wsComponents.path || '/') + (wsComponents.query ? '?' + wsComponents.query : '');\n    wsComponents.path = undefined;\n    wsComponents.query = undefined;\n    return wsComponents;\n  },\n  serialize: function (wsComponents, options) {\n    //normalize the default port\n    if (wsComponents.port === (isSecure(wsComponents) ? 443 : 80) || wsComponents.port === \"\") {\n      wsComponents.port = undefined;\n    } //ensure scheme matches secure flag\n\n\n    if (typeof wsComponents.secure === 'boolean') {\n      wsComponents.scheme = wsComponents.secure ? 'wss' : 'ws';\n      wsComponents.secure = undefined;\n    } //reconstruct path from resource name\n\n\n    if (wsComponents.resourceName) {\n      const [path, query] = wsComponents.resourceName.split('?');\n      wsComponents.path = path && path !== '/' ? path : undefined;\n      wsComponents.query = query;\n      wsComponents.resourceName = undefined;\n    } //forbid fragment component\n\n\n    wsComponents.fragment = undefined;\n    return wsComponents;\n  }\n};\nexport default handler;","map":{"version":3,"mappings":"AAOA,kBAAkBA,YAAlB,EAA2C;EAC1C,OAAO,OAAOA,YAAY,CAACC,MAApB,KAA+B,SAA/B,GAA2CD,YAAY,CAACC,MAAxD,GAAiEC,MAAM,CAACF,YAAY,CAACG,MAAd,CAAN,CAA4BC,WAA5B,OAA8C,KAAtH;AACA,C,CAED;;;AACA,MAAMC,OAAO,GAAoB;EAChCF,MAAM,EAAG,IADuB;EAGhCG,UAAU,EAAG,IAHmB;EAKhCC,KAAK,EAAG,UAAUC,UAAV,EAAoCC,OAApC,EAAsD;IAC7D,MAAMT,YAAY,GAAGQ,UAArB,CAD6D,CAG7D;;IACAR,YAAY,CAACC,MAAb,GAAsBS,QAAQ,CAACV,YAAD,CAA9B,CAJ6D,CAM7D;;IACAA,YAAY,CAACW,YAAb,GAA4B,CAACX,YAAY,CAACY,IAAb,IAAqB,GAAtB,KAA8BZ,YAAY,CAACa,KAAb,GAAqB,MAAMb,YAAY,CAACa,KAAxC,GAAgD,EAA9E,CAA5B;IACAb,YAAY,CAACY,IAAb,GAAoBE,SAApB;IACAd,YAAY,CAACa,KAAb,GAAqBC,SAArB;IAEA,OAAOd,YAAP;EACA,CAjB+B;EAmBhCe,SAAS,EAAG,UAAUf,YAAV,EAAqCS,OAArC,EAAuD;IAClE;IACA,IAAIT,YAAY,CAACgB,IAAb,MAAuBN,QAAQ,CAACV,YAAD,CAAR,GAAyB,GAAzB,GAA+B,EAAtD,KAA6DA,YAAY,CAACgB,IAAb,KAAsB,EAAvF,EAA2F;MAC1FhB,YAAY,CAACgB,IAAb,GAAoBF,SAApB;IACA,CAJiE,CAMlE;;;IACA,IAAI,OAAOd,YAAY,CAACC,MAApB,KAA+B,SAAnC,EAA8C;MAC7CD,YAAY,CAACG,MAAb,GAAuBH,YAAY,CAACC,MAAb,GAAsB,KAAtB,GAA8B,IAArD;MACAD,YAAY,CAACC,MAAb,GAAsBa,SAAtB;IACA,CAViE,CAYlE;;;IACA,IAAId,YAAY,CAACW,YAAjB,EAA+B;MAC9B,MAAM,CAACC,IAAD,EAAOC,KAAP,IAAgBb,YAAY,CAACW,YAAb,CAA0BM,KAA1B,CAAgC,GAAhC,CAAtB;MACAjB,YAAY,CAACY,IAAb,GAAqBA,IAAI,IAAIA,IAAI,KAAK,GAAjB,GAAuBA,IAAvB,GAA8BE,SAAnD;MACAd,YAAY,CAACa,KAAb,GAAqBA,KAArB;MACAb,YAAY,CAACW,YAAb,GAA4BG,SAA5B;IACA,CAlBiE,CAoBlE;;;IACAd,YAAY,CAACkB,QAAb,GAAwBJ,SAAxB;IAEA,OAAOd,YAAP;EACA;AA3C+B,CAAjC;AA8CA,eAAeK,OAAf","names":["wsComponents","secure","String","scheme","toLowerCase","handler","domainHost","parse","components","options","isSecure","resourceName","path","query","undefined","serialize","port","split","fragment"],"sources":["../../../src/schemes/ws.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}