{"ast":null,"code":"var hpack = require('../hpack');\n\nvar utils = hpack.utils;\nvar encoder = hpack.encoder;\nvar table = hpack.table;\nvar assert = utils.assert;\n\nvar inherits = require('inherits');\n\nvar Duplex = require('readable-stream').Duplex;\n\nfunction Compressor(options) {\n  Duplex.call(this, {\n    writableObjectMode: true\n  });\n  this._encoder = null;\n  this._table = table.create(options.table);\n}\n\ninherits(Compressor, Duplex);\nmodule.exports = Compressor;\n\nCompressor.create = function create(options) {\n  return new Compressor(options);\n};\n\nCompressor.prototype._read = function _read() {// We only push!\n};\n\nCompressor.prototype._write = function _write(data, enc, cb) {\n  assert(Array.isArray(data), 'Compressor.write() expects list of headers');\n  this._encoder = encoder.create();\n\n  for (var i = 0; i < data.length; i++) this._encodeHeader(data[i]);\n\n  var data = this._encoder.render();\n\n  this._encoder = null;\n  cb(null);\n\n  for (var i = 0; i < data.length; i++) this.push(data[i]);\n};\n\nCompressor.prototype.updateTableSize = function updateTableSize(size) {\n  if (size >= this._table.protocolMaxSize) {\n    size = this._table.protocolMaxSize;\n    var enc = encoder.create(); // indexed = 0\n    // incremental = 0\n    // update = 1\n\n    enc.encodeBits(1, 3);\n    enc.encodeInt(size);\n    var data = enc.render();\n\n    for (var i = 0; i < data.length; i++) this.push(data[i]);\n  }\n\n  this._table.updateSize(size);\n};\n\nCompressor.prototype.reset = function reset() {\n  var enc = encoder.create();\n  var size = this._table.maxSize; // indexed = 0\n  // incremental = 0\n  // update = 1\n\n  enc.encodeBits(1, 3);\n  enc.encodeInt(0); // Evict everything\n\n  this._table.updateSize(0); // indexed = 0\n  // incremental = 0\n  // update = 1\n\n\n  enc.encodeBits(1, 3);\n  enc.encodeInt(size); // Revert size\n\n  this._table.updateSize(size);\n\n  var data = enc.render();\n\n  for (var i = 0; i < data.length; i++) this.push(data[i]);\n};\n\nCompressor.prototype._encodeHeader = function _encodeHeader(header) {\n  if (header.neverIndex) {\n    var index = 0;\n    var neverIndex = 1;\n    var isIndexed = 0;\n    var isIncremental = 0;\n  } else {\n    var index = this._table.reverseLookup(header.name, header.value);\n\n    var isIndexed = index > 0;\n    var isIncremental = header.incremental !== false;\n    var neverIndex = 0;\n  }\n\n  this._encoder.encodeBit(isIndexed);\n\n  if (isIndexed) {\n    this._encoder.encodeInt(index);\n\n    return;\n  }\n\n  var name = utils.toArray(header.name);\n  var value = utils.toArray(header.value);\n\n  this._encoder.encodeBit(isIncremental);\n\n  if (isIncremental) {\n    this._table.add(header.name, header.value, name.length, value.length);\n  } else {\n    // Update = false\n    this._encoder.encodeBit(0);\n\n    this._encoder.encodeBit(neverIndex);\n  } // index is negative for `name`-only headers\n\n\n  this._encoder.encodeInt(-index);\n\n  if (index === 0) this._encoder.encodeStr(name, header.huffman !== false);\n\n  this._encoder.encodeStr(value, header.huffman !== false);\n};","map":{"version":3,"names":["hpack","require","utils","encoder","table","assert","inherits","Duplex","Compressor","options","call","writableObjectMode","_encoder","_table","create","module","exports","prototype","_read","_write","data","enc","cb","Array","isArray","i","length","_encodeHeader","render","push","updateTableSize","size","protocolMaxSize","encodeBits","encodeInt","updateSize","reset","maxSize","header","neverIndex","index","isIndexed","isIncremental","reverseLookup","name","value","incremental","encodeBit","toArray","add","encodeStr","huffman"],"sources":["C:/Users/Rohith/mern/frontend/node_modules/hpack.js/lib/hpack/compressor.js"],"sourcesContent":["var hpack = require('../hpack');\nvar utils = hpack.utils;\nvar encoder = hpack.encoder;\nvar table = hpack.table;\nvar assert = utils.assert;\n\nvar inherits = require('inherits');\nvar Duplex = require('readable-stream').Duplex;\n\nfunction Compressor(options) {\n  Duplex.call(this, {\n    writableObjectMode: true\n  });\n\n  this._encoder = null;\n  this._table = table.create(options.table);\n}\ninherits(Compressor, Duplex);\nmodule.exports = Compressor;\n\nCompressor.create = function create(options) {\n  return new Compressor(options);\n};\n\nCompressor.prototype._read = function _read() {\n  // We only push!\n};\n\nCompressor.prototype._write = function _write(data, enc, cb) {\n  assert(Array.isArray(data), 'Compressor.write() expects list of headers');\n\n  this._encoder = encoder.create();\n  for (var i = 0; i < data.length; i++)\n    this._encodeHeader(data[i]);\n\n  var data = this._encoder.render();\n  this._encoder = null;\n\n  cb(null);\n  for (var i = 0; i < data.length; i++)\n    this.push(data[i]);\n};\n\nCompressor.prototype.updateTableSize = function updateTableSize(size) {\n  if (size >= this._table.protocolMaxSize) {\n    size = this._table.protocolMaxSize;\n\n    var enc = encoder.create();\n\n    // indexed = 0\n    // incremental = 0\n    // update = 1\n    enc.encodeBits(1, 3);\n    enc.encodeInt(size);\n\n    var data = enc.render();\n    for (var i = 0; i < data.length; i++)\n      this.push(data[i]);\n  }\n\n  this._table.updateSize(size);\n};\n\nCompressor.prototype.reset = function reset() {\n  var enc = encoder.create();\n  var size = this._table.maxSize;\n\n  // indexed = 0\n  // incremental = 0\n  // update = 1\n  enc.encodeBits(1, 3);\n  enc.encodeInt(0);\n\n  // Evict everything\n  this._table.updateSize(0);\n\n  // indexed = 0\n  // incremental = 0\n  // update = 1\n  enc.encodeBits(1, 3);\n  enc.encodeInt(size);\n\n  // Revert size\n  this._table.updateSize(size);\n\n  var data = enc.render();\n  for (var i = 0; i < data.length; i++)\n    this.push(data[i]);\n};\n\nCompressor.prototype._encodeHeader = function _encodeHeader(header) {\n  if (header.neverIndex) {\n    var index = 0;\n    var neverIndex = 1;\n    var isIndexed = 0;\n    var isIncremental = 0;\n  } else {\n    var index = this._table.reverseLookup(header.name, header.value);\n    var isIndexed = index > 0;\n    var isIncremental = header.incremental !== false;\n    var neverIndex = 0;\n  }\n\n  this._encoder.encodeBit(isIndexed);\n  if (isIndexed) {\n    this._encoder.encodeInt(index);\n    return;\n  }\n\n  var name = utils.toArray(header.name);\n  var value = utils.toArray(header.value);\n\n  this._encoder.encodeBit(isIncremental);\n  if (isIncremental) {\n    this._table.add(header.name, header.value, name.length, value.length);\n  } else {\n    // Update = false\n    this._encoder.encodeBit(0);\n    this._encoder.encodeBit(neverIndex);\n  }\n\n  // index is negative for `name`-only headers\n  this._encoder.encodeInt(-index);\n  if (index === 0)\n    this._encoder.encodeStr(name, header.huffman !== false);\n  this._encoder.encodeStr(value, header.huffman !== false);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}